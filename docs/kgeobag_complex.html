
  

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charset="utf-8" />
    
      <title>Complex Shapes in KGeoBag | Kassiopeia 3.8 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" />
      <link rel="stylesheet" href="_static/theme.33684ae9923d01874503.css" />
      <link rel="stylesheet" href="_static/graphviz.css" />
        <link rel="search" title="Search" href="search.html" />
        <link rel="index" title="Index" href="genindex.html" />
        <link rel="next" title="Understanding Simulation Output" href="output.html" />
        <link rel="prev" title="Basic Shapes in KGeoBag" href="kgeobag_basic.html" />
  </head>

  <body class="antialiased text-gray scroll-smooth">
    <div
      id="page"
      data-controller="sidebar search"
      data-action="keydown@window->search#focus"
      class="h-screen xl:grid xl:grid-layout"
    >
      <a class="block text-xl bg-white py-4 z-20 absolute top-0 h-14 inset-x-0 text-center transform -translate-y-full focus:translate-y-0 focus:outline-none transition-transform duration-75" href="#complex-shapes-in-kgeobag" title="Skip navigation links">Skip to content</a>

      <header class="grid-area-header z-10 h-14">
        <div class="bg-gray-dark shadow-md flex items-center h-full xl:px-2 relative"><div class="flex items-center">
      <button
    data-action="sidebar#open"
    data-sidebar-target="hamburger"
    class="xl:hidden h-14 w-14 leading-14 text-gray-100 hover:bg-gray-700 hover:text-brand focus:outline-none focus:bg-gray-700 focus:text-brand">
  <span class="sr-only">Open navigation menu</span>
  <svg aria-hidden="true" class="fill-current h-8 w-8" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</button><a class="hover:bg-gray-700 focus:bg-gray-700 focus:outline-none tooltipped tooltipped-sw"
   href="index.html"
   aria-label="Back to homepage"><img class="h-14 w-14 p-3 inline-block" src="_static/KassiopeiaLogo_1_cropped_bb.png" alt="Logo" /><span class="hidden lg:inline-block shrink-0 font-medium text-gray-100 mx-5 leading-14 tracking-wider">Kassiopeia 3.8 documentation</span>
</a></div><div class="flex justify-end items-center flex-1"><form
  id="searchbox"
  action="search.html"
  data-action="click->search#focusSearchInput"
  method="get"
  class="flex print:hidden justify-between items-center leading-14 md:ml-4 bg-gray-dark text-gray-300 focus-within:bg-gray-50 focus-within:text-gray-800 focus-within:absolute focus-within:inset-x-0 focus-within:top-0 md:focus-within:w-full md:focus-within:static">

  <button
    class="text-inherit h-14 w-14"
    aria-label="Get search results"
    tabindex="-1"
  >
    <svg aria-hidden="true" class="fill-current stroke-current h-8 w-8" stroke-width="0.5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
  </button>

  <input
    name="q"
    id="search-input"
    data-search-target="searchInput"
    type="search"
    aria-label="Search the docs"
    placeholder="Search the docs"
    class="pr-2 bg-transparent text-inherit focus:outline-none w-0 md:w-auto focus:w-full transition-all duration-100"
  />
</form></div>
</div>
      </header>

      
  <aside data-sidebar-target="sidebar" class="grid-area-sidebar h-full fixed xl:relative inset-y-0 left-0 z-20 xl:z-0 print:hidden overflow-y-auto transition-all transform transform-gpu -translate-x-full opacity-0 duration-300 xl:translate-x-0 xl:opacity-100">
    <nav
  role="navigation"
  class="h-full overflow-y-auto bg-white text-gray-600 pt-8 flex flex-col"
>
  <div class="nav-toc flex-1 pl-6"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html"> Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#the-kasper-framework">The Kasper framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#extending-functionality">Extending Functionality</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="external_documentation.html"> External Documentation, Citation and Contact</a><ul>
<li class="toctree-l2"><a class="reference internal" href="external_documentation.html#external-references">External references</a></li>
<li class="toctree-l2"><a class="reference internal" href="external_documentation.html#developer-contact">Developer contact</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="compiling.html"> Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="compiling.html#downloading-the-code">Downloading the code</a></li>
<li class="toctree-l2"><a class="reference internal" href="compiling.html#supported-operating-systems-and-hardware-requirements">Supported operating systems and hardware requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="compiling.html#docker-image">Docker image</a></li>
<li class="toctree-l2"><a class="reference internal" href="compiling.html#required-software-dependencies">Required software dependencies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="compiling.html#minimum-requirements">Minimum requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="compiling.html#required-dependencies">Required dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="compiling.html#optional-dependencies">Optional dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="compiling.html#external-libraries">External libraries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="compiling.html#compiling-the-code-using-cmake">Compiling the code using CMake</a><ul>
<li class="toctree-l3"><a class="reference internal" href="compiling.html#environment-variables">Environment variables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="compiling.html#directory-structure-and-environmental-variables">Directory structure and environmental variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="compiling.html#executing-kassiopeia">Executing Kassiopeia</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="compiling.html#configuring-optional-dependencies">Configuring optional dependencies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="compiling.html#build-options">Build options</a></li>
<li class="toctree-l3"><a class="reference internal" href="compiling.html#kassiopeia-module">Kassiopeia module</a></li>
<li class="toctree-l3"><a class="reference internal" href="compiling.html#kemfield-module">KEMField module</a></li>
<li class="toctree-l3"><a class="reference internal" href="compiling.html#kgeobag-module">KGeoBag module</a></li>
<li class="toctree-l3"><a class="reference internal" href="compiling.html#kommon-module">Kommon module</a></li>
<li class="toctree-l3"><a class="reference internal" href="compiling.html#miscellaneous-options">Miscellaneous options</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html"> Examples and Tests</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples.html#running-kassiopeia">Running Kassiopeia</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples.html#verbosity-levels">Verbosity levels</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples.html#output-files">Output files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#example-configurations">Example configurations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples.html#the-dipole-trap-example">The Dipole Trap Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples.html#the-quadrupole-trap-example">The Quadrupole Trap Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples.html#the-photomultiplier-tube-example">The Photomultiplier Tube Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples.html#the-mesh-simulation-example">The Mesh Simulation Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples.html#other-examples">Other Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html"> Configuring Your Own Simulation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#overview-and-units">Overview and Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#xml-parsing-and-features">XML Parsing and Features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#variables">Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#including-external-files">Including external files</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#print-statements">Print statements</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#formula-expressions">Formula Expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#conditional-expressions-and-looping">Conditional Expressions and Looping</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#comments">Comments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#messaging-system">Messaging System</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#verbosity-levels">Verbosity levels</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#additional-logging">Additional logging</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#geometry">Geometry</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#shapes-and-assemblies">Shapes and assemblies</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#tagging-system">Tagging system</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#assembling-elements">Assembling elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#transformations">Transformations</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#extensions">Extensions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#kemfield">KEMField</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#fields">Fields</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#electric">Electric</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#magnetic">Magnetic</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#kassiopeia">Kassiopeia</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#generation">Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#termination">Termination</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#propagation">Propagation</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#interactions">Interactions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#volume-interactions">Volume Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#surface-interactions">Surface Interactions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#output">Output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#writers">Writers</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#output-description">Output description</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#navigation">Navigation</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#navigation-and-commands">Navigation and Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#simulation">Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#visualization">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#common-pitfalls-and-problems">Common Pitfalls and Problems</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="kgeobag_basic.html"> Basic KGeoBag Shapes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="kgeobag_basic.html#basic-elements">Basic elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="kgeobag_basic.html#poly-loop">Poly-loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="kgeobag_basic.html#poly-line">Poly-line</a></li>
<li class="toctree-l2"><a class="reference internal" href="kgeobag_basic.html#surfaces">Surfaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#flattened-circle-surface">Flattened circle surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#flattened-poly-loop-surface">Flattened poly-loop surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#rotated-surfaces">Rotated Surfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#rotated-line-segment-surface">Rotated line segment surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#rotated-arc-segment-surface">Rotated arc segment surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#rotated-poly-line-surface">Rotated poly-line surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#rotated-circle-surface">Rotated circle surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#rotated-poly-loop-surface">Rotated poly loop surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#shell-surfaces">Shell Surfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#shell-line-segment-surface">Shell line segment surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#shell-arc-segment-surface">Shell arc segment surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#shell-poly-line-surface">Shell poly-line surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#shell-circle-surface">Shell circle surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#shell-poly-loop-surface">Shell poly-loop surface</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="kgeobag_basic.html#extruded-surfaces">Extruded Surfaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#extruded-poly-line-surface">Extruded poly-line surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#extruded-circle-surface">Extruded circle surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#extruded-poly-loop-surface">Extruded poly-loop surface</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="kgeobag_basic.html#special-surfaces">Special Surfaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#disk-surface">Disk surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#annulus-surface">Annulus surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#cylinder-surface">Cylinder surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#cone-surface">Cone Surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#cut-cone-surface">Cut Cone Surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#torus-surface">Torus Surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#cut-torus-surface">Cut Torus Surface</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="kgeobag_basic.html#spaces">Spaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="kgeobag_basic.html#extruded-spaces">Extruded Spaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#extruded-circle-space">Extruded Circle Space</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#extruded-poly-loop-space">Extruded Poly-Loop Space</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="kgeobag_basic.html#rotated-spaces">Rotated Spaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#rotated-line-segment">Rotated Line Segment</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#rotated-arc-segment">Rotated Arc Segment</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#rotated-poly-line-space">Rotated Poly-Line Space</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#rotated-circle-space">Rotated Circle Space</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#rotated-poly-loop-space">Rotated Poly-Loop Space</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="kgeobag_basic.html#special-spaces">Special Spaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#cylinder-space">Cylinder Space</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#cone-space">Cone Space</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#cut-cone-space">Cut Cone Space</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#torus-space">Torus Space</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#cylinder-tube-space">Cylinder Tube Space</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#cut-cone-tube-space">Cut Cone Tube Space</a></li>
<li class="toctree-l3"><a class="reference internal" href="kgeobag_basic.html#box-space">Box Space</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Complex Shapes in KGeoBag</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#surfaces">Surfaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pump-port">Pump Port</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conic-section-pump-port">Conic section pump port</a></li>
<li class="toctree-l3"><a class="reference internal" href="#beam">Beam</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rod">Rod</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extruded-surfaces-with-holes">Extruded surfaces with holes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rotated-surface">Rotated surface</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#spaces">Spaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pump-port-space">Pump Port Space</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conic-section-pump-port-space">Conic Section Pump Port Space</a></li>
<li class="toctree-l3"><a class="reference internal" href="#beam-space">Beam Space</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rod-space">Rod Space</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extruded-space">Extruded Space</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rotated-space">Rotated Space</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#external-shapes-in-kgeobag">External Shapes in KGeoBag</a></li>
<li class="toctree-l1"><a class="reference internal" href="output.html"> Understanding Simulation Output</a><ul>
<li class="toctree-l2"><a class="reference internal" href="output.html#output-configuration">Output configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="output.html#groups-and-fields">Groups and fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="output.html#output-structure">Output structure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="output.html#root-output-files">ROOT output files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="output.html#data-structure">Data structure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="output.html#accessing-simulation-data">Accessing simulation data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="output.html#using-kassiopeia">Using Kassiopeia</a></li>
<li class="toctree-l3"><a class="reference internal" href="output.html#using-root">Using ROOT</a></li>
<li class="toctree-l3"><a class="reference internal" href="output.html#using-python">Using Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="output.html#kassiopeiareader">KassiopeiaReader</a></li>
<li class="toctree-l3"><a class="reference internal" href="output.html#uproot-pandas">uproot / Pandas</a></li>
<li class="toctree-l3"><a class="reference internal" href="output.html#python-notebook">Python notebook</a></li>
<li class="toctree-l3"><a class="reference internal" href="output.html#geometry-visualization">Geometry visualization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="output.html#vtk-output-files">VTK output files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="output.html#id13">Data structure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="output.html#id14">Accessing simulation data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="output.html#using-paraview">Using ParaView</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="output.html#ascii-output-files">ASCII output files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tools.html"> Additional Simulation Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tools.html#geometry-viewers">Geometry viewers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tools.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="tools.html#advanced-visualization">Advanced visualization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tools.html#mesh-viewers">Mesh viewers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tools.html#id1">Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tools.html#field-calculation">Field calculation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tools.html#id2">Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tools.html#simulation-tools">Simulation tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html"> Visualization Techniques</a><ul>
<li class="toctree-l2"><a class="reference internal" href="visualization.html#kgeobag-visualization">KGeoBag visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#python">Python</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html#kassiopieia-visualization">Kassiopieia visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html#kemfield-visualization">KEMField visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#field-maps">Field maps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bindings.html"> XML Bindings</a><ul>
<li class="toctree-l2"><a class="reference internal" href="bindings.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="bindings.html#xml-bindings">XML Bindings</a></li>
<li class="toctree-l2"><a class="reference internal" href="bindings.html#kroot">KRoot</a><ul>
<li class="toctree-l3"><a class="reference internal" href="bindings.html#kapplicationrunner">KApplicationRunner</a></li>
<li class="toctree-l3"><a class="reference internal" href="bindings.html#kdummyrandom">KDummyRandom</a></li>
<li class="toctree-l3"><a class="reference internal" href="bindings.html#kemroot">KEMRoot</a></li>
<li class="toctree-l3"><a class="reference internal" href="bindings.html#kggeometryprinter">KGGeometryPrinter</a></li>
<li class="toctree-l3"><a class="reference internal" href="bindings.html#kginterface">KGInterface</a></li>
<li class="toctree-l3"><a class="reference internal" href="bindings.html#kmessagetable">KMessageTable</a></li>
<li class="toctree-l3"><a class="reference internal" href="bindings.html#krootwindow">KROOTWindow</a></li>
<li class="toctree-l3"><a class="reference internal" href="bindings.html#ksroot">KSRoot</a></li>
<li class="toctree-l3"><a class="reference internal" href="bindings.html#kvtkwindow">KVTKWindow</a></li>
<li class="toctree-l3"><a class="reference internal" href="bindings.html#kommonnamedrandomgenerator">KommonNamedRandomGenerator</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="license.html"> License</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html"> Authors</a></li>
</ul>
</div>

  <button
      data-action=""
      title="Close navigation menu"
      class="text-4xl text-gray-800 p-4 bottom-0 hover:text-brand xl:hidden focus:text-brand self-center">
    <span class="sr-only">Close navigation menu</span>
    <svg aria-hidden="true" class="fill-current stroke-current h-6 w-6" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
  </button>
</nav>
  </aside>

  <main
    data-controller="scroll"
    data-action="scroll->scroll#showButton"
    class="px-4 xl:ml-fluid grid-area-main overflow-y-auto flex flex-col h-full mx-0 md:mx-auto xl:mr-0"
  ><nav role="navigation"
     aria-label="breadcrumbs"
     class="print:hidden mt-12 text-sm text-gray-light">
  <a class="text-gray-light text-sm hover:text-gray-dark font-medium focus:text-gray-dark" href="index.html">Kassiopeia 3.8 documentation</a>
  <span class="mr-1"> • </span><span aria-current="page">Complex Shapes in KGeoBag</span>
</nav>
    <article role="main" class="flex-1">
      
  <div class="section" id="complex-shapes-in-kgeobag">
<span id="complex-kgeobag-label"></span><h1>Complex Shapes in KGeoBag<a class="headerlink" href="#complex-shapes-in-kgeobag" title="Permalink to this headline">¶</a></h1>
<p>This section describes the more complicated shapes available in <em>KGeoBag</em>. Since as of yet, <em>KGeoBag</em> lacks the ability
to perform boolean operations on solids (constructive solid geometry), shapes which cannot be represented as an assembly
of basic shapes must be explicitly defined in C++. However, to augment the basic shapes, <em>KGeoBag</em> provides some
additional complex shapes that are commonly encountered in experimental structures such as vacuum chambers, etc.</p>
<p>Some of the examples in this section make use of the the more advanced features of the XML parser, including loops,
conditional statements, and equation evaluation.</p>
<div class="section" id="surfaces">
<h2>Surfaces<a class="headerlink" href="#surfaces" title="Permalink to this headline">¶</a></h2>
<div class="section" id="pump-port">
<h3>Pump Port<a class="headerlink" href="#pump-port" title="Permalink to this headline">¶</a></h3>
<p>The shape creates a tube-like surface with circular or rectangular pump ports (e.g. for vacuum chambers). The
coordinates (x,y,z) are the end points of the ports. The ports can only be created in radial direction.</p>
<a class="reference internal image-reference" href="_images/kgeobag_port_housing_surface_model.png"><img alt="_images/kgeobag_port_housing_surface_model.png" src="_images/kgeobag_port_housing_surface_model.png" style="width: 400pt;" /></a>
<ul class="simple">
<li><p>Works with MeshViewer: Yes.</p></li>
<li><p>Works with GeometryViewer: No.</p></li>
</ul>
<p>An XML example is as follows:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><code><span class="nt">&lt;port_housing_surface</span> <span class="na">name=</span><span class="s">&quot;example_port_housing_surface&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;port_housing</span> <span class="na">x1=</span><span class="s">&quot;0.&quot;</span> <span class="na">y1=</span><span class="s">&quot;0.&quot;</span> <span class="na">z1=</span><span class="s">&quot;-1.&quot;</span> <span class="na">x2=</span><span class="s">&quot;0.&quot;</span> <span class="na">y2=</span><span class="s">&quot;0.&quot;</span> <span class="na">z2=</span><span class="s">&quot;1.&quot;</span> <span class="na">radius=</span><span class="s">&quot;0.4&quot;</span> <span class="na">longitudinal_mesh_count=</span><span class="s">&quot;50&quot;</span> <span class="na">axial_mesh_count=</span><span class="s">&quot;50&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;circular_port</span> <span class="na">x=</span><span class="s">&quot;1.5&quot;</span> <span class="na">y=</span><span class="s">&quot;1.5&quot;</span> <span class="na">z=</span><span class="s">&quot;-.3&quot;</span> <span class="na">radius=</span><span class="s">&quot;0.33&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;rectangular_port</span> <span class="na">x=</span><span class="s">&quot;0.&quot;</span> <span class="na">y=</span><span class="s">&quot;1.&quot;</span> <span class="na">z=</span><span class="s">&quot;.3&quot;</span> <span class="na">length=</span><span class="s">&quot;0.3&quot;</span> <span class="na">width=</span><span class="s">&quot;.15&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;circular_port</span> <span class="na">x=</span><span class="s">&quot;-1./sqrt(2.)&quot;</span> <span class="na">y=</span><span class="s">&quot;-1./sqrt(2.)&quot;</span> <span class="na">z=</span><span class="s">&quot;-.5&quot;</span> <span class="na">radius=</span><span class="s">&quot;0.053&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/port_housing&gt;</span>
<span class="nt">&lt;/port_housing_surface&gt;</span>
</code></pre></div></div>
</div>
<div class="section" id="conic-section-pump-port">
<h3>Conic section pump port<a class="headerlink" href="#conic-section-pump-port" title="Permalink to this headline">¶</a></h3>
<p>This shape is a cut cone surface with circular ports. The ports can be created either orthogonal to the surface or
parallel to the cone axis (paraxial). The coordinates (x,y,z) are the end points of the port.</p>
<a class="reference internal image-reference" href="_images/kgeobag_conic_section_port_housing_surface_model.png"><img alt="_images/kgeobag_conic_section_port_housing_surface_model.png" src="_images/kgeobag_conic_section_port_housing_surface_model.png" style="width: 400pt;" /></a>
<ul class="simple">
<li><p>Works with MeshViewer: Yes.</p></li>
<li><p>Works with GeometryViewer: No.</p></li>
</ul>
<p>An XML example is as follows:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><code><span class="nt">&lt;conic_section_port_housing_surface</span> <span class="na">name=</span><span class="s">&quot;example_conic_section_port_housing_surface&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;conic_section_port_housing</span> <span class="na">r1=</span><span class="s">&quot;2.75&quot;</span> <span class="na">z1=</span><span class="s">&quot;-1.79675&quot;</span> <span class="na">r2=</span><span class="s">&quot;0.25&quot;</span> <span class="na">z2=</span><span class="s">&quot;-0.067&quot;</span> <span class="na">longitudinal_mesh_count=</span><span class="s">&quot;100&quot;</span> <span class="na">axial_mesh_count=</span><span class="s">&quot;100&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;offset&quot;</span> <span class="na">value=</span><span class="s">&quot;2.&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;nPorts&quot;</span> <span class="na">value=</span><span class="s">&quot;6&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;loop</span> <span class="na">variable=</span><span class="s">&quot;i&quot;</span> <span class="na">start=</span><span class="s">&quot;0&quot;</span> <span class="na">end=</span><span class="s">&quot;{[nPorts]-1}&quot;</span> <span class="na">step=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;if</span> <span class="na">condition=</span><span class="s">&quot;{([i] mod 2) eq 0}&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;orthogonal_port</span> <span class="na">x=</span><span class="s">&quot;{[offset]*TMath::Cos(2.*TMath::Pi()*[i]/[nPorts])}&quot;</span> <span class="na">y=</span><span class="s">&quot;{[offset]*TMath::Sin(2.*TMath::Pi()*[i]/[nPorts])}&quot;</span> <span class="na">z=</span><span class="s">&quot;.5&quot;</span> <span class="na">radius=</span><span class="s">&quot;{.05 + .05*([i]+1)}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/if&gt;</span>
  <span class="nt">&lt;if</span> <span class="na">condition=</span><span class="s">&quot;{([i] mod 2) eq 1}&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;paraxial_port</span> <span class="na">x=</span><span class="s">&quot;{[offset]*TMath::Cos(2.*TMath::Pi()*[i]/[nPorts])}&quot;</span> <span class="na">y=</span><span class="s">&quot;{[offset]*TMath::Sin(2.*TMath::Pi()*[i]/[nPorts])}&quot;</span> <span class="na">z=</span><span class="s">&quot;.5&quot;</span> <span class="na">radius=</span><span class="s">&quot;{.05 + .05*([i]+1)}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/if&gt;</span>
<span class="nt">&lt;/loop&gt;</span>
  <span class="nt">&lt;/conic_section_port_housing&gt;</span>
<span class="nt">&lt;/conic_section_port_housing_surface&gt;</span>
</code></pre></div></div>
</div>
<div class="section" id="beam">
<h3>Beam<a class="headerlink" href="#beam" title="Permalink to this headline">¶</a></h3>
<p>A beam creates a pipe which connects two polygons at each end. The polygons must have the same number of vertices but
may lie in planes which are not parallel to each other. For the description of the parameters involved see the images
below.</p>
<a class="reference internal image-reference" href="_images/beam_description.png"><img alt="_images/beam_description.png" src="_images/beam_description.png" style="width: 250pt;" /></a>
<p>In the following example, the variable <code class="docutils literal notranslate"><span class="pre">[poly]</span></code> dictates the the number of vertexes in each polygon at the ends of the
beam.</p>
<a class="reference internal image-reference" href="_images/kgeobag_beam_surface_model.png"><img alt="_images/kgeobag_beam_surface_model.png" src="_images/kgeobag_beam_surface_model.png" style="width: 400pt;" /></a>
<ul class="simple">
<li><p>Works with MeshViewer: Yes.</p></li>
<li><p>Works with GeometryViewer: No.</p></li>
</ul>
<p>An XML example is as follows:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><code><span class="nt">&lt;beam_surface</span> <span class="na">name=</span><span class="s">&quot;example_beam_surface&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;beam</span> <span class="na">longitudinal_mesh_count=</span><span class="s">&quot;20&quot;</span> <span class="na">axial_mesh_count=</span><span class="s">&quot;20&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;poly&quot;</span> <span class="na">value=</span><span class="s">&quot;50&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;radius&quot;</span> <span class="na">value=</span><span class="s">&quot;.5&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;z_start_max&quot;</span> <span class="na">value=</span><span class="s">&quot;-.25&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;z_start_min&quot;</span> <span class="na">value=</span><span class="s">&quot;-.75&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;z_end_max&quot;</span> <span class="na">value=</span><span class="s">&quot;.75&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;z_end_min&quot;</span> <span class="na">value=</span><span class="s">&quot;.25&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;loop</span> <span class="na">variable=</span><span class="s">&quot;i&quot;</span> <span class="na">start=</span><span class="s">&quot;0&quot;</span> <span class="na">end=</span><span class="s">&quot;[poly]&quot;</span> <span class="na">step=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;start_line</span> <span class="na">x1=</span><span class="s">&quot;{[radius]*TMath::Cos(2.*TMath::Pi()*[i]/[poly])}&quot;</span> <span class="na">y1=</span><span class="s">&quot;{[radius]*TMath::Sin(2.*TMath::Pi()*[i]/[poly])}&quot;</span> <span class="na">z1=</span><span class="s">&quot;{([z_start_max]+[z_start_min])*.5 + ([z_start_max]-[z_start_min])*TMath::Cos(2.*TMath::Pi()*[i]/[poly])}&quot;</span> <span class="na">x2=</span><span class="s">&quot;{[radius]*TMath::Cos(2.*TMath::Pi()*(([i]+1) mod [poly])/[poly])}&quot;</span> <span class="na">y2=</span><span class="s">&quot;{[radius]*TMath::Sin(2.*TMath::Pi()*(([i]+1) mod [poly])/[poly])}&quot;</span> <span class="na">z2=</span><span class="s">&quot;{([z_start_max]+[z_start_min])*.5 + ([z_start_max]-[z_start_min])*TMath::Cos(2.*TMath::Pi()*(([i]+1) mod [poly])/[poly])}&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;end_line</span> <span class="na">x1=</span><span class="s">&quot;{[radius]*TMath::Cos(2.*TMath::Pi()*[i]/[poly])}&quot;</span> <span class="na">y1=</span><span class="s">&quot;{[radius]*TMath::Sin(2.*TMath::Pi()*[i]/[poly])}&quot;</span> <span class="na">z1=</span><span class="s">&quot;{([z_end_max]+[z_end_min])*.5 + ([z_end_max]-[z_end_min])*TMath::Cos(2.*TMath::Pi()*[i]/[poly])}&quot;</span> <span class="na">x2=</span><span class="s">&quot;{[radius]*TMath::Cos(2.*TMath::Pi()*(([i]+1) mod [poly])/[poly])}&quot;</span> <span class="na">y2=</span><span class="s">&quot;{[radius]*TMath::Sin(2.*TMath::Pi()*(([i]+1) mod [poly])/[poly])}&quot;</span> <span class="na">z2=</span><span class="s">&quot;{([z_end_max]+[z_end_min])*.5 + ([z_end_max]-[z_end_min])*TMath::Cos(2.*TMath::Pi()*(([i]+1) mod [poly])/[poly])}&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/loop&gt;</span>
    <span class="nt">&lt;/beam&gt;</span>
<span class="nt">&lt;/beam_surface&gt;</span>
</code></pre></div></div>
<p>The beam shape can also be used to create more complex objects, such as a cut cone with two more cuts at both ends.</p>
<a class="reference internal image-reference" href="_images/kgeobag_multicut_surface_model.png"><img alt="_images/kgeobag_multicut_surface_model.png" src="_images/kgeobag_multicut_surface_model.png" style="width: 400pt;" /></a>
<p>An XML example is as follows:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><code><span class="nt">&lt;beam_surface</span> <span class="na">name=</span><span class="s">&quot;example_multicut_surface&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;beam</span> <span class="na">longitudinal_mesh_count=</span><span class="s">&quot;60&quot;</span> <span class="na">axial_mesh_count=</span><span class="s">&quot;60&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;z_start&quot;</span> <span class="na">value=</span><span class="s">&quot;-1.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;z_end&quot;</span> <span class="na">value=</span><span class="s">&quot;1.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;radius_start&quot;</span> <span class="na">value=</span><span class="s">&quot;2.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;radius_end&quot;</span> <span class="na">value=</span><span class="s">&quot;1.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;phi_start&quot;</span> <span class="na">value=</span><span class="s">&quot;0.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;theta_start&quot;</span> <span class="na">value=</span><span class="s">&quot;30.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;phi_end&quot;</span> <span class="na">value=</span><span class="s">&quot;90.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;theta_end&quot;</span> <span class="na">value=</span><span class="s">&quot;30.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;poly&quot;</span> <span class="na">value=</span><span class="s">&quot;100&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;loop</span> <span class="na">variable=</span><span class="s">&quot;i&quot;</span> <span class="na">start=</span><span class="s">&quot;0&quot;</span> <span class="na">end=</span><span class="s">&quot;[poly]&quot;</span> <span class="na">step=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;start_line</span> <span class="na">x1=</span><span class="s">&quot;{[radius_start]*(cos(2.*TMath::Pi()*([i]/[poly]-[phi_start]/360.))*cos([phi_start]/180.*TMath::Pi()) - sin(2.*TMath::Pi()*([i]/[poly]-[phi_start]/360.))*sin([phi_start]/180.*TMath::Pi()))}&quot;</span>
                            <span class="na">y1=</span><span class="s">&quot;{[radius_start]*cos([theta_start]/180.*TMath::Pi())*(cos(2.*TMath::Pi()*([i]/[poly]-[phi_start]/360.))*sin([phi_start]/180.*TMath::Pi()) +sin(2.*TMath::Pi()*([i]/[poly]-[phi_start]/360.))*cos([phi_start]/180.*TMath::Pi()))}&quot;</span>
                            <span class="na">z1=</span><span class="s">&quot;{[radius_start]*sin([theta_start]/180.*TMath::Pi())*(cos(2.*TMath::Pi()*([i]/[poly]-[phi_start]/360.))*sin([phi_start]/180.*TMath::Pi()) +sin(2.*TMath::Pi()*([i]/[poly]-[phi_start]/360.))*cos([phi_start]/180.*TMath::Pi()))+[z_start]}&quot;</span>
                            <span class="na">x2=</span><span class="s">&quot;{[radius_start]*(cos(2.*TMath::Pi()*((([i]+1) mod [poly])/[poly]-[phi_start]/360.))*cos([phi_start]/180.*TMath::Pi()) -sin(2.*TMath::Pi()*((([i]+1) mod [poly])/[poly]-[phi_start]/360.))*sin([phi_start]/180.*TMath::Pi()))}&quot;</span>
                            <span class="na">y2=</span><span class="s">&quot;{[radius_start]*cos([theta_start]/180.*TMath::Pi())*(cos(2.*TMath::Pi()*((([i]+1) mod [poly])/[poly]-[phi_start]/360.))*sin([phi_start]/180.*TMath::Pi()) +sin(2.*TMath::Pi()*((([i]+1) mod [poly])/[poly]-[phi_start]/360.))*cos([phi_start]/180.*TMath::Pi()))}&quot;</span>
                            <span class="na">z2=</span><span class="s">&quot;{[radius_start]*sin([theta_start]/180.*TMath::Pi())*(cos(2.*TMath::Pi()*((([i]+1) mod [poly])/[poly]-[phi_start]/360.))*sin([phi_start]/180.*TMath::Pi()) + sin(2.*TMath::Pi()*((([i]+1) mod [poly])/[poly]-[phi_start]/360.))*cos([phi_start]/180.*TMath::Pi()))+[z_start]}&quot;</span>
            <span class="nt">/&gt;</span>
            <span class="nt">&lt;end_line</span> <span class="na">x1=</span><span class="s">&quot;{[radius_end]*(cos(2.*TMath::Pi()*([i]/[poly]-[phi_end]/360.))*cos([phi_end]/180.*TMath::Pi()) -sin(2.*TMath::Pi()*([i]/[poly]-[phi_end]/360.))*sin([phi_end]/180.*TMath::Pi()))}&quot;</span>
                      <span class="na">y1=</span><span class="s">&quot;{[radius_end]*cos([theta_end]/180.*TMath::Pi())*(cos(2.*TMath::Pi()*([i]/[poly]-[phi_end]/360.))*sin([phi_end]/180.*TMath::Pi()) + sin(2.*TMath::Pi()*([i]/[poly]-[phi_end]/360.))*cos([phi_end]/180.*TMath::Pi()))}&quot;</span>
                      <span class="na">z1=</span><span class="s">&quot;{[radius_end]*sin([theta_end]/180.*TMath::Pi())*(cos(2.*TMath::Pi()*([i]/[poly]-[phi_end]/360.))*sin([phi_end]/180.*TMath::Pi()) +sin(2.*TMath::Pi()*([i]/[poly]-[phi_end]/360.))*cos([phi_end]/180.*TMath::Pi()))+[z_end]}&quot;</span>
                      <span class="na">x2=</span><span class="s">&quot;{[radius_end]*(cos(2.*TMath::Pi()*((([i]+1) mod [poly])/[poly]-[phi_end]/360.))*cos([phi_end]/180.*TMath::Pi()) - sin(2.*TMath::Pi()*((([i]+1) mod [poly])/[poly]-[phi_end]/360.))*sin([phi_end]/180.*TMath::Pi()))}&quot;</span>
                      <span class="na">y2=</span><span class="s">&quot;{[radius_end]*cos([theta_end]/180.*TMath::Pi())*(cos(2.*TMath::Pi()*((([i]+1) mod [poly])/[poly]-[phi_end]/360.))*sin([phi_end]/180.*TMath::Pi()) + sin(2.*TMath::Pi()*((([i]+1) mod [poly])/[poly]-[phi_end]/360.))*cos([phi_end]/180.*TMath::Pi()))}&quot;</span>
                      <span class="na">z2=</span><span class="s">&quot;{[radius_end]*sin([theta_end]/180.*TMath::Pi())*(cos(2.*TMath::Pi()*((([i]+1) mod [poly])/[poly]-[phi_end]/360.))*sin([phi_end]/180.*TMath::Pi()) + sin(2.*TMath::Pi()*((([i]+1) mod [poly])/[poly]-[phi_end]/360.))*cos([phi_end]/180.*TMath::Pi()))+[z_end]}&quot;</span>
            <span class="nt">/&gt;</span>
        <span class="nt">&lt;/loop&gt;</span>
    <span class="nt">&lt;/beam&gt;</span>
<span class="nt">&lt;/beam_surface&gt;</span>
</code></pre></div></div>
</div>
<div class="section" id="rod">
<h3>Rod<a class="headerlink" href="#rod" title="Permalink to this headline">¶</a></h3>
<p>The rod element can be used to create a rod like structure along a series of linear segments in three dimensional space.
The rod has a circular cross section which is approximated by a polygon (governed by the <code class="docutils literal notranslate"><span class="pre">axial_mesh_count</span></code>
parameter). This shape is defined by a radius (thickness of the rod) and a piecewise linear path specified by a by a
list of in-order vertexes.</p>
<a class="reference internal image-reference" href="_images/kgeobag_rod_surface_model.png"><img alt="_images/kgeobag_rod_surface_model.png" src="_images/kgeobag_rod_surface_model.png" style="width: 400pt;" /></a>
<ul class="simple">
<li><p>Works with MeshViewer: Yes.</p></li>
<li><p>Works with GeometryViewer: No.</p></li>
</ul>
<p>The following XML example creates a helix shaped rod surface, as follows:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><code><span class="nt">&lt;rod_surface</span> <span class="na">name=</span><span class="s">&quot;example_rod_surface&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;rod</span> <span class="na">radius=</span><span class="s">&quot;0.2&quot;</span> <span class="na">longitudinal_mesh_count=</span><span class="s">&quot;100&quot;</span> <span class="na">axial_mesh_count=</span><span class="s">&quot;12&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;n_turns&quot;</span> <span class="na">value=</span><span class="s">&quot;5&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;n_segments_per_turn&quot;</span> <span class="na">value=</span><span class="s">&quot;36&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;coil_radius&quot;</span> <span class="na">value=</span><span class="s">&quot;1.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;height_per_turn&quot;</span> <span class="na">value=</span><span class="s">&quot;1.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;loop</span> <span class="na">variable=</span><span class="s">&quot;i&quot;</span> <span class="na">start=</span><span class="s">&quot;0&quot;</span> <span class="na">end=</span><span class="s">&quot;{[n_turns]*[n_segments_per_turn]}&quot;</span> <span class="na">step=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;vertex</span> <span class="na">x=</span><span class="s">&quot;{[coil_radius]*TMath::Cos(2.*TMath::Pi()*([i] mod [n_segments_per_turn])/[n_segments_per_turn])}&quot;</span> <span class="na">y=</span><span class="s">&quot;{[coil_radius]*TMath::Sin(2.*TMath::Pi()*([i] mod [n_segments_per_turn])/[n_segments_per_turn])}&quot;</span> <span class="na">z=</span><span class="s">&quot;{[i]*[height_per_turn]/[n_segments_per_turn]}&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/loop&gt;</span>
    <span class="nt">&lt;/rod&gt;</span>
<span class="nt">&lt;/rod_surface&gt;</span>
</code></pre></div></div>
</div>
<div class="section" id="extruded-surfaces-with-holes">
<h3>Extruded surfaces with holes<a class="headerlink" href="#extruded-surfaces-with-holes" title="Permalink to this headline">¶</a></h3>
<p>With this element it is possible to create an extruded surface (from a poly-loop like curve) with arbitrary holes in it.
The commands <code class="docutils literal notranslate"><span class="pre">&lt;inner_...&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;outer_...&gt;</span></code> define whether the extruded path will produce an outer or an inner
surface. Therefore, they define if there will be a hole in the surface and its shape.</p>
<a class="reference internal image-reference" href="_images/kgeobag_extruded_surface_model.png"><img alt="_images/kgeobag_extruded_surface_model.png" src="_images/kgeobag_extruded_surface_model.png" style="width: 400pt;" /></a>
<ul class="simple">
<li><p>Works with MeshViewer: Yes.</p></li>
<li><p>Works with GeometryViewer: No.</p></li>
</ul>
<p>An XML example is as follows:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><code><span class="nt">&lt;extruded_surface</span> <span class="na">name=</span><span class="s">&quot;example_extruded_surface&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;extruded_object</span> <span class="na">z_min=</span><span class="s">&quot;-1.&quot;</span> <span class="na">z_max=</span><span class="s">&quot;1.&quot;</span> <span class="na">longitudinal_mesh_count=</span><span class="s">&quot;40&quot;</span> <span class="na">longitudinal_mesh_power=</span><span class="s">&quot;2.&quot;</span> <span class="na">closed_form=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;inner_line</span> <span class="na">x1=</span><span class="s">&quot;-.5&quot;</span> <span class="na">y1=</span><span class="s">&quot;-.5&quot;</span> <span class="na">x2=</span><span class="s">&quot;-.5&quot;</span> <span class="na">y2=</span><span class="s">&quot;.5&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;inner_arc</span> <span class="na">x1=</span><span class="s">&quot;-.5&quot;</span> <span class="na">y1=</span><span class="s">&quot;.5&quot;</span> <span class="na">x2=</span><span class="s">&quot;.5&quot;</span> <span class="na">y2=</span><span class="s">&quot;.5&quot;</span> <span class="na">radius=</span><span class="s">&quot;1.&quot;</span> <span class="na">positive_orientation=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;inner_arc</span> <span class="na">x1=</span><span class="s">&quot;.5&quot;</span> <span class="na">y1=</span><span class="s">&quot;.5&quot;</span> <span class="na">x2=</span><span class="s">&quot;.5&quot;</span> <span class="na">y2=</span><span class="s">&quot;-.5&quot;</span> <span class="na">radius=</span><span class="s">&quot;1.&quot;</span> <span class="na">positive_orientation=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;inner_arc</span> <span class="na">x1=</span><span class="s">&quot;.5&quot;</span> <span class="na">y1=</span><span class="s">&quot;-.5&quot;</span> <span class="na">x2=</span><span class="s">&quot;-.5&quot;</span> <span class="na">y2=</span><span class="s">&quot;-.5&quot;</span> <span class="na">radius=</span><span class="s">&quot;1.&quot;</span> <span class="na">positive_orientation=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;outer_arc</span> <span class="na">x1=</span><span class="s">&quot;-1.&quot;</span> <span class="na">y1=</span><span class="s">&quot;-1.&quot;</span> <span class="na">x2=</span><span class="s">&quot;-1.&quot;</span> <span class="na">y2=</span><span class="s">&quot;1.&quot;</span> <span class="na">radius=</span><span class="s">&quot;{TMath::Sqrt(2.)}&quot;</span> <span class="na">positive_orientation=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;outer_line</span> <span class="na">x1=</span><span class="s">&quot;-1.&quot;</span> <span class="na">y1=</span><span class="s">&quot;1.&quot;</span> <span class="na">x2=</span><span class="s">&quot;1.&quot;</span> <span class="na">y2=</span><span class="s">&quot;1.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;outer_line</span> <span class="na">x1=</span><span class="s">&quot;1.&quot;</span> <span class="na">y1=</span><span class="s">&quot;1.&quot;</span> <span class="na">x2=</span><span class="s">&quot;1.&quot;</span> <span class="na">y2=</span><span class="s">&quot;-1.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;outer_line</span> <span class="na">x1=</span><span class="s">&quot;1.&quot;</span> <span class="na">y1=</span><span class="s">&quot;-1.&quot;</span> <span class="na">x2=</span><span class="s">&quot;-1.&quot;</span> <span class="na">y2=</span><span class="s">&quot;-1.&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/extruded_object&gt;</span>
<span class="nt">&lt;/extruded_surface&gt;</span>
</code></pre></div></div>
</div>
<div class="section" id="rotated-surface">
<h3>Rotated surface<a class="headerlink" href="#rotated-surface" title="Permalink to this headline">¶</a></h3>
<p>This shape is very similar to rotated poly-line surface in <a class="reference internal" href="kgeobag_basic.html#basic-kgeobag-label"><span class="std std-ref">Basic Shapes in KGeoBag</span></a> but with other variables. The
coordinates in use in this shape are cylindrical. (z,r)</p>
<a class="reference internal image-reference" href="_images/kgeobag_rotated_surface_model.png"><img alt="_images/kgeobag_rotated_surface_model.png" src="_images/kgeobag_rotated_surface_model.png" style="width: 400pt;" /></a>
<ul class="simple">
<li><p>Works with MeshViewer: Yes.</p></li>
<li><p>Works with GeometryViewer: No.</p></li>
</ul>
<p>An XML example is as follows:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><code><span class="nt">&lt;rotated_surface</span> <span class="na">name=</span><span class="s">&quot;example_rotated_surface&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;rotated_object</span> <span class="na">longitudinal_mesh_count_start=</span><span class="s">&quot;10&quot;</span> <span class="na">longitudinal_mesh_count_end=</span><span class="s">&quot;20&quot;</span> <span class="na">longitudinal_mesh_power=</span><span class="s">&quot;2.&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;line</span> <span class="na">z1=</span><span class="s">&quot;-1.&quot;</span> <span class="na">r1=</span><span class="s">&quot;0.&quot;</span> <span class="na">z2=</span><span class="s">&quot;-1.&quot;</span> <span class="na">r2=</span><span class="s">&quot;1.5&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;line</span> <span class="na">z1=</span><span class="s">&quot;-1.&quot;</span> <span class="na">r1=</span><span class="s">&quot;1.5&quot;</span> <span class="na">z2=</span><span class="s">&quot;0.&quot;</span> <span class="na">r2=</span><span class="s">&quot;1.5&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;line</span> <span class="na">z1=</span><span class="s">&quot;0.&quot;</span> <span class="na">r1=</span><span class="s">&quot;1.5&quot;</span> <span class="na">z2=</span><span class="s">&quot;0.&quot;</span> <span class="na">r2=</span><span class="s">&quot;.5&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;line</span> <span class="na">z1=</span><span class="s">&quot;0.&quot;</span> <span class="na">r1=</span><span class="s">&quot;.5&quot;</span> <span class="na">z2=</span><span class="s">&quot;1.&quot;</span> <span class="na">r2=</span><span class="s">&quot;.5&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;arc</span> <span class="na">z1=</span><span class="s">&quot;1.&quot;</span> <span class="na">r1=</span><span class="s">&quot;.5&quot;</span> <span class="na">z2=</span><span class="s">&quot;1.&quot;</span> <span class="na">r2=</span><span class="s">&quot;1.&quot;</span> <span class="na">radius=</span><span class="s">&quot;.5&quot;</span> <span class="na">positive_orientation=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;line</span> <span class="na">z1=</span><span class="s">&quot;1.&quot;</span> <span class="na">r1=</span><span class="s">&quot;1.&quot;</span> <span class="na">z2=</span><span class="s">&quot;2.&quot;</span> <span class="na">r2=</span><span class="s">&quot;1.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;arc</span> <span class="na">z1=</span><span class="s">&quot;2.&quot;</span> <span class="na">r1=</span><span class="s">&quot;1.&quot;</span> <span class="na">z2=</span><span class="s">&quot;0.&quot;</span> <span class="na">r2=</span><span class="s">&quot;2.&quot;</span> <span class="na">radius=</span><span class="s">&quot;2&quot;</span> <span class="na">positive_orientation=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/rotated_object&gt;</span>
<span class="nt">&lt;/rotated_surface&gt;</span>
</code></pre></div></div>
</div>
</div>
<div class="section" id="spaces">
<h2>Spaces<a class="headerlink" href="#spaces" title="Permalink to this headline">¶</a></h2>
<p>These elements generate volume (filled) objects. The for the following geometries is not supported at the moment. For
the definition of the variables see the corresponding surfaces above.</p>
<div class="section" id="pump-port-space">
<h3>Pump Port Space<a class="headerlink" href="#pump-port-space" title="Permalink to this headline">¶</a></h3>
<p>For visualization, see the above pump port surface.</p>
<ul class="simple">
<li><p>Works with GeometryViewer: No.</p></li>
<li><p>Works with MeshViewer: No.</p></li>
</ul>
<p>An XML example is as follows:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><code><span class="nt">&lt;port_housing_space</span> <span class="na">name=</span><span class="s">&quot;example_port_housing_space&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;port_housing</span> <span class="na">x1=</span><span class="s">&quot;0.&quot;</span> <span class="na">y1=</span><span class="s">&quot;0.&quot;</span> <span class="na">z1=</span><span class="s">&quot;-1.&quot;</span> <span class="na">x2=</span><span class="s">&quot;0.&quot;</span> <span class="na">y2=</span><span class="s">&quot;0.&quot;</span> <span class="na">z2=</span><span class="s">&quot;1.&quot;</span> <span class="na">radius=</span><span class="s">&quot;0.4&quot;</span> <span class="na">longitudinal_mesh_count=</span><span class="s">&quot;50&quot;</span> <span class="na">axial_mesh_count=</span><span class="s">&quot;50&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;circular_port</span> <span class="na">x=</span><span class="s">&quot;1.5&quot;</span> <span class="na">y=</span><span class="s">&quot;1.5&quot;</span> <span class="na">z=</span><span class="s">&quot;-.3&quot;</span> <span class="na">radius=</span><span class="s">&quot;0.33&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;rectangular_port</span> <span class="na">x=</span><span class="s">&quot;0.&quot;</span> <span class="na">y=</span><span class="s">&quot;1.&quot;</span> <span class="na">z=</span><span class="s">&quot;.3&quot;</span> <span class="na">length=</span><span class="s">&quot;0.3&quot;</span> <span class="na">width=</span><span class="s">&quot;.15&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;circular_port</span> <span class="na">x=</span><span class="s">&quot;-1./sqrt(2.)&quot;</span> <span class="na">y=</span><span class="s">&quot;-1./sqrt(2.)&quot;</span> <span class="na">z=</span><span class="s">&quot;-.5&quot;</span> <span class="na">radius=</span><span class="s">&quot;0.053&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/port_housing&gt;</span>
<span class="nt">&lt;/port_housing_space&gt;</span>
</code></pre></div></div>
</div>
<div class="section" id="conic-section-pump-port-space">
<h3>Conic Section Pump Port Space<a class="headerlink" href="#conic-section-pump-port-space" title="Permalink to this headline">¶</a></h3>
<p>For visualization, see the above conic section pump port surface.</p>
<ul class="simple">
<li><p>Works with GeometryViewer: No.</p></li>
<li><p>Works with MeshViewer: No.</p></li>
</ul>
<p>An XML example is as follows:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><code><span class="nt">&lt;conic_section_port_housing_space</span> <span class="na">name=</span><span class="s">&quot;example_conic_section_port_housing_space&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;conic_section_port_housing</span> <span class="na">r1=</span><span class="s">&quot;2.75&quot;</span> <span class="na">z1=</span><span class="s">&quot;-1.79675&quot;</span> <span class="na">r2=</span><span class="s">&quot;0.25&quot;</span> <span class="na">z2=</span><span class="s">&quot;-0.067&quot;</span> <span class="na">longitudinal_mesh_count=</span><span class="s">&quot;100&quot;</span> <span class="na">axial_mesh_count=</span><span class="s">&quot;100&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;offset_&quot;</span> <span class="na">value=</span><span class="s">&quot;2.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;nPorts_&quot;</span> <span class="na">value=</span><span class="s">&quot;6&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;loop</span> <span class="na">variable=</span><span class="s">&quot;i&quot;</span> <span class="na">start=</span><span class="s">&quot;0&quot;</span> <span class="na">end=</span><span class="s">&quot;{[nPorts_]-1}&quot;</span> <span class="na">step=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;if</span> <span class="na">condition=</span><span class="s">&quot;{([i] mod 2) eq 0}&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;orthogonal_port</span> <span class="na">x=</span><span class="s">&quot;{[offset_]*TMath::Cos(2.*TMath::Pi()*[i]/[nPorts_])}&quot;</span> <span class="na">y=</span><span class="s">&quot;{[offset_]*TMath::Sin(2.*TMath::Pi()*[i]/[nPorts_])}&quot;</span> <span class="na">z=</span><span class="s">&quot;.5&quot;</span> <span class="na">radius=</span><span class="s">&quot;{.05 + .05*([i]+1)}&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/if&gt;</span>
            <span class="nt">&lt;if</span> <span class="na">condition=</span><span class="s">&quot;{([i] mod 2) eq 1}&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;paraxial_port</span> <span class="na">x=</span><span class="s">&quot;{[offset_]*TMath::Cos(2.*TMath::Pi()*[i]/[nPorts_])}&quot;</span> <span class="na">y=</span><span class="s">&quot;{[offset_]*TMath::Sin(2.*TMath::Pi()*[i]/[nPorts_])}&quot;</span> <span class="na">z=</span><span class="s">&quot;.5&quot;</span> <span class="na">radius=</span><span class="s">&quot;{.05 + .05*([i]+1)}&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/if&gt;</span>
        <span class="nt">&lt;/loop&gt;</span>
    <span class="nt">&lt;/conic_section_port_housing&gt;</span>
<span class="nt">&lt;/conic_section_port_housing_space&gt;</span>
</code></pre></div></div>
</div>
<div class="section" id="beam-space">
<h3>Beam Space<a class="headerlink" href="#beam-space" title="Permalink to this headline">¶</a></h3>
<p>For visualization, see the beam surface above.</p>
<ul class="simple">
<li><p>Works with GeometryViewer: No.</p></li>
<li><p>Works with MeshViewer: No.</p></li>
</ul>
<p>An XML example is as follows:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><code><span class="nt">&lt;beam_space</span> <span class="na">name=</span><span class="s">&quot;example_beam_space&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;beam</span> <span class="na">longitudinal_mesh_count=</span><span class="s">&quot;20&quot;</span> <span class="na">axial_mesh_count=</span><span class="s">&quot;20&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;poly_&quot;</span> <span class="na">value=</span><span class="s">&quot;50&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;radius_&quot;</span> <span class="na">value=</span><span class="s">&quot;.5&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;z_start_max_&quot;</span> <span class="na">value=</span><span class="s">&quot;-.25&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;z_start_min_&quot;</span> <span class="na">value=</span><span class="s">&quot;-.75&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;z_end_max_&quot;</span> <span class="na">value=</span><span class="s">&quot;.75&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;z_end_min_&quot;</span> <span class="na">value=</span><span class="s">&quot;.25&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;loop</span> <span class="na">variable=</span><span class="s">&quot;i&quot;</span> <span class="na">start=</span><span class="s">&quot;0&quot;</span> <span class="na">end=</span><span class="s">&quot;[poly_]&quot;</span> <span class="na">step=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;start_line</span> <span class="na">x1=</span><span class="s">&quot;{[radius_]*TMath::Cos(2.*TMath::Pi()*[i]/[poly_])}&quot;</span> <span class="na">y1=</span><span class="s">&quot;{[radius_]*TMath::Sin(2.*TMath::Pi()*[i]/[poly_])}&quot;</span> <span class="na">z1=</span><span class="s">&quot;{([z_start_max_]+[z_start_min_])*.5 + ([z_start_max_]-[z_start_min_])*TMath::Cos(2.*TMath::Pi()*[i]/[poly_])}&quot;</span> <span class="na">x2=</span><span class="s">&quot;{[radius_]*TMath::Cos(2.*TMath::Pi()*(([i]+1) mod [poly_])/[poly_])}&quot;</span> <span class="na">y2=</span><span class="s">&quot;{[radius_]*TMath::Sin(2.*TMath::Pi()*(([i]+1) mod [poly_])/[poly_])}&quot;</span> <span class="na">z2=</span><span class="s">&quot;{([z_start_max_]+[z_start_min_])*.5 + ([z_start_max_]-[z_start_min_])*TMath::Cos(2.*TMath::Pi()*(([i]+1) mod [poly_])/[poly_])}&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;end_line</span> <span class="na">x1=</span><span class="s">&quot;{[radius_]*TMath::Cos(2.*TMath::Pi()*[i]/[poly_])}&quot;</span> <span class="na">y1=</span><span class="s">&quot;{[radius_]*TMath::Sin(2.*TMath::Pi()*[i]/[poly_])}&quot;</span> <span class="na">z1=</span><span class="s">&quot;{([z_end_max_]+[z_end_min_])*.5 + ([z_end_max_]-[z_end_min_])*TMath::Cos(2.*TMath::Pi()*[i]/[poly_])}&quot;</span> <span class="na">x2=</span><span class="s">&quot;{[radius_]*TMath::Cos(2.*TMath::Pi()*(([i]+1) mod [poly_])/[poly_])}&quot;</span> <span class="na">y2=</span><span class="s">&quot;{[radius_]*TMath::Sin(2.*TMath::Pi()*(([i]+1) mod [poly_])/[poly_])}&quot;</span> <span class="na">z2=</span><span class="s">&quot;{([z_end_max_]+[z_end_min_])*.5 + ([z_end_max_]-[z_end_min_])*TMath::Cos(2.*TMath::Pi()*(([i]+1) mod [poly_])/[poly_])}&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/loop&gt;</span>
    <span class="nt">&lt;/beam&gt;</span>
<span class="nt">&lt;/beam_space&gt;</span>
</code></pre></div></div>
</div>
<div class="section" id="rod-space">
<h3>Rod Space<a class="headerlink" href="#rod-space" title="Permalink to this headline">¶</a></h3>
<p>For visualization, see the above rod surface.</p>
<ul class="simple">
<li><p>Works with GeometryViewer: No.</p></li>
<li><p>Works with MeshViewer: No.</p></li>
</ul>
<p>An XML example is as follows:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><code><span class="nt">&lt;rod_space</span> <span class="na">name=</span><span class="s">&quot;example_rod_space&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;rod</span> <span class="na">radius=</span><span class="s">&quot;0.2&quot;</span> <span class="na">longitudinal_mesh_count=</span><span class="s">&quot;100&quot;</span> <span class="na">axial_mesh_count=</span><span class="s">&quot;12&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;n_turns_&quot;</span> <span class="na">value=</span><span class="s">&quot;5&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;n_segments_per_turn_&quot;</span> <span class="na">value=</span><span class="s">&quot;36&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;coil_radius_&quot;</span> <span class="na">value=</span><span class="s">&quot;1.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">&quot;height_per_turn_&quot;</span> <span class="na">value=</span><span class="s">&quot;1.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;loop</span> <span class="na">variable=</span><span class="s">&quot;i&quot;</span> <span class="na">start=</span><span class="s">&quot;0&quot;</span> <span class="na">end=</span><span class="s">&quot;{[n_turns_]*[n_segments_per_turn_]}&quot;</span> <span class="na">step=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;vertex</span> <span class="na">x=</span><span class="s">&quot;{[coil_radius_]*TMath::Cos(2.*TMath::Pi()*([i] mod [n_segments_per_turn_])/[n_segments_per_turn_])}&quot;</span> <span class="na">y=</span><span class="s">&quot;{[coil_radius_]*TMath::Sin(2.*TMath::Pi()*([i] mod [n_segments_per_turn_])/[n_segments_per_turn_])}&quot;</span> <span class="na">z=</span><span class="s">&quot;{[i]*[height_per_turn_]/[n_segments_per_turn_]}&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/loop&gt;</span>
    <span class="nt">&lt;/rod&gt;</span>
<span class="nt">&lt;/rod_space&gt;</span>
</code></pre></div></div>
</div>
<div class="section" id="extruded-space">
<h3>Extruded Space<a class="headerlink" href="#extruded-space" title="Permalink to this headline">¶</a></h3>
<p>For visualization see the above extruded space.</p>
<ul class="simple">
<li><p>Works with GeometryViewer: No.</p></li>
<li><p>Works with MeshViewer: No.</p></li>
</ul>
<p>An XML example is as follows:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><code><span class="nt">&lt;extruded_space</span> <span class="na">name=</span><span class="s">&quot;example_extruded_space&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;extruded_object</span> <span class="na">z_min=</span><span class="s">&quot;-1.&quot;</span> <span class="na">z_max=</span><span class="s">&quot;1.&quot;</span> <span class="na">longitudinal_mesh_count=</span><span class="s">&quot;40&quot;</span> <span class="na">longitudinal_mesh_power=</span><span class="s">&quot;2.&quot;</span> <span class="na">closed_form=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;inner_line</span> <span class="na">x1=</span><span class="s">&quot;-.5&quot;</span> <span class="na">y1=</span><span class="s">&quot;-.5&quot;</span> <span class="na">x2=</span><span class="s">&quot;-.5&quot;</span> <span class="na">y2=</span><span class="s">&quot;.5&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;inner_arc</span> <span class="na">x1=</span><span class="s">&quot;-.5&quot;</span> <span class="na">y1=</span><span class="s">&quot;.5&quot;</span> <span class="na">x2=</span><span class="s">&quot;.5&quot;</span> <span class="na">y2=</span><span class="s">&quot;.5&quot;</span> <span class="na">radius=</span><span class="s">&quot;1.&quot;</span> <span class="na">positive_orientation=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;inner_arc</span> <span class="na">x1=</span><span class="s">&quot;.5&quot;</span> <span class="na">y1=</span><span class="s">&quot;.5&quot;</span> <span class="na">x2=</span><span class="s">&quot;.5&quot;</span> <span class="na">y2=</span><span class="s">&quot;-.5&quot;</span> <span class="na">radius=</span><span class="s">&quot;1.&quot;</span> <span class="na">positive_orientation=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;inner_arc</span> <span class="na">x1=</span><span class="s">&quot;.5&quot;</span> <span class="na">y1=</span><span class="s">&quot;-.5&quot;</span> <span class="na">x2=</span><span class="s">&quot;-.5&quot;</span> <span class="na">y2=</span><span class="s">&quot;-.5&quot;</span> <span class="na">radius=</span><span class="s">&quot;1.&quot;</span> <span class="na">positive_orientation=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;outer_arc</span> <span class="na">x1=</span><span class="s">&quot;-1.&quot;</span> <span class="na">y1=</span><span class="s">&quot;-1.&quot;</span> <span class="na">x2=</span><span class="s">&quot;-1.&quot;</span> <span class="na">y2=</span><span class="s">&quot;1.&quot;</span> <span class="na">radius=</span><span class="s">&quot;{TMath::Sqrt(2.)}&quot;</span> <span class="na">positive_orientation=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;outer_line</span> <span class="na">x1=</span><span class="s">&quot;-1.&quot;</span> <span class="na">y1=</span><span class="s">&quot;1.&quot;</span> <span class="na">x2=</span><span class="s">&quot;1.&quot;</span> <span class="na">y2=</span><span class="s">&quot;1.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;outer_line</span> <span class="na">x1=</span><span class="s">&quot;1.&quot;</span> <span class="na">y1=</span><span class="s">&quot;1.&quot;</span> <span class="na">x2=</span><span class="s">&quot;1.&quot;</span> <span class="na">y2=</span><span class="s">&quot;-1.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;outer_line</span> <span class="na">x1=</span><span class="s">&quot;1.&quot;</span> <span class="na">y1=</span><span class="s">&quot;-1.&quot;</span> <span class="na">x2=</span><span class="s">&quot;-1.&quot;</span> <span class="na">y2=</span><span class="s">&quot;-1.&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/extruded_object&gt;</span>
<span class="nt">&lt;/extruded_space&gt;</span>
</code></pre></div></div>
</div>
<div class="section" id="rotated-space">
<h3>Rotated Space<a class="headerlink" href="#rotated-space" title="Permalink to this headline">¶</a></h3>
<p>For visualization see the above rotated surface.</p>
<ul class="simple">
<li><p>Works with GeometryViewer: No.</p></li>
<li><p>Works with MeshViewer: No.</p></li>
</ul>
<p>An XML example is as follows:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><code><span class="nt">&lt;rotated_space</span> <span class="na">name=</span><span class="s">&quot;example_rotated_space&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;rotated_object</span> <span class="na">longitudinal_mesh_count_start=</span><span class="s">&quot;10&quot;</span> <span class="na">longitudinal_mesh_count_end=</span><span class="s">&quot;20&quot;</span> <span class="na">longitudinal_mesh_power=</span><span class="s">&quot;2.&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;line</span> <span class="na">z1=</span><span class="s">&quot;-1.&quot;</span> <span class="na">r1=</span><span class="s">&quot;0.&quot;</span> <span class="na">z2=</span><span class="s">&quot;-1.&quot;</span> <span class="na">r2=</span><span class="s">&quot;1.5&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;line</span> <span class="na">z1=</span><span class="s">&quot;-1.&quot;</span> <span class="na">r1=</span><span class="s">&quot;1.5&quot;</span> <span class="na">z2=</span><span class="s">&quot;0.&quot;</span> <span class="na">r2=</span><span class="s">&quot;1.5&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;line</span> <span class="na">z1=</span><span class="s">&quot;0.&quot;</span> <span class="na">r1=</span><span class="s">&quot;1.5&quot;</span> <span class="na">z2=</span><span class="s">&quot;0.&quot;</span> <span class="na">r2=</span><span class="s">&quot;.5&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;line</span> <span class="na">z1=</span><span class="s">&quot;0.&quot;</span> <span class="na">r1=</span><span class="s">&quot;.5&quot;</span> <span class="na">z2=</span><span class="s">&quot;1.&quot;</span> <span class="na">r2=</span><span class="s">&quot;.5&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;arc</span> <span class="na">z1=</span><span class="s">&quot;1.&quot;</span> <span class="na">r1=</span><span class="s">&quot;.5&quot;</span> <span class="na">z2=</span><span class="s">&quot;1.&quot;</span> <span class="na">r2=</span><span class="s">&quot;1.&quot;</span> <span class="na">radius=</span><span class="s">&quot;.5&quot;</span> <span class="na">positive_orientation=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;line</span> <span class="na">z1=</span><span class="s">&quot;1.&quot;</span> <span class="na">r1=</span><span class="s">&quot;1.&quot;</span> <span class="na">z2=</span><span class="s">&quot;2.&quot;</span> <span class="na">r2=</span><span class="s">&quot;1.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;arc</span> <span class="na">z1=</span><span class="s">&quot;2.&quot;</span> <span class="na">r1=</span><span class="s">&quot;1.&quot;</span> <span class="na">z2=</span><span class="s">&quot;0.&quot;</span> <span class="na">r2=</span><span class="s">&quot;2.&quot;</span> <span class="na">radius=</span><span class="s">&quot;2&quot;</span> <span class="na">positive_orientation=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/rotated_object&gt;</span>
<span class="nt">&lt;/rotated_space&gt;</span>
</code></pre></div></div>
</div>
</div>
</div>
<div class="section" id="external-shapes-in-kgeobag">
<h1>External Shapes in KGeoBag<a class="headerlink" href="#external-shapes-in-kgeobag" title="Permalink to this headline">¶</a></h1>
<p>As an alternative to defining geometries via the XML file format, one may also use geometric objects from external
files. The only available file format is STL, which is supported by the majority of current 3D design software. The
STL file contains a set of triangles, which are treated as a fully meshed geometry in <em>KGeoBag</em>. As such, the geometry
is usable with <em>KEMField</em> (for electric field calculation) and <em>Kassiopeia</em> (for particle navigation.)</p>
<a class="reference internal image-reference" href="_images/kgeobag_teapot_mesh.png"><img alt="_images/kgeobag_teapot_mesh.png" src="_images/kgeobag_teapot_mesh.png" style="width: 400pt;" /></a>
<ul class="simple">
<li><p>Works with GeometryViewer: Yes.</p></li>
<li><p>Works with MeshViewer: Yes.</p></li>
</ul>
<p>An XML example is as follows:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><code><span class="nt">&lt;stl_file_surface</span> <span class="na">name=</span><span class="s">&quot;cube_surface&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;stl_file</span> <span class="na">file=</span><span class="s">&quot;Menger_sponge.stl&quot;</span> <span class="na">scale=</span><span class="s">&quot;0.5&quot;</span> <span class="na">mesh_count=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/stl_file_surface&gt;</span>

<span class="nt">&lt;stl_file_surface</span> <span class="na">name=</span><span class="s">&quot;teapot_lid&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;stl_file</span> <span class="na">file=</span><span class="s">&quot;Utah_teapot.stl&quot;</span> <span class="na">selector=</span><span class="s">&quot;-2267&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/stl_file_surface&gt;</span>

<span class="nt">&lt;stl_file_surface</span> <span class="na">name=</span><span class="s">&quot;teapot_solid_body&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;stl_file</span> <span class="na">file=</span><span class="s">&quot;Utah_teapot.stl&quot;</span> <span class="na">selector=</span><span class="s">&quot;2268-&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/stl_file_surface&gt;</span>
</code></pre></div></div>
<p>Note that because the geometry is defined by an external file, the possible modifications in the <em>KGeoBag</em> framework
are limited. Besides the translations/rotations that can be applied to any object, one may also scale the external
geometry or increase its number of mesh elements. If the triangles in the file are sufficienctly ordered, then one
can use the <code class="docutils literal notranslate"><span class="pre">selector</span></code> attribute to specify indices of the triangles to be used in <em>KGeoBag</em>. In the case of the
<code class="docutils literal notranslate"><span class="pre">Utah_teapot.stl</span></code> example file, this allows to split the lid from the pot’s body.</p>
<p>For visualization see the above STL file surface.</p>
<ul class="simple">
<li><p>Works with GeometryViewer: Yes.</p></li>
<li><p>Works with MeshViewer: Yes.</p></li>
</ul>
<p>An XML example is as follows:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><code><span class="nt">&lt;stl_file_space</span> <span class="na">name=</span><span class="s">&quot;cube_surface&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;stl_file</span> <span class="na">file=</span><span class="s">&quot;Menger_sponge.stl&quot;</span> <span class="na">scale=</span><span class="s">&quot;0.5&quot;</span> <span class="na">mesh_count=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/stl_file_space&gt;</span>
</code></pre></div></div>
</div>


    </article><section class="flex justify-between pt-4 mt-12">
  
  <div class="mr-auto">
    <span class="uppercase text-xs text-gray-light tracking-wider block mb-2">Previous</span>
    <a
      href="kgeobag_basic.html"
      title="Go to previous page"
      class="block text-link hover:text-brand focus:text-brand hover:underline focus:underline"
      >Basic Shapes in KGeoBag</a>
  </div>
  
  
  <div class="ml-auto">
    <span class="uppercase text-xs text-gray-light tracking-wider block mb-2 text-right">Next</span>
    <a
      href="output.html"
      title="Go to next page"
      class="block text-link hover:text-brand focus:text-brand hover:underline focus:underline"
      >Understanding Simulation Output</a>
  </div>
  
</section>

    <footer>
      
        <div class="mt-20 mb-4 text-sm text-gray-700">&copy; 2016-2021, The Kassiopeia developers.&nbsp;Made with <a href="https://www.sphinx-doc.org">Sphinx 4.4.0</a></div>
      
    </footer></main>


      <button
  data-search-target="snackbar"
  data-action="search#hideSnackbar"
  class="fixed bottom-0 right-0 z-20 opacity-0 p-4 m-4 tracking-wide bg-gray-900 text-gray-100 transition transform transform-gpu duration-500 translate-y-full"
>
  Clear highlights
</button><div
  data-sidebar-target="screen"
  data-action="click->sidebar#close"
  class="fixed hidden inset-0 bg-black bg-opacity-50">
</div>
    </div>
    
      
  <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
  <script src="_static/jquery.js"></script>
  <script src="_static/underscore.js"></script>
  <script src="_static/doctools.js"></script>
<script src="_static/theme.1ba02c30758e6036ba31.js"></script>
    
  </body>
</html>