<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Additional Simulation Tools &mdash; Kassiopeia 3.8 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Visualization Techniques" href="visualization.html" />
    <link rel="prev" title="Understanding Simulation Output" href="output.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #343131" >
            <a href="index.html" class="icon icon-home"> Kassiopeia
            <img src="_static/KassiopeiaLogo_1_cropped_bb.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="external_documentation.html">References, Citation and Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="compiling.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples and Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuring Your Own Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="kgeobag_basic.html">Basic KGeoBag Shapes</a></li>
<li class="toctree-l1"><a class="reference internal" href="kgeobag_complex.html">Complex KGeoBag Shapes</a></li>
<li class="toctree-l1"><a class="reference internal" href="output.html">Understanding Simulation Output</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Additional Simulation Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#geometry-viewers">Geometry viewers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#advanced-visualization">Advanced visualization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mesh-viewers">Mesh viewers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#field-calculation">Field calculation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#simulation-tools">Simulation tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization Techniques</a></li>
<li class="toctree-l1"><a class="reference internal" href="bindings.html">XML Bindings</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #343131" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Kassiopeia</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Additional Simulation Tools</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tools.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="additional-simulation-tools">
<span id="tools-label"></span><h1>Additional Simulation Tools<a class="headerlink" href="#additional-simulation-tools" title="Permalink to this headline"><span>#</span></a></h1>
<p>The main application for simulations is <code class="docutils literal notranslate"><span class="pre">Kassiopeia</span></code>. The XML interface allows flexible configuration that is suited
to many tasks. However, sometimes a more direct approach to certain investigations is needed. This is typically the
case during simulation design and debugging, and for field calculations that do not require a full-scale simulation. In
the following, additional tools that are included with <em>Kassiopeia</em>, <em>KEMField</em> and <em>KGeoBag</em> are presented.</p>
<div class="contents local topic" id="on-this-page">
<p class="topic-title">On this page</p>
<ul class="simple">
<li><p><a class="reference internal" href="#geometry-viewers" id="id3">Geometry viewers</a></p>
<ul>
<li><p><a class="reference internal" href="#usage" id="id4">Usage</a></p></li>
<li><p><a class="reference internal" href="#advanced-visualization" id="id5">Advanced visualization</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#mesh-viewers" id="id6">Mesh viewers</a></p>
<ul>
<li><p><a class="reference internal" href="#id1" id="id7">Usage</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#field-calculation" id="id8">Field calculation</a></p>
<ul>
<li><p><a class="reference internal" href="#id2" id="id9">Usage</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#simulation-tools" id="id10">Simulation tools</a></p></li>
</ul>
</div>
<div class="section" id="geometry-viewers">
<h2><a class="toc-backref" href="#id3">Geometry viewers</a><a class="headerlink" href="#geometry-viewers" title="Permalink to this headline"><span>#</span></a></h2>
<p>The geometry viewwers are intended to help with constructing and optimizing a simulation geometry that is typically
used with <em>Kassiopeia</em> and <em>KEMField</em>. In most cases, the simulation requires a sophistocated geometry setup where
additional tools are beneficial.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">GeometryDump</span></code> prints information about the selected geometry elements to the terminal. This provides a quick method
to access positions and rotations of any elements placed in the global coordinate system. The output is constructed
in <a href="#id11"><span class="problematic" id="id12">XML_</span></a> format, which can be further processed by external software.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GeometryViewer</span></code> opens a <a class="reference external" href="http://www.vtk.org/">VTK</a> visualization window showing the geometry in a 3D view. In the case that appearance
definitions are embedded in the configuration file (via the <code class="docutils literal notranslate"><span class="pre">&lt;appearance</span> <span class="pre">.../&gt;</span></code> element), the shown geometry
elements will be displayed accordingly.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GeometryViewerROOT</span></code> opens a <a class="reference external" href="https://root.cern.ch/">ROOT</a> visualization window showing the geometry in a 2D view. Spaces are shown as green
boxes, surfaces as black lines. In order to project the geometry onto a 2D plane, the center point and direction
of the plane must be defined. By default, the ROOT viewer draws the geometry in the Y-Z plane.</p></li>
</ul>
<div class="section" id="usage">
<h3><a class="toc-backref" href="#id4">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline"><span>#</span></a></h3>
<p>All listed programs will show a brief usage summary if called without arguments. The applications are called with a
configuration file name and a valid geometry path, e.g.:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>GeometryViewer QuadrupoleTrapSimulation.xml <span class="s1">&#39;world/@electrode_tag&#39;</span>
</pre></div>
</div>
<p>Below is an example of the <a class="reference external" href="http://www.vtk.org/">VTK</a> geometry viewer:</p>
<a class="reference internal image-reference" href="_images/tools_geometry_viewer.png"><img alt="_images/tools_geometry_viewer.png" src="_images/tools_geometry_viewer.png" style="width: 500pt;" /></a>
<p>In case of the <a class="reference external" href="https://root.cern.ch/">ROOT</a> viewer, additional options can be passed to define the 2D view plane:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>GeometryViewerROOT QuadrupoleTrapSimulation.xml <span class="s1">&#39;world/@electrode_tag&#39;</span> <span class="s1">&#39;world/@magnet_tag&#39;</span> --plane<span class="o">=</span>XZ
</pre></div>
</div>
<p>Below is an example of the <a class="reference external" href="https://root.cern.ch/">ROOT</a> geometry viewer:</p>
<a class="reference internal image-reference" href="_images/tools_geometry_viewer_root.png"><img alt="_images/tools_geometry_viewer_root.png" src="_images/tools_geometry_viewer_root.png" style="width: 500pt;" /></a>
<p>As shown above, it is possible to specify multiple geometry paths as well.</p>
</div>
<div class="section" id="advanced-visualization">
<h3><a class="toc-backref" href="#id5">Advanced visualization</a><a class="headerlink" href="#advanced-visualization" title="Permalink to this headline"><span>#</span></a></h3>
<p>Note that in addition to these geometry viewers, <em>Kassiopeia</em> also supports to define visualizations in the
configuration file directly so that no additional commands are necessary. For details see <a class="reference internal" href="visualization.html#visualization-label"><span class="std std-ref">Visualization Techniques</span></a>.</p>
</div>
</div>
<div class="section" id="mesh-viewers">
<h2><a class="toc-backref" href="#id6">Mesh viewers</a><a class="headerlink" href="#mesh-viewers" title="Permalink to this headline"><span>#</span></a></h2>
<p>The mesh viewers are intended to help with constructing and optimizing an electrostatic geometry that is provided
to <em>KEMField</em>. In this case a mesh needs to be defined according to the selected symmetry level. The viewers show
the defined mesh in a <a class="reference external" href="http://www.vtk.org/">VTK</a> window, coloring each mesh element individually.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">AxialMeshViewer</span></code> opens a visualization window showing the axial mesh. A corresponding mesh must be defined in the
configuration file with the <code class="docutils literal notranslate"><span class="pre">&lt;axial_mesh</span> <span class="pre">.../&gt;</span></code> element.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MeshViewer</span></code> opens a visualization window showing the asymmetric (3D) mesh. A corresponding mesh must be defined in
the configuration file with the <code class="docutils literal notranslate"><span class="pre">&lt;mesh</span> <span class="pre">.../&gt;</span></code> element.</p></li>
</ul>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id7">Usage</a><a class="headerlink" href="#id1" title="Permalink to this headline"><span>#</span></a></h3>
<p>All listed programs will show a brief usage summary if called without arguments. The viewers are called with a
configuration file name and a valid geometry path, e.g.:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>AxialMeshViewer QuadrupoleTrapSimulation.xml <span class="s1">&#39;world/@electrode_tag&#39;</span>
</pre></div>
</div>
<p>In this case, the geometry path selects all elements with the tag <cite>electrode_tag</cite>, which in this geometry corresponds
to all electrode elements. Note that because the configuration file is processed before the mesh viewer visualization,
there may be additional messages or windows shown (e.g. the internal <a class="reference external" href="http://www.vtk.org/">VTK</a> geometry viewer). Below is an example of the
axial mesh viewer:</p>
<a class="reference internal image-reference" href="_images/tools_axial_mesh_viewer.png"><img alt="_images/tools_axial_mesh_viewer.png" src="_images/tools_axial_mesh_viewer.png" style="width: 500pt;" /></a>
</div>
</div>
<div class="section" id="field-calculation">
<h2><a class="toc-backref" href="#id8">Field calculation</a><a class="headerlink" href="#field-calculation" title="Permalink to this headline"><span>#</span></a></h2>
<p>Although <em>Kassiopeia</em> is quite powerful in terms of configuration options, sometimes it is necessary to calculate the
electric or magnetic field at one or more defined points in the geometry. This is especially useful to compare
different geometry setups, or during the design stage when full-scale simulations are not yet feasible. The field
calculation tools are intended to help with these tasks.</p>
<p>Several programs are available for working with electric fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SimpleElectricFieldCalculator</span></code> calculates the electric field and potential at a single point in the global
coordinate system, and prints the results to the terminal.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SimpleElectricFieldCalculatorAlongZAxis</span></code> calculates the electric field and potential at several points spread
along the z-axis, defined by a start and stop position on the z-axis and a distance between points. The results are
printed to the terminal and saved to a output text file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SimpleElectricFieldCalculatorOverXYplane</span></code> calculates the electric field and potential at several points spread
over the xy-plane, defined by a position on the z-axis, a maimum radius, and a distance between points. The results
are printed to the terminal and saved to a output text file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SimpleElectricFieldCalculatorAlongFieldline</span></code> calculates the electric field and potential along a field line,
which is calculated with the help of <em>Kassiopeia</em> using a magnetic trajectory. In principle this can be done through
the <em>Kassiopeia</em> XML interfaces, but this program provides a convenient method for a simple field line calculation.
The results are printed to the terminal and saved to a output text file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SimpleElectricFieldCalculatorFromFile</span></code> takes coordinates from a given input text file and calculates the electric
field and potential at each point. The results are printed to the terminal and saved to a output text file.</p></li>
</ul>
<p>For working with magnetic fields, the same programs are available under the adapted name <code class="docutils literal notranslate"><span class="pre">SimpleMagneticFieldCalculator</span></code>
and so on. In addition, there is:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SimpleMagneticGradientCalculator</span></code> calculates the magnetic field and its gradient at a single point in the global
coordinate system, and prints the results to the terminal.</p></li>
</ul>
<div class="section" id="id2">
<h3><a class="toc-backref" href="#id9">Usage</a><a class="headerlink" href="#id2" title="Permalink to this headline"><span>#</span></a></h3>
<p>All listed programs will show a brief usage summary if called without arguments. For example, the
<code class="docutils literal notranslate"><span class="pre">SimpleElectricFieldCalculatorAlongZaxis</span></code> will show a message:</p>
<div class="highlight- notranslate"><div class="highlight"><pre><span></span>usage: ./SimpleElectricFieldCalculatorAlongZaxis &lt;config_file.xml&gt; &lt;z1&gt; &lt;z2&gt; &lt;dz&gt; &lt;output_file.txt&gt; &lt;electric_field_name1&gt; [&lt;electric_field_name2&gt; &lt;...&gt;]
</pre></div>
</div>
<p>which indicates that at least 6 arguments are required: the name of a configuration file with at least one defined
electric field; the start and stop position and step distance on the z-axis; the name of an output file; and the name
of an electric field. If multiple fields are specified, their contributions will be summed up.</p>
</div>
</div>
<div class="section" id="simulation-tools">
<h2><a class="toc-backref" href="#id10">Simulation tools</a><a class="headerlink" href="#simulation-tools" title="Permalink to this headline"><span>#</span></a></h2>
<p>Finally, some helper tools are provided with <em>Kassiopeia</em> that can be used together with simulations.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ROOTFileMerge</span></code> combines several simulation output files into a single file with all runs/events combined. This is
useful in the case of Monte-Carlo simulations, where <em>Kassiopeia</em> is executed several times with the same or slightly
different settings. Although the individual output files could be analyzed separately, sometimes it is beneficial to
combine all results into a single file that can then be analyzed in a single go. The program simply takes a list
of input files, followed by the name of an output file that will be created.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ParticleGenerator</span></code> provides a quick method to generate particles as specified in a configuration file, without
running a simulations. This is useful for the design of simulations, and to compare and validate the generators used
by the simulations. The program generates an output text file that contains one line for each generated particle,
with information about its position, energy, and so on.</p></li>
</ul>
<p>All listed programs will show a brief usage summary if called without arguments.</p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="output.html" class="btn btn-neutral float-left" title="Understanding Simulation Output" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="visualization.html" class="btn btn-neutral float-right" title="Visualization Techniques" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2022, The Kassiopeia developers..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>