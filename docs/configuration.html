
<!DOCTYPE html>

<html lang="en">
<head>
<meta content="ie=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta charset="utf-8"/>
<title>
      Configuring Your Own Simulation | Kassiopeia 3.7 documentation
    </title>
<link href="_static/pygments.css" rel="stylesheet"/>
<link href="_static/theme.css" rel="stylesheet"/>
<link href="search.html" rel="search" title="Search"/>
<link href="genindex.html" rel="index" title="Index"/>
<link href="kgeobag_basic.html" rel="next" title="Basic Shapes in KGeoBag"/>
<link href="examples.html" rel="prev" title="Examples and Tests"/>
</head><body class="text-gray-900 antialiased min-h-screen md:h-screen flex flex-col">
<a class="block text-xl bg-white px-8 py-4 z-20 absolute top-0 inset-x-0 text-center transform -translate-y-full focus:translate-y-0 focus:outline-none transition-transform duration-75" href="#configuring-your-own-simulation" title="Skip navigation links">Skip to content</a>
<header class="md:sticky top-0 bg-gray-900 shadow-md flex md:flex-row justify-between items-center z-10"><a aria-label="Back to homepage" class="py-4 hover:bg-gray-700 focus:bg-gray-700 tooltipped tooltipped-se" href="index.html">
<img alt="Logo" class="h-8 mx-5" src="_static/KassiopeiaLogo_1_cropped_bb.png"/>
</a><h2 class="text-xl text-gray-100 mx-5 py-4">Kassiopeia 3.7 documentation</h2><form action="search.html" class="hidden md:flex my-auto mx-5 justify-between items-center print:hidden" id="searchbox" method="get">
<input aria-label="Search the docs" class="p-2 flex-1 focus:bg-yellow-100" id="search-input" name="q" placeholder="Search the docs" style="width: 300px;" type="search"/>
<button aria-label="Get search results" class="p-2 text-white bg-gray-700 hover:bg-gray-200 hover:text-pink-500 focus:bg-gray-200 focus:text-pink-500 tooltipped tooltipped-sw">
<svg aria-hidden="true" class="fill-current stroke-current h-6 w-6" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg>
</button>
</form>
</header>
<div class="md:overflow-hidden flex flex-col md:flex-row flex-1"><nav class="h-full fixed md:relative inset-y-0 left-0 z-20 md:z-0 bg-white text-gray-700 border-r overflow-x-hidden pt-16 print:hidden flex flex-col" data-menu="closed" role="navigation" style="width: 270px;">
<div class="nav-toc"><ul class="current">
<li class="toctree-l1"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="introduction.html"> Introduction</a></div><ul>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" href="introduction.html#the-kasper-framework">The Kasper framework</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" href="introduction.html#extending-functionality">Extending Functionality</a></div></li>
</ul>
</li>
<li class="toctree-l1"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="external_documentation.html"> External Documentation, Citation and Contact</a></div><ul>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" href="external_documentation.html#external-references">External references</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" href="external_documentation.html#developer-contact">Developer contact</a></div></li>
</ul>
</li>
<li class="toctree-l1"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="compiling.html"> Getting Started</a></div><ul>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" href="compiling.html#downloading-the-code">Downloading the code</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" href="compiling.html#supported-operating-systems-and-hardware-requirements">Supported operating systems and hardware requirements</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" href="compiling.html#docker-image">Docker image</a></div></li>
<li class="toctree-l2"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="compiling.html#required-software-dependencies">Required software dependencies</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="compiling.html#minimum-requirements">Minimum requirements</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="compiling.html#required-dependencies">Required dependencies</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="compiling.html#optional-dependencies">Optional dependencies</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="compiling.html#external-libraries">External libraries</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="compiling.html#compiling-the-code-using-cmake">Compiling the code using CMake</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="compiling.html#environment-variables">Environment variables</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="compiling.html#directory-structure-and-environmental-variables">Directory structure and environmental variables</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="compiling.html#executing-kassiopeia">Executing Kassiopeia</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="compiling.html#configuring-optional-dependencies">Configuring optional dependencies</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="compiling.html#build-options">Build options</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="compiling.html#kassiopeia-module">Kassiopeia module</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="compiling.html#kemfield-module">KEMField module</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="compiling.html#kgeobag-module">KGeoBag module</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="compiling.html#kommon-module">Kommon module</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="compiling.html#miscellaneous-options">Miscellaneous options</a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="examples.html"> Examples and Tests</a></div><ul>
<li class="toctree-l2"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="examples.html#running-kassiopeia">Running Kassiopeia</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="examples.html#verbosity-levels">Verbosity levels</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="examples.html#output-files">Output files</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="examples.html#example-configurations">Example configurations</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="examples.html#the-dipole-trap-example">The Dipole Trap Example</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="examples.html#the-quadrupole-trap-example">The Quadrupole Trap Example</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="examples.html#the-photomultiplier-tube-example">The Photomultiplier Tube Example</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="examples.html#other-examples">Other Examples</a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current expanded"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="current reference internal" href="#"> Configuring Your Own Simulation</a></div><ul>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" href="#overview-and-units">Overview and Units</a></div></li>
<li class="toctree-l2"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="#xml-parsing-and-features">XML Parsing and Features</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="#variables">Variables</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="#including-external-files">Including external files</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="#print-statements">Print statements</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="#formula-expressions">Formula Expressions</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="#conditional-expressions-and-looping">Conditional Expressions and Looping</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="#comments">Comments</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="#messaging-system">Messaging System</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="#verbosity-levels">Verbosity levels</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="#additional-logging">Additional logging</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="#geometry">Geometry</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="#shapes-and-assemblies">Shapes and assemblies</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="#tagging-system">Tagging system</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="#assembling-elements">Assembling elements</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="#transformations">Transformations</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="#extensions">Extensions</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" href="#kassiopeia">Kassiopeia</a></div></li>
<li class="toctree-l2"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="#fields">Fields</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="#electric">Electric</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="#magnetic">Magnetic</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" href="#generation">Generation</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" href="#termination">Termination</a></div></li>
<li class="toctree-l2"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="#interactions">Interactions</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="#volume-interactions">Volume Interactions</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="#surface-interactions">Surface Interactions</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="#output">Output</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="#writers">Writers</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="#output-description">Output description</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" href="#propagation">Propagation</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" href="#navigation">Navigation</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" href="#navigation-and-commands">Navigation and Commands</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" href="#simulation">Simulation</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" href="#visualization">Visualization</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" href="#common-pitfalls-and-problems">Common Pitfalls and Problems</a></div></li>
</ul>
</li>
<li class="toctree-l1"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="kgeobag_basic.html"> Basic KGeoBag Shapes</a></div><ul>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#basic-elements">Basic elements</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#poly-loop">Poly-loop</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#poly-line">Poly-line</a></div></li>
<li class="toctree-l2"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="kgeobag_basic.html#surfaces">Surfaces</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#flattened-circle-surface">Flattened circle surface</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#flattened-poly-loop-surface">Flattened poly-loop surface</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#rotated-surfaces">Rotated Surfaces</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#rotated-line-segment-surface">Rotated line segment surface</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#rotated-arc-segment-surface">Rotated arc segment surface</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#rotated-circle-surface">Rotated circle surface</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#rotated-poly-loop-surface">Rotated poly loop surface</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#shell-surfaces">Shell Surfaces</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#shell-line-segment-surface">Shell line segment surface</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#shell-arc-segment-surface">Shell arc segment surface</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#shell-poly-line-surface">Shell poly-line surface</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#shell-circle-surface">Shell circle surface</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#shell-poly-loop-surface">Shell poly-loop surface</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="kgeobag_basic.html#extruded-surfaces">Extruded Surfaces</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#extruded-poly-line-surface">Extruded poly-line surface</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#extruded-circle-surface">Extruded circle surface</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#extruded-poly-loop-surface">Extruded poly-loop surface</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="kgeobag_basic.html#special-surfaces">Special Surfaces</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#disk-surface">Disk surface</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#annulus-surface">Annulus surface</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#cylinder-surface">Cylinder surface</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#cone-surface">Cone Surface</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#cut-cone-surface">Cut Cone Surface</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#torus-surface">Torus Surface</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#cut-torus-surface">Cut Torus Surface</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#spaces">Spaces</a></div></li>
<li class="toctree-l2"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="kgeobag_basic.html#extruded-spaces">Extruded Spaces</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#extruded-circle-space">Extruded Circle Space</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#extruded-poly-loop-space">Extruded Poly-Loop Space</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="kgeobag_basic.html#rotated-spaces">Rotated Spaces</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#rotated-line-segment">Rotated Line Segment</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#rotated-arc-segment">Rotated Arc Segment</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#rotated-poly-line-space">Rotated Poly-Line Space</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#rotated-circle-space">Rotated Circle Space</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#rotated-poly-loop-space">Rotated Poly-Loop Space</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="kgeobag_basic.html#special-spaces">Special Spaces</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#cylinder-space">Cylinder Space</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#cone-space">Cone Space</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#cut-cone-space">Cut Cone Space</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#torus-space">Torus Space</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#cylinder-tube-space">Cylinder Tube Space</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#cut-cone-tube-space">Cut Cone Tube Space</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_basic.html#box-space">Box Space</a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="kgeobag_complex.html"> Complex KGeoBag Shapes</a></div><ul>
<li class="toctree-l2"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="kgeobag_complex.html#surfaces">Surfaces</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_complex.html#pump-port">Pump Port</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_complex.html#conic-section-pump-port">Conic section pump port</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_complex.html#beam">Beam</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_complex.html#rod">Rod</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_complex.html#extruded-surfaces-with-holes">Extruded surfaces with holes</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_complex.html#rotated-surface">Rotated surface</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg aria-hidden="true" class="expand" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" href="kgeobag_complex.html#spaces">Spaces</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_complex.html#pump-port-space">Pump Port Space</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_complex.html#conic-section-pump-port-space">Conic Section Pump Port Space</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_complex.html#beam-space">Beam Space</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_complex.html#rod-space">Rod Space</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_complex.html#extruded-space">Extruded Space</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" href="kgeobag_complex.html#rotated-space">Rotated Space</a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><div class="nav-link"><a class="reference internal" href="output.html"> Understanding Simulation Output</a></div></li>
<li class="toctree-l1"><div class="nav-link"><a class="reference internal" href="tools.html"> Additional Simulation Tools</a></div></li>
<li class="toctree-l1"><div class="nav-link"><a class="reference internal" href="visualization.html"> Visualization Techniques</a></div></li>
<li class="toctree-l1"><div class="nav-link"><a class="reference internal" href="license.html"> License</a></div></li>
<li class="toctree-l1"><div class="nav-link"><a class="reference internal" href="authors.html"> Authors</a></div></li>
</ul>
</div>
<button aria-label="Close menu" class="text-4xl text-gray-800 p-4 bottom-0 hover:text-pink-500 md:hidden focus:text-pink-500 self-center" id="closeNavBtn" title="Close menu">
<svg aria-hidden="true" class="fill-current stroke-current h-6 w-6" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="overflow-y-auto md:w-full flex flex-col flex-1" id="main-wrapper">
<main class="px-5 md:ml-fluid flex-1" role="main"><nav aria-label="breadcrumbs" class="mt-16 mb-12 text-sm text-gray-700 leading-tight print:hidden" role="navigation">
<a class="text-blue-700" href="index.html">Kassiopeia 3.7 documentation</a>
<span class="text-gray-700 mr-1"> • </span><span aria-current="page">Configuring Your Own Simulation</span>
</nav>
<section id="configuring-your-own-simulation">
<h1>Configuring Your Own Simulation<a aria-label="Copy link to section: Configuring Your Own Simulation." class="headerlink tooltipped tooltipped-ne" href="#configuring-your-own-simulation" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h1>
<p>This section gives a brief overview of what you need to know to configure your own <em>Kassiopeia</em> simulation.</p>
<section id="overview-and-units">
<h2>Overview and Units<a aria-label="Copy link to section: Overview and Units." class="headerlink tooltipped tooltipped-ne" href="#overview-and-units" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>The configuration of <em>Kassiopeia</em> is done in three main sections, plus an optional fourth. These are the <code class="docutils literal notranslate">&lt;messages&gt;</code>
section which describes global message verbosity, the <code class="docutils literal notranslate">&lt;geometry&gt;</code> section which describes the system geometry and its
extensions, the <code class="docutils literal notranslate">&lt;kemfield&gt;</code> section which defines the electromagnetic field elements, and the <code class="docutils literal notranslate">&lt;kassiopeia&gt;</code>
section which contains the elements needed for the particle tracking simulation. The optional fourth section relates to
the specification of a <a class="reference external" href="http://www.vtk.org/">VTK<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a> or <a class="reference external" href="https://root.cern.ch/">ROOT<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a> window for the visualization of aspects of a completed simulation. A complete
simulation file can thus be broken down into something which looks like the following:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;messages&gt;</span>
    <span class="c">&lt;!-- specification of the messaging configuration here --&gt;</span>
<span class="nt">&lt;/messages&gt;</span>

<span class="nt">&lt;geometry&gt;</span>
    <span class="c">&lt;!-- specification of the geometry and geometry extensions here --&gt;</span>
<span class="nt">&lt;/geometry&gt;</span>

<span class="nt">&lt;kemfield&gt;</span>
    <span class="c">&lt;!-- specification of the field elements and parameters here --&gt;</span>
<span class="nt">&lt;/kemfield&gt;</span>

<span class="nt">&lt;kassiopeia&gt;</span>
    <span class="c">&lt;!-- specification of the simulation elements and parameters here --&gt;</span>
<span class="nt">&lt;/kassiopeia&gt;</span>

<span class="c">&lt;!-- optional VTK window (requires VTK) --&gt;</span>
<span class="nt">&lt;vtk_window&gt;</span>
    <span class="c">&lt;!-- specification of the VTK window display here --&gt;</span>
<span class="nt">&lt;/vtk_window&gt;</span>

<span class="c">&lt;!-- optional ROOT window (requires ROOT) --&gt;</span>
<span class="nt">&lt;root_window&gt;</span>
    <span class="c">&lt;!-- specification of a ROOT display window here</span>
<span class="c">&lt;/root_window&gt;</span>
</code></pre></div>
<p>The XML based interface of <em>Kassiopeia</em> allows for a very flexible way in which to modify and configure particle
tracking simulations. Throughout the geometry, field, and simulation configuration all physical quantities are specified
using <a class="reference external" href="https://scienceworld.wolfram.com/physics/MKS.html">MKS<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a> and their derived units. The exception to this rule is energy, which is specified using electron volts (eV).
It should be noted that XML elements are parsed in order, and elements which are referenced by other elements must be
declared before their first use.</p>
</section>
<section id="xml-parsing-and-features">
<h2>XML Parsing and Features<a aria-label="Copy link to section: XML Parsing and Features." class="headerlink tooltipped tooltipped-ne" href="#xml-parsing-and-features" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>The document language used for describing a Kassiopeia simulation configuration is based on standard <a class="reference external" href="https://www.w3.org/TR/xml11/">XML<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>, but has been
augmented with several additional features to aid in complicated or repetitive tasks. For a full description of this
language and its features, see [1].</p>
<p>The general XML syntax is:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;element</span> <span class="na">atrribute1=</span><span class="s">"value1"</span> <span class="na">atrribute2=</span><span class="s">"value2"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;child_element</span> <span class="na">atrribute=</span><span class="s">"value"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/element&gt;</span>
</code></pre></div>
<p>where <code class="docutils literal notranslate">&lt;element&gt;</code> defines an <cite>element</cite> that corresponds to an object of <em>Kassiopeia</em> or one of the other modules. Each
element can have an unlimited number of <cite>attrbutes</cite>, each with its own <cite>value</cite>. Attributes are passed on to the
corresponding object during initialization. XML allows nesting of elements, and therefore some elements can have child
elements with the same syntax.</p>
<p>All elements must end with a closing statement, like <code class="docutils literal notranslate">&lt;element&gt; ... &lt;/element&gt;</code>. For elements without children, the
syntax can be shortened to the single statement <code class="docutils literal notranslate">&lt;element ... /&gt;</code>.</p>
<section id="variables">
<h3>Variables<a aria-label="Copy link to section: Variables." class="headerlink tooltipped tooltipped-ne" href="#variables" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>A local variable may be defined with a particular value (integer,floating point type, string, etc.) with the following
syntax:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">"my_variable"</span> <span class="na">value=</span><span class="s">"1.3e-5"</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>and may be reference by any other subsequent (using a local variable before it is defined is not allowed) element in the
document through the use of the square brackets <code class="docutils literal notranslate">[...]</code> in the following manner:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;some_element</span> <span class="na">name=</span><span class="s">"my_element"</span> <span class="na">some_property=</span><span class="s">"[my_variable]"</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>Note that all variables are defined as strings, but can be interpreted as other types (such as numbers, lists, etc.)
by during initialization of the element. The details depend on the element’s implementation.</p>
<p>Normal variables are defined only for the scope of the current file. Global variables, on the other hand, persist across
any subsequently included files. These may be specified through:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;global_define</span> <span class="na">name=</span><span class="s">"my_global_variable"</span> <span class="na">value=</span><span class="s">"an_important_value"</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>Both local and global variables my be undefined (removed from the parser’s scope) in the following manner:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;undefine</span> <span class="na">name=</span><span class="s">"my_variable"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;global_undefine</span> <span class="na">name=</span><span class="s">"my_global_variable"</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>It is also possible to reassign a variable (changing their value) with the syntax:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;redefine</span> <span class="na">name=</span><span class="s">"my_variable"</span> <span class="na">value=</span><span class="s">"1.35e-5"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;global_redefine</span> <span class="na">name=</span><span class="s">"my_global_variable"</span> <span class="na">value=</span><span class="s">"another_important_value"</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>Occasionally the user may wish to specify a variable which can be modified from the command line as an argument passed
to <em>Kassiopeia</em>. These variables are called <cite>external variables</cite> and they behave in the same way as global variables,
except that their first definition sets their value and other definitions are ignored. Hence, if an external variable
is defined in multiple included files, only the first occurence matters. If the variable is defined on the command line,
its definition precedes any of the included files.</p>
<p>To define an external variable called <code class="docutils literal notranslate">my_random_seed</code> the syntax is:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;external_define</span> <span class="na">name=</span><span class="s">"my_random_seed"</span> <span class="na">value=</span><span class="s">"123"</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>This particular example is useful for running large batches of similar simulations. For example, to simulate many
independent tracks the user might want to run the same simulation repeatedly, but use a different random seed when
starting the simulation. The value of <code class="docutils literal notranslate">my_random_seed</code> can be changed from its default value of 123 from the command
line call to <em>Kassiopeia</em> in the following manner:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">bash</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>Kassiopeia ./my_simulation.xml -r <span class="nv">my_random_seed</span><span class="o">=</span><span class="m">456</span>
</code></pre></div>
<p>or with the alternate syntax:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">bash</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>Kassiopeia ./my_simulation.xml --my_random_seed<span class="o">=</span><span class="m">456</span>
</code></pre></div>
<p>Note that this applies to other applications that belong to <em>Kassiopeia</em> or the other modules as well.</p>
</section>
<section id="including-external-files">
<h3>Including external files<a aria-label="Copy link to section: Including external files." class="headerlink tooltipped tooltipped-ne" href="#including-external-files" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>Including external XML files is also supported through a relatively simple syntax. This is helpful when a simulation is
too complex to be managed by a single file. A separate XML file can be included using the following:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;include</span> <span class="na">name=</span><span class="s">"/path/to/file/my_file.xml"</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>This include expression may also be configured dynamically through the use of a variable, for example:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;external_define</span> <span class="na">name=</span><span class="s">"my_file_name"</span> <span class="na">value=</span><span class="s">"my_file.xml"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;include</span> <span class="na">name=</span><span class="s">"/path/to/file/[my_file_name]"</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>could be modified to include an entirely different file by passing another file name argument to <em>Kassiopeia</em> using:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>Kassiopeia ./my_simulation.xml -r my_file_name=my_other_file.xml
</code></pre></div>
<p>This feature is particularly useful and enables the user to swap in an entirely different configuration for some portion
of the simulation by passing a single command line variable.</p>
<p>Lastly, it is possible to mark an included file as optional so that no error will be thrown if the files does not exist.
This is sometimes useful when a file with variable definitions should be included before the main configuration. The
syntax in this case is:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;include</span> <span class="na">name=</span><span class="s">"/path/to/file/another_file.xml"</span> <span class="na">optional=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
</code></pre></div>
</section>
<section id="print-statements">
<h3>Print statements<a aria-label="Copy link to section: Print statements." class="headerlink tooltipped tooltipped-ne" href="#print-statements" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>The XML initializer allows to print the current value of a variable, or any sort of text message. The message will be
shown during XML initialization, and it is useful for debugging and checking correct initialization. The syntax is:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">"my_variable"</span> <span class="na">value=</span><span class="s">"42"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;print</span> <span class="na">name=</span><span class="s">"my_variable"</span> <span class="na">value=</span><span class="s">"[my_variable]"</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>where the message content is set to the current value of the variable through the <code class="docutils literal notranslate">[...]</code> syntax.</p>
<p>To show a general informative message without a variable name, use the syntax:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;print</span> <span class="na">value=</span><span class="s">"This is a test message."</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>Both examples together will yield the output:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>[INITIALIZATION NORMAL MESSAGE] value of &lt;my_variable&gt; is &lt;42&gt;
[INITIALIZATION NORMAL MESSAGE] This is a test message.
</code></pre></div>
<p>Instead of showing normal messages, it is also possible to show a warning or an error message. An error message will
terminate the prgogram, so it is most useful in combination with the conditional expressions described below:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;warning</span> <span class="na">value=</span><span class="s">"This is a warning message."</span><span class="nt">/&gt;</span>
<span class="nt">&lt;error</span> <span class="na">value=</span><span class="s">"This is an error message. Goodbye!"</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>Finally, an assertion statement can be used that checks if a condition is true, and shows an error otherwise. See below
for an explanation of conditional expressions. The syntax for the assert statement is:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">"my_variable"</span> <span class="na">value=</span><span class="s">"42"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;assert</span> <span class="na">name=</span><span class="s">"my_variable"</span> <span class="na">condition=</span><span class="s">"{[my_variable] eq 42}"</span><span class="nt">/&gt;</span>
</code></pre></div>
</section>
<section id="formula-expressions">
<h3>Formula Expressions<a aria-label="Copy link to section: Formula Expressions." class="headerlink tooltipped tooltipped-ne" href="#formula-expressions" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>The ability to calculate in-line formulas is another useful feature. The underlying implementation of the formula
processor relies on two external libraries. First, formulas are interpreted with the <a class="reference external" href="https://github.com/codeplea/tinyexpr/">TinyExpr<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a> parser. This is a very
fast implementation that works for most simple expressions. If parsing fails, the formula is interpreted by the ROOT
<a class="reference external" href="http://root.cern.ch/root/htmldoc/TFormula.html">TFormula<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a> class, which is slower but more versatile. To the user, the switching between both parsers is completely
transparent and no extra steps have to be taken.</p>
<p>In order to active the formula mode, the relevant expression must be enclosed in curly braces <code class="docutils literal notranslate">{...}</code>. Variables may
also be used within a formula, and all variable replacements will be done before the formula parsing (meaning that
the current value of the variable will be used in the formula.) An example of the formula syntax is given in the
following variable definition:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">"my_variable"</span> <span class="na">value=</span><span class="s">"4.0"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">"length"</span> <span class="na">value=</span><span class="s">"{2.3 + 2.0/sqrt([my_variable])}"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;print</span> <span class="na">name=</span><span class="s">"length"</span> <span class="na">value=</span><span class="s">"[length]"</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>This example results in the variable <code class="docutils literal notranslate">length</code> taking the value of 3.3.</p>
<p>Note that this example uses a standard function <code class="docutils literal notranslate">sqrt(x)</code> that is supported by <a class="reference external" href="https://github.com/codeplea/tinyexpr/">TinyExpr<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>. In general, any formulas
using advanced <a class="reference external" href="http://root.cern.ch/root/htmldoc/TMath.html">TMath<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a> functions or other complex syntax will use the <a class="reference external" href="http://root.cern.ch/root/htmldoc/TFormula.html">TFormula<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a> parser. Simple <a class="reference external" href="http://root.cern.ch/root/htmldoc/TMath.html">TMath<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a> functions like
<code class="docutils literal notranslate">TMath::Sqrt(x)</code> or <code class="docutils literal notranslate">TMath::Sin(x)</code> are mapped to their equivalent standard function (<code class="docutils literal notranslate">sqrt(x)</code>, <code class="docutils literal notranslate">sin(x)</code>) that is
natively understood by <a class="reference external" href="https://github.com/codeplea/tinyexpr/">TinyExpr<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>. The standard functions (and mathematical constants) are listed in the table below.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%"/>
<col style="width: 15%"/>
<col style="width: 25%"/>
<col style="width: 47%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head" colspan="4"><p>Standard functions and constants</p></th>
</tr>
<tr class="row-even"><th class="head"><p>XML syntax</p></th>
<th class="head"><p>C++ function</p></th>
<th class="head"><p>ROOT equivalent</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">abs(x)</code></p></td>
<td><p><code class="docutils literal notranslate">fabs(x)</code></p></td>
<td><p><code class="docutils literal notranslate">TMath::Abs()</code></p></td>
<td><p>Compute absolute value.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">acos(x)</code></p></td>
<td><p><code class="docutils literal notranslate">acos(x)</code></p></td>
<td><p><code class="docutils literal notranslate">TMath::ACos(x)</code></p></td>
<td><p>Compute arc cosine.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">asin(x)</code></p></td>
<td><p><code class="docutils literal notranslate">asin(x)</code></p></td>
<td><p><code class="docutils literal notranslate">TMath::ASin(x)</code></p></td>
<td><p>Compute arc sine.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">atan(x)</code></p></td>
<td><p><code class="docutils literal notranslate">atan(x)</code></p></td>
<td><p><code class="docutils literal notranslate">TMath::ATan(x)</code></p></td>
<td><p>Compute arc tangent.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">atan2(x)</code></p></td>
<td><p><code class="docutils literal notranslate">atan2(x)</code></p></td>
<td><p><code class="docutils literal notranslate">TMath::ATan2(x)</code></p></td>
<td><p>Compute arc tangent with two parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">ceil(x)</code></p></td>
<td><p><code class="docutils literal notranslate">ceil(x)</code></p></td>
<td><p><code class="docutils literal notranslate">TMath::Ceil(x)</code></p></td>
<td><p>Round up value.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">cos(x)</code></p></td>
<td><p><code class="docutils literal notranslate">cos(x)</code></p></td>
<td><p><code class="docutils literal notranslate">TMath::Cos(x)</code></p></td>
<td><p>Compute cosine.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">cosh(x)</code></p></td>
<td><p><code class="docutils literal notranslate">cosh(x)</code></p></td>
<td><p><code class="docutils literal notranslate">TMath::CosH(x)</code></p></td>
<td><p>Compute hyperbolic cosine.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">exp(x)</code></p></td>
<td><p><code class="docutils literal notranslate">exp(x)</code></p></td>
<td><p><code class="docutils literal notranslate">TMath::Exp(x)</code></p></td>
<td><p>Compute exponential function.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">fac(x)</code></p></td>
<td></td>
<td><p><code class="docutils literal notranslate">TMath::Factorial(x)</code></p></td>
<td><p>Compute factorial.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">floor(x)</code></p></td>
<td><p><code class="docutils literal notranslate">floor(x)</code></p></td>
<td><p><code class="docutils literal notranslate">TMath::Floor(x)</code></p></td>
<td><p>Round down value.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">ln(x)</code></p></td>
<td><p><code class="docutils literal notranslate">log(x)</code></p></td>
<td><p><code class="docutils literal notranslate">TMath::Log(x)</code></p></td>
<td><p>Compute natural logarithm.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">log(x)</code></p></td>
<td><p><code class="docutils literal notranslate">log10(x)</code></p></td>
<td></td>
<td><p>Compute common logarithm.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">log10(x)</code></p></td>
<td><p><code class="docutils literal notranslate">log10(x)</code></p></td>
<td><p><code class="docutils literal notranslate">TMath::Log10(x)</code></p></td>
<td><p>Compute common logarithm.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">ncr(n,r)</code></p></td>
<td></td>
<td><p><code class="docutils literal notranslate">TMath::Binomial(n,r)</code></p></td>
<td><p>Compute combinations of <cite>n</cite> over <cite>r</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">npr(n,r)</code></p></td>
<td></td>
<td></td>
<td><p>Compute permuations of <cite>n</cite> over <cite>r</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">pow(x)</code></p></td>
<td><p><code class="docutils literal notranslate">pow(x)</code></p></td>
<td><p><code class="docutils literal notranslate">TMath::Pow(x)</code></p></td>
<td><p>Raise to power.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">sin(x)</code></p></td>
<td><p><code class="docutils literal notranslate">sin(x)</code></p></td>
<td><p><code class="docutils literal notranslate">TMath::Sin(x)</code></p></td>
<td><p>Compute sine.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">sinh(x)</code></p></td>
<td><p><code class="docutils literal notranslate">sinh(x)</code></p></td>
<td><p><code class="docutils literal notranslate">TMath::SinH(x)</code></p></td>
<td><p>Compute hyperbolic sine.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">sqrt(x)</code></p></td>
<td><p><code class="docutils literal notranslate">sqrt(x)</code></p></td>
<td><p><code class="docutils literal notranslate">TMath::Sqrt(x)</code></p></td>
<td><p>Compute square root.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">tan(x)</code></p></td>
<td><p><code class="docutils literal notranslate">tan(x)</code></p></td>
<td><p><code class="docutils literal notranslate">TMath::Tan(x)</code></p></td>
<td><p>Compute tangent.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">tanh(x)</code></p></td>
<td><p><code class="docutils literal notranslate">tanh(x)</code></p></td>
<td><p><code class="docutils literal notranslate">TMath::TanH(x)</code></p></td>
<td><p>Compute hyperbolic tangent.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">e</code></p></td>
<td></td>
<td><p><code class="docutils literal notranslate">TMath::Pi()</code></p></td>
<td><p>Fundamental constant.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">pi</code></p></td>
<td><p><code class="docutils literal notranslate">M_PI</code></p></td>
<td><p><code class="docutils literal notranslate">TMath::E()</code></p></td>
<td><p>Fundamental constant.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="conditional-expressions-and-looping">
<h3>Conditional Expressions and Looping<a aria-label="Copy link to section: Conditional Expressions and Looping." class="headerlink tooltipped tooltipped-ne" href="#conditional-expressions-and-looping" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>In addition to mathematical expressions, simple boolean conditions can be specified. These are often helpful for
swapping or toggling on/off different features, but also for setting several variables depending on the value of a “meta
variable”. An example showing the inclusion/exclusion of a brief section of XML is shown below:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">"var1"</span> <span class="na">value=</span><span class="s">"1"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">"var2"</span> <span class="na">value=</span><span class="s">"0"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;if</span> <span class="na">condition=</span><span class="s">"{[var1] eq [var2]}"</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- intervening section of xml to be included/excluded --&gt;</span>
<span class="nt">&lt;/if&gt;</span>
</code></pre></div>
<p>Note that this uses the formula syntax <code class="docutils literal notranslate">{...}</code> in the condition. The operator <code class="docutils literal notranslate">eq</code> checks for equality between the
two variables. Other allowed operators are listed in the table below. To combine multiple conditions into one
expression, use brackets like <code class="docutils literal notranslate">([var1] eq [var2]) &amp;&amp; ([var3] eq [var4])</code>.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%"/>
<col style="width: 14%"/>
<col style="width: 20%"/>
<col style="width: 52%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head" colspan="4"><p>Conditional operators</p></th>
</tr>
<tr class="row-even"><th class="head"><p>XML syntax</p></th>
<th class="head"><p>C++ operator</p></th>
<th class="head"><p>Operator</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">! A</code></p></td>
<td><p><code class="docutils literal notranslate">!</code></p></td>
<td><p>Logical “not”</p></td>
<td><p>False if statement A is true.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">A &amp;&amp; B</code></p></td>
<td><p><code class="docutils literal notranslate">&amp;&amp;</code></p></td>
<td><p>Logical “and”</p></td>
<td><p>True if both statements A and B are true.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">A || B</code></p></td>
<td><p><code class="docutils literal notranslate">||</code></p></td>
<td><p>Logical “or”</p></td>
<td><p>True if one of the statements A and B is true.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">A eq B</code></p></td>
<td><p><code class="docutils literal notranslate">==</code></p></td>
<td><p>Equal-to</p></td>
<td><p>True if both values A and B are equal.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">A ne B</code></p></td>
<td><p><code class="docutils literal notranslate">!=</code></p></td>
<td><p>Not-equal</p></td>
<td><p>True if both values A and B are not equal.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">A gt B</code></p></td>
<td><p><code class="docutils literal notranslate">&lt;</code></p></td>
<td><p>Greater-than</p></td>
<td><p>True if value A is greater than value B.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">A lt B</code></p></td>
<td><p><code class="docutils literal notranslate">&gt;</code></p></td>
<td><p>Less-than</p></td>
<td><p>True if value A is less than value B.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">A ge B</code></p></td>
<td><p><code class="docutils literal notranslate">&gt;=</code></p></td>
<td><p>Greater-or-equal</p></td>
<td><p>True if value A is greater or equal to value B.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">A le B</code></p></td>
<td><p><code class="docutils literal notranslate">&lt;=</code></p></td>
<td><p>Less-or-equal</p></td>
<td><p>True if value A is less or equal to value B.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">A mod B</code></p></td>
<td><p><code class="docutils literal notranslate">%</code></p></td>
<td><p>Modulo</p></td>
<td><p>Return remainder of value A divided by value B.</p></td>
</tr>
</tbody>
</table>
<p>It is also possible to check directly if a variable has been set to a “true” value (i.e. not 0, false, or an empty
string.) The syntax in this case is:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;external_define</span> <span class="na">name=</span><span class="s">"var1"</span> <span class="na">value=</span><span class="s">""</span><span class="nt">/&gt;</span>
<span class="nt">&lt;if</span> <span class="na">condition=</span><span class="s">"[var1]"</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- intervening section of xml to be included/excluded --&gt;</span>
<span class="nt">&lt;/if&gt;</span>
</code></pre></div>
<p>The conditional expression does not support if-else blocks, so in order to define an alternate conditional branch one
has to add another if-statement in the XML file.</p>
<p>Another feature which is indispensable when assembling complicated or repetitive geometries is the the ability to insert
multiple copies of an XML fragment with slight modifications. This is called looping and is somewhat similar to the way
a for-loop works in C++ or Python. However, it is a purely static construct intended that is only evaluated during XML
initialization to reduce the amount of code needed to describe a geometry (or other XML feature.)</p>
<p>An example of its use can be found in the <code class="docutils literal notranslate">DipoleTrapMeshedSpaceSimulation.xml</code> example. The example of the loop
syntax for the placement of several copies of a surface with the name <code class="docutils literal notranslate">intermediate_z_surface</code> is given below:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;loop</span> <span class="na">variable=</span><span class="s">"i"</span> <span class="na">start=</span><span class="s">"0"</span> <span class="na">end=</span><span class="s">"10"</span> <span class="na">step=</span><span class="s">"1"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;surface</span> <span class="na">name=</span><span class="s">"intermediate_z[i]"</span> <span class="na">node=</span><span class="s">"intermediate_z_surface"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;transformation</span> <span class="na">displacement=</span><span class="s">"0. 0. {-0.5 + [i]*(0.4/10.)}"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/surface&gt;</span>
<span class="nt">&lt;/loop&gt;</span>
</code></pre></div>
<p>In this case, the loop variable <code class="docutils literal notranslate">[i]</code> is used to define the name of the copy and its displacement.</p>
<p>Loops and conditional expressions may also be nested when needed.</p>
</section>
<section id="comments">
<h3>Comments<a aria-label="Copy link to section: Comments." class="headerlink tooltipped tooltipped-ne" href="#comments" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>It is wise to include comments in the XML files to explain certain structures or their behavior. Comment blocks are
included by the syntax:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="c">&lt;!-- This is a multi-line comment</span>
<span class="c">     that provides useful information. --&gt;</span>
</code></pre></div>
<p>As shown above, a comment can span multiple lines. Any text between <code class="docutils literal notranslate">&lt;!-- ... --&gt;</code> is ignored by the XML initializer,
including any XML elements. This makes it possible to quickly comment out parts of the file, e.g. for debugging.</p>
</section>
</section>
<section id="messaging-system">
<h2>Messaging System<a aria-label="Copy link to section: Messaging System." class="headerlink tooltipped tooltipped-ne" href="#messaging-system" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p><em>Kassiopeia</em> provides a very granular means of reporting and logging simulation details of interest. This feature is
particularly useful when modifying the code and debugging specific features. For example, at the top of the file
<code class="docutils literal notranslate">QuadrupoleTrapSimulation.xml</code> you can find section describing the verbosity of each simulation element and the
location of the logging file (as defined by the variable <code class="docutils literal notranslate">log_path</code> and the <code class="docutils literal notranslate">&lt;file&gt;</code> element):</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;define</span> <span class="na">name=</span><span class="s">"log_path"</span> <span class="na">value=</span><span class="s">"[KASPERSYS]/log/Kassiopeia"</span><span class="nt">/&gt;</span>

<span class="nt">&lt;messages&gt;</span>

    <span class="nt">&lt;file</span> <span class="na">path=</span><span class="s">"[log_path]"</span> <span class="na">base=</span><span class="s">"QuadrupoleTrapLog.txt"</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;message</span> <span class="na">key=</span><span class="s">"k_file"</span> <span class="na">terminal=</span><span class="s">"normal"</span> <span class="na">log=</span><span class="s">"warning"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;message</span> <span class="na">key=</span><span class="s">"k_initialization"</span> <span class="na">terminal=</span><span class="s">"normal"</span> <span class="na">log=</span><span class="s">"warning"</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;message</span> <span class="na">key=</span><span class="s">"kg_core"</span> <span class="na">terminal=</span><span class="s">"normal"</span> <span class="na">log=</span><span class="s">"warning"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;message</span> <span class="na">key=</span><span class="s">"kg_shape"</span> <span class="na">terminal=</span><span class="s">"normal"</span> <span class="na">log=</span><span class="s">"warning"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;message</span> <span class="na">key=</span><span class="s">"kg_mesh"</span> <span class="na">terminal=</span><span class="s">"normal"</span> <span class="na">log=</span><span class="s">"warning"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;message</span> <span class="na">key=</span><span class="s">"kg_axial_mesh"</span> <span class="na">terminal=</span><span class="s">"normal"</span> <span class="na">log=</span><span class="s">"warning"</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;message</span> <span class="na">key=</span><span class="s">"ks_object"</span> <span class="na">terminal=</span><span class="s">"debug"</span> <span class="na">log=</span><span class="s">"normal"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;message</span> <span class="na">key=</span><span class="s">"ks_operator"</span> <span class="na">terminal=</span><span class="s">"debug"</span> <span class="na">log=</span><span class="s">"normal"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;message</span> <span class="na">key=</span><span class="s">"ks_field"</span> <span class="na">terminal=</span><span class="s">"debug"</span> <span class="na">log=</span><span class="s">"normal"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;message</span> <span class="na">key=</span><span class="s">"ks_geometry"</span> <span class="na">terminal=</span><span class="s">"debug"</span> <span class="na">log=</span><span class="s">"normal"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;message</span> <span class="na">key=</span><span class="s">"ks_generator"</span> <span class="na">terminal=</span><span class="s">"debug"</span> <span class="na">log=</span><span class="s">"normal"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;message</span> <span class="na">key=</span><span class="s">"ks_trajectory"</span> <span class="na">terminal=</span><span class="s">"debug"</span> <span class="na">log=</span><span class="s">"normal"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;message</span> <span class="na">key=</span><span class="s">"ks_interaction"</span> <span class="na">terminal=</span><span class="s">"debug"</span> <span class="na">log=</span><span class="s">"normal"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;message</span> <span class="na">key=</span><span class="s">"ks_navigator"</span> <span class="na">terminal=</span><span class="s">"debug"</span> <span class="na">log=</span><span class="s">"normal"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;message</span> <span class="na">key=</span><span class="s">"ks_terminator"</span> <span class="na">terminal=</span><span class="s">"debug"</span> <span class="na">log=</span><span class="s">"normal"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;message</span> <span class="na">key=</span><span class="s">"ks_writer"</span> <span class="na">terminal=</span><span class="s">"debug"</span> <span class="na">log=</span><span class="s">"normal"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;message</span> <span class="na">key=</span><span class="s">"ks_main"</span> <span class="na">terminal=</span><span class="s">"debug"</span> <span class="na">log=</span><span class="s">"normal"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;message</span> <span class="na">key=</span><span class="s">"ks_run"</span> <span class="na">terminal=</span><span class="s">"debug"</span> <span class="na">log=</span><span class="s">"normal"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;message</span> <span class="na">key=</span><span class="s">"ks_event"</span> <span class="na">terminal=</span><span class="s">"debug"</span> <span class="na">log=</span><span class="s">"normal"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;message</span> <span class="na">key=</span><span class="s">"ks_track"</span> <span class="na">terminal=</span><span class="s">"debug"</span> <span class="na">log=</span><span class="s">"normal"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;message</span> <span class="na">key=</span><span class="s">"ks_step"</span> <span class="na">terminal=</span><span class="s">"debug"</span> <span class="na">log=</span><span class="s">"normal"</span><span class="nt">/&gt;</span>

<span class="nt">&lt;/messages&gt;</span>
</code></pre></div>
<p>For the verbosity settings, you can independently set the verbosity that you see in the terminal and the verbosity that
is put into log files. Furthermore, you can do that for each different part of <em>Kassiopeia</em> and the other modules. For
example, if you want a lot of detail on what’s happening in the navigation routines, you can increase the verbosity for
only that part of <em>Kassiopeia</em>, without being flooded with messages from everything else. The different sources are
define by the <code class="docutils literal notranslate">key</code> attribute of the <code class="docutils literal notranslate">&lt;message&gt;</code> element, and explained in the table below.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%"/>
<col style="width: 11%"/>
<col style="width: 29%"/>
<col style="width: 40%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head" colspan="4"><p>Message sources</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Key</p></th>
<th class="head"><p>Module</p></th>
<th class="head"><p>Location</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">k_file</code></p></td>
<td><p>Kommon</p></td>
<td><p>File</p></td>
<td><p>File handling</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">k_initialization</code></p></td>
<td><p>Kommon</p></td>
<td><p>Initialization</p></td>
<td><p>XML initialization and processing</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">k_utility</code></p></td>
<td><p>Kommon</p></td>
<td><p>Utility</p></td>
<td><p>Utility functions</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">kem_bindings</code></p></td>
<td><p>KEMField</p></td>
<td><p>Bindings</p></td>
<td><p>XML bindings</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">kem_core</code></p></td>
<td><p>KEMField</p></td>
<td><p>Core</p></td>
<td><p>Core functionality</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">kg_bindings</code></p></td>
<td><p>KGeoBag</p></td>
<td><p>Bindings</p></td>
<td><p>XML bindings</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">kg_core</code></p></td>
<td><p>KGeoBag</p></td>
<td><p>Core</p></td>
<td><p>Core functionality</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">kg_axial_mesh</code></p></td>
<td><p>KGeoBag</p></td>
<td><p>Extensions/AxialMesh</p></td>
<td><p>Axially symmetric meshing</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">kg_drmesh</code></p></td>
<td><p>KGeoBag</p></td>
<td><p>Extensions/DiscreteRotationalMesh</p></td>
<td><p>Rotationally discrete meshing</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">kg_mesh</code></p></td>
<td><p>KGeoBag</p></td>
<td><p>Extensions/Mesh</p></td>
<td><p>Asymmetric meshing</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">kg_metrics</code></p></td>
<td><p>KGeoBag</p></td>
<td><p>Extensions/Metrics</p></td>
<td><p>Metrics calculation (volumes &amp; areas)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">kg_random</code></p></td>
<td><p>KGeoBag</p></td>
<td><p>Extensions/Random</p></td>
<td><p>Random generator functions</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">kg_math</code></p></td>
<td><p>KGeoBag</p></td>
<td><p>Math</p></td>
<td><p>Mathematical functions</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">kg_shape</code></p></td>
<td><p>KGeoBag</p></td>
<td><p>Shapes</p></td>
<td><p>Geometric shapes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">kg_vis</code></p></td>
<td><p>KGeoBag</p></td>
<td><p>Visualization</p></td>
<td><p>Visualization (<a class="reference external" href="http://www.vtk.org/">VTK<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>, <a class="reference external" href="https://root.cern.ch/">ROOT<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">ks_bindings</code></p></td>
<td><p>Kassiopeia</p></td>
<td><p>Bindings</p></td>
<td><p>XML bindings</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">ks_field</code></p></td>
<td><p>Kassiopeia</p></td>
<td><p>Fields</p></td>
<td><p>Field calculation</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">ks_generator</code></p></td>
<td><p>Kassiopeia</p></td>
<td><p>Generators</p></td>
<td><p>Particle generation</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">ks_geometry</code></p></td>
<td><p>Kassiopeia</p></td>
<td><p>Geometry</p></td>
<td><p>Geometry handling</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">ks_interaction</code></p></td>
<td><p>Kassiopeia</p></td>
<td><p>Interactions</p></td>
<td><p>Particle interactions</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">ks_math</code></p></td>
<td><p>Kassiopeia</p></td>
<td><p>Math</p></td>
<td><p>Mathematical functions</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">ks_modifier</code></p></td>
<td><p>Kassiopeia</p></td>
<td><p>Modifiers</p></td>
<td><p>Trajectory modifiers</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">ks_navigator</code></p></td>
<td><p>Kassiopeia</p></td>
<td><p>Navigators</p></td>
<td><p>Particle navigation</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">ks_object</code></p></td>
<td><p>Kassiopeia</p></td>
<td><p>Objects</p></td>
<td><p>Dynamic command interface</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">ks_operator</code></p></td>
<td><p>Kassiopeia</p></td>
<td><p>Operators</p></td>
<td><p>Core functionality, particle state</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">ks_reader</code></p></td>
<td><p>Kassiopeia</p></td>
<td><p>Readers</p></td>
<td><p>File reading</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">ks_main</code></p></td>
<td><p>Kassiopeia</p></td>
<td><p>Simulation</p></td>
<td><p>Simulation execution</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">ks_run</code></p></td>
<td><p>Kassiopeia</p></td>
<td><p>Simulation</p></td>
<td><p>Simulation progress, “run” level</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">ks_event</code></p></td>
<td><p>Kassiopeia</p></td>
<td><p>Simulation</p></td>
<td><p>Simulation progress, “event” level</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">ks_track</code></p></td>
<td><p>Kassiopeia</p></td>
<td><p>Simulation</p></td>
<td><p>Simulation progress, “track” level</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">ks_step</code></p></td>
<td><p>Kassiopeia</p></td>
<td><p>Simulation</p></td>
<td><p>Simulation progress, “step” level</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">ks_terminator</code></p></td>
<td><p>Kassiopeia</p></td>
<td><p>Terminators</p></td>
<td><p>Particle termination</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">ks_trajectory</code></p></td>
<td><p>Kassiopeia</p></td>
<td><p>Trajectories</p></td>
<td><p>Trajectory calculation</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">ks_utility</code></p></td>
<td><p>Kassiopeia</p></td>
<td><p>Utility</p></td>
<td><p>Utility functions</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate">ks_vis</code></p></td>
<td><p>Kassiopeia</p></td>
<td><p>Visualization</p></td>
<td><p>Visualization (<a class="reference external" href="http://www.vtk.org/">VTK<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>, <a class="reference external" href="https://root.cern.ch/">ROOT<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate">ks_writer</code></p></td>
<td><p>Kassiopeia</p></td>
<td><p>Writers</p></td>
<td><p>File writing</p></td>
</tr>
</tbody>
</table>
<p>The different parts of the code are explained further below, along with XML configuration examples.</p>
<section id="verbosity-levels">
<h3>Verbosity levels<a aria-label="Copy link to section: Verbosity levels." class="headerlink tooltipped tooltipped-ne" href="#verbosity-levels" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>There are five possible verbosity levels, they are <code class="docutils literal notranslate">debug</code>, <code class="docutils literal notranslate">info</code>, <code class="docutils literal notranslate">normal</code>, <code class="docutils literal notranslate">warning</code> and <code class="docutils literal notranslate">error</code>. Of these,
<code class="docutils literal notranslate">error</code> is the least verbose, only reporting on fatal errors that terminate the simulation. The <code class="docutils literal notranslate">normal</code> mode will
include a relatively small set of details in addition to any warnings (this is the default), while <code class="docutils literal notranslate">debug</code> will
provide an extremely extensive description of the state of the simulation as it progresses.</p>
<p>Note that the <code class="docutils literal notranslate">debug</code> setting is a special case: Since there is so much additional information provided by this
setting, it substantially slows down the speed of the simulation even when the messages are not printed or saved to the
log file. In order to avoid unnecessarily slowing down <em>Kassiopeia</em>, the debug output is completely disabled unless it
is explicitly enabled in the build by enabling the CMake option <code class="docutils literal notranslate">Kassiopeia_ENABLE_DEBUG</code> during configuration (and
the corresponding options for other modules.)</p>
<p>As mentioned earlier, the verbosity level can also be changed by the command line arguments <code class="docutils literal notranslate">-v</code> and <code class="docutils literal notranslate">-q</code>, which
raise or lower the verbosity level. However, this only works for sources that have not been configured explicitely
in the <code class="docutils literal notranslate">&lt;messages&gt;</code> section.</p>
</section>
<section id="additional-logging">
<h3>Additional logging<a aria-label="Copy link to section: Additional logging." class="headerlink tooltipped tooltipped-ne" href="#additional-logging" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>The description above applies to the <em>KMessage</em> interface, which is configured through XML files. In addition, some code
uses the independent <em>KLogger</em> interface. If <em>Kassiopeia</em> was compiled with <a class="reference external" href="https://logging.apache.org/log4cxx/">Log4CXX<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a> enabled at build time, the KLogger
interface can be configured through its own configuration file, which is located at:</p>
<blockquote>
<div><p><code class="docutils literal notranslate">$KASPERSYS/config/Kommon/log4cxx.properties</code></p>
</div></blockquote>
<p>It allows flexible logging configuration of different parts of the code, including changing the verbosity level,
redirecting output to a log file, or customizing the message format.</p>
<p>In <em>Kassiopeia</em>, <em>KEMField</em> and <em>KGeoBag</em>, most messages use the <em>KMessage</em> interface.</p>
</section>
</section>
<section id="geometry">
<h2>Geometry<a aria-label="Copy link to section: Geometry." class="headerlink tooltipped tooltipped-ne" href="#geometry" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>The geometry section of the configuration file is the first piece needed in order to assemble a simulation. At its first
and most basic level it is responsible for defining all the different shapes that will be used, and placing them with
respect to one another in order to construct the arrangement (often called <cite>assembly</cite>) that is needed.</p>
<p>For a full a description of all of the shape objects (surfaces and spaces) which maybe constructed in <em>KGeoBag</em> see
<a class="reference internal" href="kgeobag_basic.html#basic-kgeobag-label"><span class="std std-ref">Basic Shapes in KGeoBag</span></a> and <a class="reference internal" href="kgeobag_complex.html#complex-kgeobag-label"><span class="std std-ref">Complex Shapes in KGeoBag</span></a>. The abstract base classes which serve as the interface
between <em>KGeoBag</em> and <em>Kassiopeia</em> are <code class="docutils literal notranslate">KSSpace</code>, <code class="docutils literal notranslate">KSSurface</code>, and <code class="docutils literal notranslate">KSSide</code> (see <a class="reference external" href="https://github.com/KATRIN-Experiment/Kassiopeia/blob/master/Kassiopeia/Operators">GitHub: Kassiopeia/Operators<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>).</p>
<p>The geometry section is also responsible for adding “extended” information to the defined geometry elements. These
extensions can be properties such as colors for visualization, or boundary conditions and meshing details for the
electromagnetic simulations.</p>
<p>Every relevant to the geometry description is processed by <em>KGeoBag</em> and must appear between the start and end brackets:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;geometry&gt;</span>
    <span class="c">&lt;!-- fill in geometry description here --&gt;</span>
<span class="nt">&lt;/geometry&gt;</span>
</code></pre></div>
<p>It should be noted, that the full description of the geometry need not lie within the same pair of <code class="docutils literal notranslate">&lt;geometry&gt;</code> and
<code class="docutils literal notranslate">&lt;/geometry&gt;</code> brackets. This facilitates the description of separate geometry pieces in different files, which may
then be included and used in the final assembly.</p>
<section id="shapes-and-assemblies">
<h3>Shapes and assemblies<a aria-label="Copy link to section: Shapes and assemblies." class="headerlink tooltipped tooltipped-ne" href="#shapes-and-assemblies" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>Of the example files provided, the <code class="docutils literal notranslate">DipoleTrapSimulation.xml</code> has the simplest geometry. It will be explained in
detail below, in order to walk you through a typical geometry configuration.</p>
<p>The geometry section starts off with a description of each shapes involved:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="c">&lt;!-- world --&gt;</span>

<span class="nt">&lt;cylinder_space</span> <span class="na">name=</span><span class="s">"world_space"</span> <span class="na">z1=</span><span class="s">"-2."</span> <span class="na">z2=</span><span class="s">"2."</span> <span class="na">r=</span><span class="s">"2."</span><span class="nt">/&gt;</span>

<span class="c">&lt;!-- solenoid --&gt;</span>

<span class="nt">&lt;tag</span> <span class="na">name=</span><span class="s">"magnet_tag"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;cylinder_tube_space</span>
        <span class="na">name=</span><span class="s">"solenoid_space"</span>
        <span class="na">z1=</span><span class="s">"-1.e-2"</span>
        <span class="na">z2=</span><span class="s">"1.e-2"</span>
        <span class="na">r1=</span><span class="s">"0.5e-2"</span>
        <span class="na">r2=</span><span class="s">"1.5e-2"</span>
        <span class="na">radial_mesh_count=</span><span class="s">"30"</span>
    <span class="nt">/&gt;</span>
<span class="nt">&lt;/tag&gt;</span>

<span class="c">&lt;!-- ring --&gt;</span>

<span class="nt">&lt;tag</span> <span class="na">name=</span><span class="s">"electrode_tag"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;cylinder_surface</span>
        <span class="na">name=</span><span class="s">"ring_surface"</span>
        <span class="na">z1=</span><span class="s">"-2.0e-2"</span>
        <span class="na">z2=</span><span class="s">"2.0e-2"</span>
        <span class="na">r=</span><span class="s">"2.5e-1"</span>
        <span class="na">longitudinal_mesh_count=</span><span class="s">"200"</span>
        <span class="na">longitudinal_mesh_power=</span><span class="s">"3."</span>
        <span class="na">axial_mesh_count=</span><span class="s">"128"</span>
    <span class="nt">/&gt;</span>
<span class="nt">&lt;/tag&gt;</span>

<span class="c">&lt;!-- tube --&gt;</span>

<span class="nt">&lt;tag</span> <span class="na">name=</span><span class="s">"electrode_tag"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;cylinder_surface</span>
        <span class="na">name=</span><span class="s">"tube_surface"</span>
        <span class="na">z1=</span><span class="s">"-1.e-2"</span>
        <span class="na">z2=</span><span class="s">"1.e-2"</span>
        <span class="na">r=</span><span class="s">"0.5e-2"</span>
        <span class="na">longitudinal_mesh_count=</span><span class="s">"200"</span>
        <span class="na">longitudinal_mesh_power=</span><span class="s">"3."</span>
        <span class="na">axial_mesh_count=</span><span class="s">"128"</span>
    <span class="nt">/&gt;</span>
<span class="nt">&lt;/tag&gt;</span>

<span class="c">&lt;!-- target --&gt;</span>

<span class="nt">&lt;tag</span> <span class="na">name=</span><span class="s">"target_tag"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;disk_surface</span> <span class="na">name=</span><span class="s">"target_surface"</span> <span class="na">r=</span><span class="s">"1.0e-2"</span> <span class="na">z=</span><span class="s">"0."</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/tag&gt;</span>

<span class="c">&lt;!-- center --&gt;</span>

<span class="nt">&lt;tag</span> <span class="na">name=</span><span class="s">"center_tag"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;disk_surface</span> <span class="na">name=</span><span class="s">"center_surface"</span> <span class="na">r=</span><span class="s">"2.5e-1"</span> <span class="na">z=</span><span class="s">"0."</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/tag&gt;</span>
</code></pre></div>
<p>The individual shapes are defined by elements of the common structure:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;some_space</span> <span class="na">name=</span><span class="s">"my_space"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;some_surface</span> <span class="na">name=</span><span class="s">"my_surface"</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>where each element is given a name, which it can be referenced with, and additional parameters dependeing on the shape.
For example, the disk surface is defined by only two parameters <cite>r</cite> and <cite>z</cite>, while other shapes differ.</p>
</section>
<section id="tagging-system">
<h3>Tagging system<a aria-label="Copy link to section: Tagging system." class="headerlink tooltipped tooltipped-ne" href="#tagging-system" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>The tagging system is used to group different elements together, for example by distinguishng between magnet and
electrode shapes. These tags will be used later to retrieve elements and pass them to the <em>KEMField</em> module. The
general syntax is:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;tag</span> <span class="na">name=</span><span class="s">"my_tag"</span> <span class="na">name=</span><span class="s">"another_tag"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shape</span> <span class="na">name=</span><span class="s">"my_shape"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/tag&gt;</span>
</code></pre></div>
<p>and tags can be freely combined or re-used.</p>
</section>
<section id="assembling-elements">
<h3>Assembling elements<a aria-label="Copy link to section: Assembling elements." class="headerlink tooltipped tooltipped-ne" href="#assembling-elements" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>The defined shapes are then placed into an assembly of the experiment geometry. Geometric objects are placed by
referencing each shape by its given (and <em>unique</em>) name and placing it inside a space. This can be combined with
specifying a transformation (relative to the assembly origin) defining the location and orientation of each object. The
available transformation types are displacements (defined by a 3-vector), and rotations (defined by an axis-angle
pair, or a series of Euler angles using the <em>Z-Y’-Z’’</em> convention):</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;space</span> <span class="na">name=</span><span class="s">"dipole_trap_assembly"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;surface</span> <span class="na">name=</span><span class="s">"ring"</span> <span class="na">node=</span><span class="s">"ring_surface"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;surface</span> <span class="na">name=</span><span class="s">"center"</span> <span class="na">node=</span><span class="s">"center_surface"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;space</span> <span class="na">name=</span><span class="s">"downstream_solenoid"</span> <span class="na">node=</span><span class="s">"solenoid_space"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;transformation</span> <span class="na">displacement=</span><span class="s">"0. 0. -0.5"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/space&gt;</span>
    <span class="nt">&lt;surface</span> <span class="na">name=</span><span class="s">"downstream_tube"</span> <span class="na">node=</span><span class="s">"tube_surface"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;transformation</span> <span class="na">displacement=</span><span class="s">"0. 0. -0.5"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/surface&gt;</span>
    <span class="nt">&lt;surface</span> <span class="na">name=</span><span class="s">"upstream_target"</span> <span class="na">node=</span><span class="s">"target_surface"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;transformation</span> <span class="na">displacement=</span><span class="s">"0. 0. -0.48"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/surface&gt;</span>
    <span class="nt">&lt;space</span> <span class="na">name=</span><span class="s">"upstream_solenoid"</span> <span class="na">node=</span><span class="s">"solenoid_space"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;transformation</span> <span class="na">displacement=</span><span class="s">"0. 0. 0.5"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/space&gt;</span>
    <span class="nt">&lt;surface</span> <span class="na">name=</span><span class="s">"upstream_tube"</span> <span class="na">node=</span><span class="s">"tube_surface"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;transformation</span> <span class="na">displacement=</span><span class="s">"0. 0. 0.5"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/surface&gt;</span>
    <span class="nt">&lt;surface</span> <span class="na">name=</span><span class="s">"downstream_target"</span> <span class="na">node=</span><span class="s">"target_surface"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;transformation</span> <span class="na">displacement=</span><span class="s">"0. 0. 0.48"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/surface&gt;</span>
<span class="nt">&lt;/space&gt;</span>
</code></pre></div>
<p>Here the individual named shapes that were defined earlier are referenced, using the general syntax:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;space</span> <span class="na">name=</span><span class="s">"my_assembly"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;space</span> <span class="na">name=</span><span class="s">"my_placed_space"</span> <span class="na">node=</span><span class="s">"my_space"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/space&gt;</span>
</code></pre></div>
<p>and spaces can be freely nested, which is one of the key features of <em>KGeoBag</em>. Note the difference between the first
space, which does not refer to any shape and just holds the child elements, and the second space which refers to the
shape named <code class="docutils literal notranslate">my_space</code> through the <cite>node</cite> attribute. The <code class="docutils literal notranslate">my_assembly</code> space can be though of as a “virtual space”,
without any reference to a real geometric object.</p>
<p>Finally in the <code class="docutils literal notranslate">DipoleTrapSimulation.xml</code> file, the full assembly is placed within the world volume:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;space</span> <span class="na">name=</span><span class="s">"world"</span> <span class="na">node=</span><span class="s">"world_space"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;space</span> <span class="na">name=</span><span class="s">"dipole_trap"</span> <span class="na">tree=</span><span class="s">"dipole_trap_assembly"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/space&gt;</span>
</code></pre></div>
<p>The world volume is a crucial part of any geometry, since it defines the outermost “root” space in which all other
elements must be placed. Note that in this case, the space named <code class="docutils literal notranslate">dipole_trap_assembly</code> is referenced through the
<cite>tree</cite> attribute (and not <cite>node</cite>, as you might expect.) This is due to the fact that the assembly is a “virtual” space
that just holds its child elements, but does not refer to an actual object. Make sure to keep this in mind for your
own geometry configurations!</p>
</section>
<section id="transformations">
<h3>Transformations<a aria-label="Copy link to section: Transformations." class="headerlink tooltipped tooltipped-ne" href="#transformations" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>It should be noted that transformations applied to an assembly are collectively applied to all of the geometric elements
within the assembly. For example, placing the dipole trap assembly within the world volume as:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;space</span> <span class="na">name=</span><span class="s">"world"</span> <span class="na">node=</span><span class="s">"world_space"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;space</span> <span class="na">name=</span><span class="s">"dipole_trap"</span> <span class="na">tree=</span><span class="s">"dipole_trap_assembly"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;transformation</span> <span class="na">rotation_euler=</span><span class="s">"90. 0. 0."</span> <span class="na">displacement=</span><span class="s">"0 0 1.0"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/space&gt;</span>
<span class="nt">&lt;/space&gt;</span>
</code></pre></div>
<p>would rotate the whole assembly by 90 degrees about the z-axis, and then displace it by 1 meter along the z-axis.</p>
<p>Assemblies may be nested within each other, and the coordinate transformations which are associated with the placement
of each assembly will be appropriately applied to all of the elements they contain. This makes it very intuitive to
create complex geometries with multiple displacements and rotations, because it resembles the behavior of real-world
objects (i.e. turning an assemble object by some amount will also turn all parts inside by the same amount, relative
to the outside coordinate system.)</p>
<p>Especially for rotations, it should be noted that it makes a difference if they are applied in the assembly before or
after placing child elements. Consider the following example:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;disk_surface</span> <span class="na">name=</span><span class="s">"disk_surface"</span> <span class="na">r=</span><span class="s">"1.0"</span> <span class="na">z=</span><span class="s">"0."</span><span class="nt">/&gt;</span>

<span class="nt">&lt;space</span> <span class="na">name=</span><span class="s">"world"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;space</span> <span class="na">name=</span><span class="s">"assembly_1"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;surface</span> <span class="na">name=</span><span class="s">"placed_disk"</span> <span class="na">node=</span><span class="s">"disk_surface"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;transformation</span> <span class="na">rotation_euler=</span><span class="s">"0. 30. 0."</span> <span class="na">displacement=</span><span class="s">"0 0 -1.0"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/space&gt;</span>
    <span class="nt">&lt;space</span> <span class="na">name=</span><span class="s">"assembly_2"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;transformation</span> <span class="na">rotation_euler=</span><span class="s">"0. 30. 0."</span> <span class="na">displacement=</span><span class="s">"0 0 1.0"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;surface</span> <span class="na">name=</span><span class="s">"placed_disk"</span> <span class="na">node=</span><span class="s">"disk_surface"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/space&gt;</span>
<span class="nt">&lt;/space&gt;</span>
</code></pre></div>
<p>In this case, the <code class="docutils literal notranslate">placed_disk</code> in in the first assembly will be tilted relative to the world volume, while the
disk in the second assembly will not! This can be verified easily with one of the geometry viewers, which are explained
in section  <a class="reference internal" href="visualization.html#visualization-label"><span class="std std-ref">Visualization Techniques</span></a>. The reason for this behavior is that in the second case, the rotation was
applied before placing the surface inside the assembly, and so it is not propagated to the shape. This is on purpose,
because it allows to transform the origin and orientation of the reference system before assembling elements.</p>
<p>It is best to think of the <code class="docutils literal notranslate">&lt;transformation&gt;</code> elements as commands that are executed during XML initialization, while
the geometry is assembled. It should be clear then that the two example assemblies yield different results.</p>
</section>
<section id="extensions">
<h3>Extensions<a aria-label="Copy link to section: Extensions." class="headerlink tooltipped tooltipped-ne" href="#extensions" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>In order to give physical properties to the geometry elements that have been constructed and placed, they must be
associated with extensions. The currently available extensions are <em>meshing</em> (axially or rotationally symmetric, or
non-symmetric), <em>visualization</em> properties, electrostatic <em>boundary conditions</em> (Dirichlet or Neumann surfaces), and
magnetostatic properties of <em>solenoids and coils</em> (current density and number of windings.)</p>
<p>A simple extension example is specifying the color and opacity of a shape for its display in a <a class="reference external" href="http://www.vtk.org/">VTK<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a> visualization window
as follows:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;appearance</span> <span class="na">name=</span><span class="s">"app_magnet"</span> <span class="na">color=</span><span class="s">"0 255 127 127"</span> <span class="na">arc=</span><span class="s">"72"</span> <span class="na">surfaces=</span><span class="s">"world/dipole_trap/@magnet_tag"</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>This example tells the visualization that any shape given the tag <code class="docutils literal notranslate">magnet_tag</code> should be colored with an RGBA color
value of (0,255,127,127), where all values are given in the range 0..255 and the fourth value defines the shape’s
opacity. If you have VTK enabled you may wish to experiment with the changes introduced by modifying these parameters.
When using the <a class="reference external" href="https://root.cern.ch/">ROOT<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a> visualization, the appearance settings will be ignored.</p>
<p>In the line above, you also find an example of referencing tags throught the <code class="docutils literal notranslate">@tag_name</code> syntax. Generally the
placed shapes can be referenced through a <a class="reference external" href="https://www.w3.org/TR/xpath-10/">XPath<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>-like syntax that defines the location in the geometry tree, starting
at the “root” volume (which is typically called <cite>world</cite>.) This usually works with all <cite>spaces</cite> and <cite>surfaces</cite>
attributes of the XML elements.</p>
<p>The tagging feature is very useful for applying properties to many different elements at once. To do this, each element
which is to receive the same extension must share the same tag. There is no limit to the number of tags an geometric
element may be given. For example, given the dipole trap geometry as specified, one may associate an axially symmetric
mesh with all elements that share the tag <code class="docutils literal notranslate">electrode_tag</code> with the line:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;axial_mesh</span> <span class="na">name=</span><span class="s">"mesh_electrode"</span> <span class="na">surfaces=</span><span class="s">"world/dipole_trap/@electrode_tag"</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>This specifies that any geometric shape with the tag <code class="docutils literal notranslate">electrode_tag</code> that is found within the <code class="docutils literal notranslate">world/dipole_trap</code>
space should be giving an axial mesh extension (i.e. it will be divided into a collection of axially symmetric objects
like cones, cylinders, etc.) This axial mesh will be later used by the field solving routines in <em>KEMField</em>. However, a
tag is not strictly necessary to apply an extension. For example, if we wished to generate an axial mesh for everything
within the world volume we would write:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;axial_mesh</span> <span class="na">name=</span><span class="s">"mesh_electrode"</span> <span class="na">surfaces=</span><span class="s">"world/#"</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>or, if we wished to single out the <code class="docutils literal notranslate">ring_surface</code> shape by specifying its full path we would write:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;axial_mesh</span> <span class="na">name=</span><span class="s">"mesh_electrode"</span> <span class="na">surfaces=</span><span class="s">"world/dipole_trap/ring"</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>Meshing is critical for any problem with involves electrostatic fields. The type of mesh depends on the symmetry of the
geometry. For completely axially-symmetric geometries, the <code class="docutils literal notranslate">axial_mesh</code> is recommended so that the zonal harmonics
field computation method may be used. For completely non-symmetric (3D) geometries, the mesh type would be specified as
follows:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;mesh</span> <span class="na">name=</span><span class="s">"mesh_electrode"</span> <span class="na">surfaces=</span><span class="s">"world/dipole_trap/@electrode_tag"</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>Because of the very shape-specific nature of the deterministic meshing which is provided by <em>KGeoBag</em>, parameters
(<code class="docutils literal notranslate">mesh_count</code> and <code class="docutils literal notranslate">mesh_power</code>) describing how the mesh is to be constructed are given when specifying the shapes
themselves. That being said, the mesh associated with a specific shape will not be constructed unless the extension
statement is present.</p>
<p>It is possible to define multiple meshes side by side, e.g. if the simulation can be configured axially-symmetric or
non-symmetric. In this case, both meshes will be available for <em>KEMField</em> calculations regardless of the symmetry
setting. Note that the axial mesh cannot handle any non-symmetric elements, and these will be simply ignored.</p>
<p>Another important extension for field calculations is the specification of boundary conditions. For example, when
solving the Laplace boundary value problem via <em>KEMField</em>, one may specify that a particular surface exhibit Dirichlet
boundary conditions where a particular voltage is applied to the surface through the use of the following extension:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;electrostatic_dirichlet</span> <span class="na">name=</span><span class="s">"electrode_ring"</span> <span class="na">surfaces=</span><span class="s">"world/dipole_trap/ring"</span> <span class="na">value=</span><span class="s">"-10."</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>Where <code class="docutils literal notranslate">value="-10"</code> signifies that this surface has a potential of -10 volts. This is the standard case for defining
(metallic) electrode surfaces in a simulation, and a typical scenario for the boundary-element method (BEM). It is also
possible to define Neumann boundary conditions, which are typically used for insulating materials.</p>
<p>Similar to the electrode setup, one can define a magnet system that provides a magnetostatic field for the simulation.
For example, one may specify a solenoid electromagnet with the appropriate parameters:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;electromagnet</span> <span class="na">name=</span><span class="s">"electromagnet_upstream_solenoid"</span> <span class="na">spaces=</span><span class="s">"world/dipole_trap/upstream_solenoid"</span> <span class="na">current=</span><span class="s">"{22.3047 * 20000}"</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>which references a space named <code class="docutils literal notranslate">upstream_solenoid</code> with a total current of 22.3047 amps times 20000 turns. The
electric current and the number of turns can also be specified separately for added clarity:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang">xml</span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code><span class="nt">&lt;electromagnet</span> <span class="na">name=</span><span class="s">"electromagnet_upstream_solenoid"</span> <span class="na">spaces=</span><span class="s">"world/dipole_trap/upstream_solenoid"</span> <span class="na">current=</span><span class="s">"22.3047"</span> <span class="na">num_turns=</span><span class="s">"20000"</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>The cylinder tube space is one of the supported shapes for electromagnets and describes a solenoid geometry. Other
supported shapes are the cylinder surface, describing a simple coil, and the rod space, describing a single wire.</p>
<p>For further demonstrations of the possible geometry extensions please see the provided example XML files located
at <a class="reference external" href="https://github.com/KATRIN-Experiment/Kassiopeia/blob/master/KGeoBag/Source/XML/Examples">GitHub: KGeoBag/Source/XML/Examples<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>.</p>
</section>
</section>
<section id="kassiopeia">
<h2>Kassiopeia<a aria-label="Copy link to section: Kassiopeia." class="headerlink tooltipped tooltipped-ne" href="#kassiopeia" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>The remaining elements all live within the <em>Kassiopeia</em> element and must be placed with
start and end tags of the form:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>.. code-block:: xml
</code></pre></div>
<blockquote>
<div><dl class="simple">
<dt>&lt;kassiopeia&gt;</dt><dd><p>&lt;!– complete description of the kassiopeia simulation element here –&gt;</p>
</dd>
</dl>
<p>&lt;/kassiopeia&gt;</p>
</div></blockquote>
<p>The elements which must be described within the <em>Kassiopeia</em> namespace include the specification
of the fields, propagation, interactions, termination, navigation, output, and simulation.</p>
</section>
<section id="fields">
<h2>Fields<a aria-label="Copy link to section: Fields." class="headerlink tooltipped tooltipped-ne" href="#fields" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>Once the simulation geometry has been specified the user may describe the types of electric and
magnetic fields they wish associate with each geometric object. The field package <em>KEMField</em>
takes care of solving the boundary value problem and computing the fields for electrostatic problems.
It also handles the magnetic field computation from static current distributions. Fast field calculation
methods are available for axially symmetric (zonal harmonics) and
three dimensional problems (fast multipole method). The abstract base classes responsible for
electric and magnetic fields in <em>Kassiopeia</em> are <a href="#id1"><span class="problematic" id="id2">:kassiopeia:`KSElectricField`</span></a> and
<a href="#id3"><span class="problematic" id="id4">:kassiopeia:`KSMagneticField`</span></a> respectively.</p>
<p>For example, in the <code class="docutils literal notranslate">DipoleTrapSimulation.xml</code> example the electric and magnetic fields are axially
symmetric and can be computed using the zonal harmonics expansion.</p>
<section id="electric">
<h3>Electric<a aria-label="Copy link to section: Electric." class="headerlink tooltipped tooltipped-ne" href="#electric" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>To specify the electric field, the geometric surfaces which are electrically
active must be listed in the <code class="docutils literal notranslate">surfaces</code> element. It is important that the surfaces which are specified have a mesh extension
and a boundary type extension. If either of these extensions are missing from the specified
surface, they will not be included in the electrostatics problem. A boundary element
mesh is needed to solve the Laplace equation using the boundary element method. Each element
of the mesh inherits its parent surface’s boundary condition type.</p>
<p>Both a method to solve the Laplace boundary value problem (a <code class="docutils literal notranslate">bem_solver</code>), and a method by which to compute
the fields from the resulting charge densities must be given (a <code class="docutils literal notranslate">field_sovler</code>). In
the following example we use a <code class="docutils literal notranslate">robin_hood_bem_solver</code> and a <code class="docutils literal notranslate">zonal_harmonic_field_solver</code>:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>&lt;ksfield_electrostatic
    name="field_electrostatic"
    directory="[KEMFIELD_CACHE]"
    file="DipoleTrapElectrodes.kbd"
    system="world/dipole_trap"
    surfaces="world/dipole_trap/@electrode_tag"
    symmetry="axial"
&gt;
    &lt;robin_hood_bem_solver
        tolerance="1.e-10"
        check_sub_interval="100"
        display_interval="1"
        cache_matrix_elements="true"
    /&gt;
    &lt;zonal_harmonic_field_solver
        number_of_bifurcations="-1"
        convergence_ratio=".99"
        convergence_parameter="1.e-15"
        proximity_to_sourcepoint="1.e-12"
        number_of_central_coefficients="500"
        use_fractional_central_sourcepoint_spacing="false"
        central_sourcepoint_spacing="1.e-3"
        central_sourcepoint_start="-5.2e-1"
        central_sourcepoint_end="5.2e-1"
        number_of_remote_coefficients="200"
        remote_sourcepoint_start="-5.e-2"
        remote_sourcepoint_end="5.e-2"
    /&gt;
</code></pre></div>
<p>It is also important that geometric elements be meshed appropriately with respect to symmetry.
In the case that the user wishes to use zonal harmonic field calculation routines,
an <code class="docutils literal notranslate">axial_mesh</code> must be used.
If a normal (3D) mesh is used, zonal harmonics cannot function. Different mesh/symmetry
types cannot be combined within the same electric field solving element.</p>
<p>In the three-dimensional mesh case, either an integrating field solver, or a fast multipole field solver
may be used. The integrating field solver may be specified through inclusion of the
element:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>&lt;integrating_field_solver/&gt;
</code></pre></div>
<p>within the the <code class="docutils literal notranslate">ksfield_electrostatic</code> element. As the integrating field solver
is quite simple, it does not require additional parameters.
The fast multipole field solver on the other hand is
somewhat more complex and requires a relatively large set of additional parameters to be specified in
order to configure its use according to the user’s desired level of accuracy and computational effort.</p>
<p>For a complete list and description of the XML bindings available for the electric field solving routines,
navigate to the directory <code class="docutils literal notranslate">$KASPERSYS/config/KEMField/Complete</code>. The file <code class="docutils literal notranslate">ElectricFields.xml</code>
has examples of the binding for initializing electric field problems.</p>
</section>
<section id="magnetic">
<h3>Magnetic<a aria-label="Copy link to section: Magnetic." class="headerlink tooltipped tooltipped-ne" href="#magnetic" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>The specification of the magnetic field solving routines is considerably simpler since there is no
need to solve a boundary value problem before hand. There are essentially two choices for solving magnetic
fields from static current distributions. These are; the zonal harmonics method for use with axially
symmetric current sources, and the integrating magnetic field solver which can be used on geometries
with more arbitrary distributions of current. Unlike electric fields, magnetic fields can
contain components with both axially symmetric and non-axially symmetric elements
within the same region with no adverse effects.</p>
<p>A complete list and set of examples of the XML bindings for magnetic fields can be found
in the file <code class="docutils literal notranslate">$KASPERSYS/config/KEMField/Complete/MagneticFields.xml</code>.</p>
<p>Further documentation on the exact methods and parameters
used in <em>KEMField</em> can be found in [2] and [3].</p>
</section>
</section>
<section id="generation">
<h2>Generation<a aria-label="Copy link to section: Generation." class="headerlink tooltipped tooltipped-ne" href="#generation" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>The intial state of particle’s to be tracked is set up using the generator mechanism. The
abstract base class of all particle generators is <a href="#id5"><span class="problematic" id="id6">:kassiopeia:`KSGenerator`</span></a>.
When generating a particle, there are five important initial parameters:</p>
<ul class="simple">
<li><p>PID: What is the particle type? For particle ID values, see the <a class="reference external" href="http://pdg.lbl.gov/mc_particle_id_contents.html">PDG<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a> numbering scheme.</p></li>
<li><p>Energy: What is the initial energy of the particle?</p></li>
<li><p>Position: What is the initial position of the particle?</p></li>
<li><p>Direction: In what direction is the particle traveling?</p></li>
<li><p>Time: How is the production of particles distributed in time during the simulation?</p></li>
</ul>
<p>Each of the dynamic components (energy, position, direction, time) can be draw
from a selected probability distribution. In some scenarios a dedicated particle generator
may be need which produces with a very specific and well defined particle state as the
result of some physical process (e.g. electron shake off in Radon decay). However,
as is often the case, the user may wish to modify each dynamic component in a specific
way in order to see what effect this has on the rest of the simulation. To
draw each dynamic component from an independent distribution a composite
generator is used. This type of generator combines a set of user selected distributions
to produce the initial energy, position, direction, and time parameters.
The following composite generator example is taken from the DipoleTrapSimulation.xml:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>&lt;!-- pid=11 implies that electrons will be generated --&gt;
&lt;ksgen_generator_composite name="generator_uniform" pid="11"&gt;
    &lt;energy_composite&gt;
        &lt;energy_fix value="1."/&gt;
    &lt;/energy_composite&gt;
    &lt;position_cylindrical_composite surface="world/dipole_trap/center"&gt;
        &lt;r_cylindrical radius_min="0." radius_max="2.0e-1"/&gt;
        &lt;phi_uniform value_min="0." value_max="360."/&gt;
        &lt;z_fix value="0."/&gt;
    &lt;/position_cylindrical_composite&gt;
    &lt;direction_spherical_composite surface="world/dipole_trap/center"&gt;
        &lt;theta_fix value="0."/&gt;
        &lt;phi_uniform value_min="0." value_max="360"/&gt;
    &lt;/direction_spherical_composite&gt;
    &lt;time_composite&gt;
        &lt;time_fix value="0."/&gt;
    &lt;/time_composite&gt;
&lt;/ksgen_generator_composite&gt;
</code></pre></div>
<p>In this example of the composite generator, the initial kinetic
energy of the particle is fixed to 1 eV and its position is drawn uniformly within a cylindrical
volume. Its initial starting time is fixed to zero, while its initial momentum direction is fixed
along the z-axis. All of the fixed values used in this composite generator may be replaced by
probability distributions. The available probability distributions depend on the quantity they are
intended to generator, but included uniform, gaussian, pareto, cosine, etc. Also available
is the ability to generate values at fix intervals throughout a limited range. For example
this can be done for energy as follows:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>&lt;energy_composite&gt;
    &lt;energy_set name="e_set" value_start="1" value_stop="10" value_count="3"/&gt;
&lt;/energy_composite&gt;
</code></pre></div>
<p>which would generate 3 electrons with energies equally spaced between 1 and 10 eV.
Alternatively, as specific list of values can also be used:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>&lt;energy_composite&gt;
    &lt;energy_list
       add_value="11.8"
       add_value="20.5"
       add_value="33.1"
    /&gt;
&lt;/energy_composite&gt;
</code></pre></div>
<p>Keep in mind that if a <code class="docutils literal notranslate">list</code> of <code class="docutils literal notranslate">set</code> is used within a composite generator, the number of particles
produced in an “event” will be equal to multiplicative combination of all possible particle states.
For example, the following generator specification:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>    &lt;ksgen_generator_composite name="generator_uniform" pid="11"&gt;
    &lt;energy_composite&gt;
        &lt;energy_set name="e_set" value_start="1" value_stop="200" value_count="10"/&gt;
    &lt;/energy_composite&gt;
    &lt;position_cylindrical_composite surface="world/dipole_trap/center"&gt;
        &lt;r_cylindrical radius_min="0." radius_max="2.0e-1"/&gt;
        &lt;phi_uniform value_min="0." value_max="360."/&gt;
        &lt;z_fix value="0."/&gt;
    &lt;/position_cylindrical_composite&gt;
    &lt;direction_spherical_composite surface="world/dipole_trap/center"&gt;
        &lt;theta_set name="e_set" value_start="0" value_stop="90" values_count="10"/&gt;
        &lt;phi_uniform value_min="0." value_max="360"/&gt;
    &lt;/direction_spherical_composite&gt;
    &lt;time_composite&gt;
        &lt;time_fix value="0."/&gt;
    &lt;/time_composite&gt;
&lt;/ksgen_generator_composite&gt;
</code></pre></div>
<p>results in a total of 100 particles being generated in a single event (as a combination of
possible energies and momentum direction theta coordinate). To see other generator examples please
see the included example XML files.</p>
</section>
<section id="termination">
<h2>Termination<a aria-label="Copy link to section: Termination." class="headerlink tooltipped tooltipped-ne" href="#termination" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>The converse to particle generation is termination. The abstract base class of
all particle terminators is <a href="#id7"><span class="problematic" id="id8">:kassiopeia:`KSTerminator`</span></a>. Terminators are used to kill particle tracks
in situations where further simulation of the particle is of no further interest. Terminators
typically operate on very simple conditional logic. For example, a particle track may be terminated
if the particle’s kinetic energy drops below some set value, or if it intersects a particular surface.</p>
<p>An example of a terminator which kills particle tracks which exceed a certain number (1000)
of allowed steps is given as follows:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>&lt;ksterm_max_steps name="term_max_steps" steps="1000"/&gt;
</code></pre></div>
<p>A pair of terminators which will kill a particle that exceeds an allowed range
for the z-coordinate is given in the following example:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>&lt;ksterm_max_z name="term_max_z" z="1.0"/&gt;
&lt;ksterm_min_z name="term_min_z" z="-1.0"/&gt;
</code></pre></div>
<p>There are a wide variety of terminators currently avaiable, and the user is encourages to peruse
the XML example files as well as the source code to determine what (if any)
type of pre-existing terminator might be useful for their purpose.</p>
</section>
<section id="interactions">
<h2>Interactions<a aria-label="Copy link to section: Interactions." class="headerlink tooltipped tooltipped-ne" href="#interactions" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>In between generation and termination discrete stochastic interactions involving
the particle of interest may be applied during tracking. These interactions are divided
according to whether they are active in a volume, or on a surface.</p>
<section id="volume-interactions">
<h3>Volume Interactions<a aria-label="Copy link to section: Volume Interactions." class="headerlink tooltipped tooltipped-ne" href="#volume-interactions" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>Volume interactions typically involve scattering off of a gas. The
abstract base class of all volume interactions is <a href="#id9"><span class="problematic" id="id10">:kassiopeia:`KSSpaceInteraction`</span></a>.
Simple situations where the scattering interactions is treated
approximately by a constant density and cross section can be
constructed as follows:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>&lt;ksint_scattering name="int_scattering" split="true"&gt;
    &lt;density_constant temperature="300." pressure="3.e0"/&gt;
    &lt;calculator_constant cross_section="1.e-18"/&gt;
&lt;/ksint_scattering&gt;
</code></pre></div>
<p>In this example the density is computed according to the ideal gas law from the temperature (Kelvin)
and pressure (Pascal) and the cross section is treated as a constant (independent of particle energy).
For more complicated interaction (e.g. involving differential or energy dependent cross sections) the user
may need to devise their own interaction class. Volume interactions must be associated with a particular
volume when describing the simulation structure.</p>
</section>
<section id="surface-interactions">
<h3>Surface Interactions<a aria-label="Copy link to section: Surface Interactions." class="headerlink tooltipped tooltipped-ne" href="#surface-interactions" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>Surface interactions are much more limited in their scope and only
occur when the track of a particle passes through a surface. The
abstract base class of all surface interactions is <a href="#id11"><span class="problematic" id="id12">:kassiopeia:`KSSurfaceInteraction`</span></a>.</p>
<p>For example, to cause a particle to be reflected diffusely (Lambertian)
from a surface the user can specify an interaction of the following type:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>&lt;ksint_surface_diffuse name="int_surface_diffuse" probability=".3" reflection_loss="0." transmission_loss="1."/&gt;
</code></pre></div>
<p>In order for this interaction to operate on any particles it must be associated with a surface
in the simulation command structure.</p>
</section>
</section>
<section id="output">
<h2>Output<a aria-label="Copy link to section: Output." class="headerlink tooltipped tooltipped-ne" href="#output" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>The data which is saved as output from the simulation requires two pieces: a file writer
and a description of the data to be saved. The abstract base class of all
file writers is <a href="#id13"><span class="problematic" id="id14">:kassiopeia:`KSWriter`</span></a>.</p>
<section id="writers">
<h3>Writers<a aria-label="Copy link to section: Writers." class="headerlink tooltipped tooltipped-ne" href="#writers" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>The file writer is responsible for buffering and writing the desired information to disk. The default writer
is based on <a class="reference external" href="https://root.cern.ch/">ROOT<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>, and stores the output in a TTree:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>&lt;kswrite_root
    name="write_root"
    path="/path/to/desired/output/directory"
    base="my_filename.root"
/&gt;
</code></pre></div>
<p>If <em>Kassiopeia</em> is linked against VTK, an additional writer will be made available which can save
track and step information to a .vtp (VTK polydata file). This data is useful for visualalization
in external tools such as <a class="reference external" href="http://www.paraview.org/">Paraview<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>. This write may be created using the following statement:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>&lt;kswrite_vtk
    name="write_vtk"
    path="/path/to/desired/output/directory"
    base="my_filename_base.vtp"
/&gt;
</code></pre></div>
</section>
<section id="output-description">
<h3>Output description<a aria-label="Copy link to section: Output description." class="headerlink tooltipped tooltipped-ne" href="#output-description" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>The user may tailor the data written to disk to keep precisely the quantities of interest
and no more. To do this a description of the data components to be kept at the track
and step level must be given. An example of this (taken from the QuadrupoleTrapSimulation.xml example)
is shown below:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>&lt;ks_component_member name="component_step_final_particle" field="final_particle" parent="step"/&gt;
&lt;ks_component_member name="component_step_position" field="position" parent="component_step_final_particle"/&gt;
&lt;ks_component_member name="component_step_length" field="length" parent="component_step_final_particle"/&gt;

&lt;ks_component_group name="component_step_world"&gt;
    &lt;component_member name="step_id" field="step_id" parent="step"/&gt;
    &lt;component_member name="continuous_time" field="continuous_time" parent="step"/&gt;
    &lt;component_member name="continuous_length" field="continuous_length" parent="step"/&gt;
    &lt;component_member name="time" field="time" parent="component_step_final_particle"/&gt;
    &lt;component_member name="position" field="position" parent="component_step_final_particle"/&gt;
    &lt;component_member name="momentum" field="momentum" parent="component_step_final_particle"/&gt;
    &lt;component_member name="magnetic_field" field="magnetic_field" parent="component_step_final_particle"/&gt;
    &lt;component_member name="electric_field" field="electric_field" parent="component_step_final_particle"/&gt;
    &lt;component_member name="electric_potential" field="electric_potential" parent="component_step_final_particle"/&gt;
    &lt;component_member name="kinetic_energy" field="kinetic_energy_ev" parent="component_step_final_particle"/&gt;
&lt;/ks_component_group&gt;

&lt;ks_component_group name="component_step_cell"&gt;
    &lt;component_member name="polar_angle_to_z" field="polar_angle_to_z" parent="component_step_final_particle"/&gt;
    &lt;component_member name="polar_angle_to_b" field="polar_angle_to_b" parent="component_step_final_particle"/&gt;
    &lt;component_member name="guiding_center_position" field="guiding_center_position" parent="component_step_final_particle"/&gt;
    &lt;component_member name="orbital_magnetic_moment" field="orbital_magnetic_moment" parent="component_step_final_particle"/&gt;
&lt;/ks_component_group&gt;

&lt;ks_component_member name="component_track_initial_particle" field="initial_particle" parent="track"/&gt;
&lt;ks_component_member name="component_track_final_particle" field="final_particle" parent="track"/&gt;
&lt;ks_component_member name="component_track_position" field="position" parent="component_track_final_particle"/&gt;
&lt;ks_component_member name="component_track_length" field="length" parent="component_track_final_particle"/&gt;

&lt;ks_component_member name="z_length" field="continuous_length" parent="step"/&gt;
&lt;ks_component_group name="component_track_world"&gt;
    &lt;component_member name="creator_name" field="creator_name" parent="track"/&gt;
    &lt;component_member name="terminator_name" field="terminator_name" parent="track"/&gt;
    &lt;component_member name="total_steps" field="total_steps" parent="track"/&gt;
    &lt;component_member name="initial_time" field="time" parent="component_track_initial_particle"/&gt;
    &lt;component_member name="initial_position" field="position" parent="component_track_initial_particle"/&gt;
    &lt;component_member name="initial_momentum" field="momentum" parent="component_track_initial_particle"/&gt;
    &lt;component_member name="initial_magnetic_field" field="magnetic_field" parent="component_track_initial_particle"/&gt;
    &lt;component_member name="initial_electric_field" field="electric_field" parent="component_track_initial_particle"/&gt;
    &lt;component_member name="initial_electric_potential" field="electric_potential" parent="component_track_initial_particle"/&gt;
    &lt;component_member name="initial_kinetic_energy" field="kinetic_energy_ev" parent="component_track_initial_particle"/&gt;
    &lt;component_member name="initial_polar_angle_to_z" field="polar_angle_to_z" parent="component_track_initial_particle"/&gt;
    &lt;component_member name="initial_azimuthal_angle_to_x" field="azimuthal_angle_to_x" parent="component_track_initial_particle"/&gt;
    &lt;component_member name="initial_polar_angle_to_b" field="polar_angle_to_b" parent="component_track_initial_particle"/&gt;
    &lt;component_member name="initial_orbital_magnetic_moment" field="orbital_magnetic_moment" parent="component_track_initial_particle"/&gt;
    &lt;component_member name="final_time" field="time" parent="component_track_final_particle"/&gt;
    &lt;component_member name="final_position" field="position" parent="component_track_final_particle"/&gt;
    &lt;component_member name="final_momentum" field="momentum" parent="component_track_final_particle"/&gt;
    &lt;component_member name="final_magnetic_field" field="magnetic_field" parent="component_track_final_particle"/&gt;
    &lt;component_member name="final_electric_field" field="electric_field" parent="component_track_final_particle"/&gt;
    &lt;component_member name="final_electric_potential" field="electric_potential" parent="component_track_final_particle"/&gt;
    &lt;component_member name="final_kinetic_energy" field="kinetic_energy_ev" parent="component_track_final_particle"/&gt;
    &lt;component_member name="final_polar_angle_to_z" field="polar_angle_to_z" parent="component_track_final_particle"/&gt;
    &lt;component_member name="final_azimuthal_angle_to_x" field="azimuthal_angle_to_x" parent="component_track_final_particle"/&gt;
    &lt;component_member name="final_polar_angle_to_b" field="polar_angle_to_b" parent="component_track_final_particle"/&gt;
    &lt;component_member name="final_orbital_magnetic_moment" field="orbital_magnetic_moment" parent="component_track_final_particle"/&gt;
    &lt;component_member name="z_length_internal" field="continuous_length" parent="track"/&gt;
    &lt;component_integral name="z_length_integral" parent="z_length"/&gt;
&lt;/ks_component_group&gt;
</code></pre></div>
</section>
</section>
<section id="propagation">
<h2>Propagation<a aria-label="Copy link to section: Propagation." class="headerlink tooltipped tooltipped-ne" href="#propagation" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>The propagation section is used to describe the physical process which is associated
with the movement of a particle, and also the means by which the equations of motion are solved.
The equations of motions are solved numerically with various control methods for the time step
used during integration of a specific particle trajectory. The
abstract base class of all particle trajectories is <a href="#id15"><span class="problematic" id="id16">:kassiopeia:`KSTrajectory`</span></a>.</p>
<p>There are essential four different equations of motion (trajectories) available for particle tracking in <em>Kassiopeia</em>.
These are, exact, adiabatic, electric, and magnetic.</p>
<p>The first trajectory type is the so-called exact method, which solves the Lorentz equation for charged
particles exactly without approximations. The second method is the adiabatic method, which is useful
for solving charged particle motion in the presence of smoothly varying magnetic fields. The last two
types, electric and magnetic, are used for tracing the field lines of static electric and
magnetic fields respectively.</p>
<p>The exact tracking method can be used where accuracy is of the utmost importance, but requires
a large number of steps in order propagate a particle for a long time or distance. An example
of its use is given below:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>&lt;kstraj_trajectory_exact name="trajectory_exact" attempt_limit="8"&gt;
    &lt;interpolator_crk name="interpolator_crk"/&gt;
    &lt;integrator_rkdp853 name="integrator_rkdp853"/&gt;
    &lt;term_propagation name="term_propagation"/&gt;
    &lt;control_position_error name="control_position_error" absolute_position_error="1e-12" safety_factor="0.75" solver_order="8"/&gt;
    &lt;control_length name="stepsizelength" length="1e-4" /&gt;
    &lt;control_time name="stepsizetime" time="1e-6" /&gt;
&lt;/kstraj_trajectory_exact&gt;
</code></pre></div>
<p>In the above example, the integrator type specified <code class="docutils literal notranslate">integrator_rkdp853</code> is an 8-th order Runge-Kutta
integrator with a 7-th order dense output interpolant (specified by <code class="docutils literal notranslate">interpolator_crk</code>). The step-size
control is accomplished through the combination of three different methods. Two of them <code class="docutils literal notranslate">control_length</code>
and <code class="docutils literal notranslate">control_time</code> place a fixed limit on the step-size, while the third <code class="docutils literal notranslate">control_position_error</code> dynamically
attempts to limit the local numerical error on the particle’s position below some limit.</p>
<p>All of the trajectories take an optional parameter <code class="docutils literal notranslate">attempt_limit</code> which limits the
number of tries an integration step will be re-attempted if a step-size control determines
that the step has failed. The default number of maximum number of attempts is 32. If a trajectory
makes no progress after the maximum number of allowed attempts, the track will be terminated
with a <code class="docutils literal notranslate">trajectory_fail</code> flag.</p>
<p>An example of the adiabatic trajectory is specified in the following:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>&lt;!--  adiabatic trajectory --&gt;
&lt;kstraj_trajectory_adiabatic name="trajectory_adiabatic" piecewise_tolerance="1e-6" max_segments="130" use_true_position="true" cyclotron_fraction="{1.0/64.0}" attempt_limit="8"&gt;
    &lt;interpolator_crk name="interpolator_crk"/&gt;
    &lt;integrator_rkdp853 name="integrator_rkdp853"/&gt;
    &lt;term_propagation name="term_propagation"/&gt;
    &lt;term_drift name="term_drift"/&gt;
    &lt;term_gyration name="term_gyration"/&gt;
    &lt;control_time name="control_time_adiab" time="1e-6"/&gt;
    &lt;control_position_error name="control_position_error" absolute_position_error="1e-9" safety_factor="0.75" solver_order="8"/&gt;
&lt;/kstraj_trajectory_adiabatic&gt;
</code></pre></div>
<p>In this example, both the motion of the particle’s guiding center drift (<code class="docutils literal notranslate">term_drift</code>) and the
particle’s local gyration (<code class="docutils literal notranslate">term_gyration</code>) itself are included in the equations of motion and computed.
It is important to note that the adiabatic trajectory cannot be use if there is no magnetic field present.</p>
<p>The last two trajectory types can be specfified as follows:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>&lt;!--  magnetic trajectory --&gt;
&lt;kstraj_trajectory_magnetic name="trajectory_magnetic" piecewise_tolerance="1e-12" max_segments="128"&gt;
    &lt;interpolator_crk name="interpolator_crk"/&gt;
    &lt;integrator_rkdp54 name="integrator_rkdp54"/&gt;
    &lt;term_propagation name="term_propagation" direction="forward"/&gt;
    &lt;control_time name="control_time" time="1.e-4"/&gt;
    &lt;control_length name="control_length" length="1e-2"/&gt;
&lt;/kstraj_trajectory_magnetic&gt;

&lt;!--  electric trajectory --&gt;
&lt;kstraj_trajectory_electric name="trajectory_electric" piecewise_tolerance="1e-12" max_segments="128"&gt;
    &lt;interpolator_crk name="interpolator_crk"/&gt;
    &lt;integrator_rkdp54 name="integrator_rkdp54"/&gt;
    &lt;term_propagation name="term_propagation" direction="backward"/&gt;
    &lt;control_time name="control_time" time="1.e-4"/&gt;
    &lt;control_length name="control_length" length="1e-2"/&gt;
&lt;/kstraj_trajectory_electric&gt;
</code></pre></div>
<p>The electric and magnetic field line trajectories are useful for visualization and during
the design stages of an experiment or simulation. Note that in the above examples we have used a faster but less
accurate Runge-Kutta integrator <code class="docutils literal notranslate">integrator_rkdp54</code>. The property <code class="docutils literal notranslate">direction</code> in <code class="docutils literal notranslate">term_propagation</code>
can be used to specify the direction in which field lines are tracked (positive-to-negative or north-to-south).</p>
<p>In all of the trajectories (exact, adiabatic, electric, magnetic) the parameters <code class="docutils literal notranslate">piecewise_tolerance</code> and <code class="docutils literal notranslate">max_segments</code> are optional.
They dictate how a particles trajectory (in between steps) should be approximated by piecewise linear segments
when determining surface and volume intersections. These parameters are only used
when the <code class="docutils literal notranslate">ksnav_meshed_space</code> navigator is in use, and determine how accurately intersections
are found. The default <code class="docutils literal notranslate">ksnav_space</code> navigator ignores these parameters, since it
uses a faster but less accurate approximation by linearly interpolating a
particle’s intermediate state and position.</p>
<p>The adiabatic trajectory also takes the additional parameters
<code class="docutils literal notranslate">use_true_position</code> and <code class="docutils literal notranslate">cyclotron_fraction</code> when the <code class="docutils literal notranslate">mesh_spaced_navigator</code>
is in use. The parameter <code class="docutils literal notranslate">use_true_position</code> determines whether the particle or its
guiding center position is used for the purpose of finding intersections. If the particle’s
true position is used, then the parameter <code class="docutils literal notranslate">cyclotron_fraction</code> dictates the number of linear
segments the semi-helical path is broken into.</p>
</section>
<section id="navigation">
<h2>Navigation<a aria-label="Copy link to section: Navigation." class="headerlink tooltipped tooltipped-ne" href="#navigation" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>The navigation of a particle is split into two components, surface navigation and space
navigation. Surface navigation is very simple and only takes place when a particle
has intersected an active surface. The surface navigator determines whether the state
of the particle is modified on the surface and whether it is reflected or transmitted.
It is very simple and can be made available for use with the declaration:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>&lt;ksnav_surface name="nav_surface"/&gt;
</code></pre></div>
<p>The space navigator more complex since it is responsible for determine the location of the particle
and any possible intersections it may have with real of virtual boundaries. It
is also responsible for ensuring that the current simulation state matches the configuration
specified by the user. The spaces that the navigator considers may be real objects (such as a vacuum chamber wall) or
virtual (which only modify the state of the simulation, e.g. exchanging a trajectory method).</p>
<p>For space navigation there are two options. The first is the default <code class="docutils literal notranslate">ksnav_space</code> navigator
which can be specified as below:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>&lt;ksnav_space name="nav_space" enter_split="false" exit_split="false"/&gt;
</code></pre></div>
<p>As this navigator is very simple, it does not take many additional parameters.
The parameters <code class="docutils literal notranslate">enter_split</code> and <code class="docutils literal notranslate">exit_split</code> determine whether or not a track
is split in two (for the purposes of output/saving data) upon entrance or exit of a geometric space.</p>
<p>The second is the <code class="docutils literal notranslate">ksnav_meshed_space</code> navigator which is intended to be used
in complex three-dimensional geometries where it has better performance over the default navigator.
An example of this is shown in the PhotoMultplierTube.xml file. Its configuration is somewhat
more complicated as it performs the navigations on the meshed boundaries of spaces and surfaces.
This navigation method requires the construction of an octree spatial partition (which is cached for later
re-use). The use must specify the depth of the octree (<code class="docutils literal notranslate">max_octree_depth</code>) and the number of elements
allowed in a octree node before a subdivision is required (<code class="docutils literal notranslate">n_allowed_elements</code>). In addition,
the root of the geometry tree must also be specified with the parameter <code class="docutils literal notranslate">root_space</code>,
this is typically the world volume:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>&lt;ksnav_meshed_space name="nav_meshed_space" root_space="space_world" max_octree_depth="9" n_allowed_elements="1"/&gt;
</code></pre></div>
<p>Though they are not shown (they default to false) the exit and entrance split
parameters may also be set for the <code class="docutils literal notranslate">ksnav_meshed_space</code> navigator.
Because the <code class="docutils literal notranslate">ksnav_meshed_space</code> navigator requires a boundary mesh in
order to operate, all geometric objects (spaces, sufaces)
which have navigation commands attached to them must also have a mesh extension in the geometry specification.
Furthermore, since <code class="docutils literal notranslate">ksnav_meshed_space</code> requires access to the root space <code class="docutils literal notranslate">space_world</code>
and all of the navigation commands associated with the shapes it contains,
it must be declared after the definition of the simulation command structure element <code class="docutils literal notranslate">ksgeo_space</code>.</p>
</section>
<section id="navigation-and-commands">
<h2>Navigation and Commands<a aria-label="Copy link to section: Navigation and Commands." class="headerlink tooltipped tooltipped-ne" href="#navigation-and-commands" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>The commands which are associated with particular surfaces and spaces are what governs
the state of a <em>Kassiopeia</em> simulation as a particle is tracked. They are declared
through the specification of a <code class="docutils literal notranslate">ksgeo_space</code>. A very simple example of the declaration
of the command structure can be seen in the DipoleTrapSimulation.xml as shown below:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>&lt;ksgeo_space name="space_world" spaces="world"&gt;
    &lt;command parent="root_terminator" field="add_terminator" child="term_max_steps"/&gt;
    &lt;command parent="root_terminator" field="remove_terminator" child="term_world"/&gt;
    &lt;command parent="write_root" field="add_track_output" child="component_track_world"/&gt;
    &lt;command parent="write_root" field="add_step_output" child="component_step_world"/&gt;
    &lt;geo_surface name="surface_upstream_target" surfaces="world/dipole_trap/upstream_target"&gt;
        &lt;command parent="root_terminator" field="add_terminator" child="term_upstream_target"/&gt;
    &lt;/geo_surface&gt;
    &lt;geo_surface name="surface_downstream_target" surfaces="world/dipole_trap/downstream_target"&gt;
        &lt;command parent="root_terminator" field="add_terminator" child="term_downstream_target"/&gt;
    &lt;/geo_surface&gt;
    &lt;geo_surface name="surface_center" surfaces="world/dipole_trap/center"/&gt;
&lt;/ksgeo_space&gt;
</code></pre></div>
<p>In this example we create a <code class="docutils literal notranslate">ksgeo_space</code> navigation space using the <code class="docutils literal notranslate">world</code> space
geometric object. Inside of this world volume we declare a series of command which will be
executed any time a particle enters or is initialized within the world volume. The first two
commands add and remove specific terminators, while the next two declare what sort of output
should be written down within the world volume. Following that, there are commands which are
attached to specific surfaces which are present. For example, attaching the terminator <code class="docutils literal notranslate">term_upstream_target</code>
ensures that a particle impinging on the surface <code class="docutils literal notranslate">surface_upstream_target</code> will be killed.
Commands can used to change the active field calculation method,
swap trajectory types, or add/remove interactions, etc. Various spaces and
their associated commands can be nested within each other allowing for a very
flexible and dynamic simulation configuration.</p>
</section>
<section id="simulation">
<h2>Simulation<a aria-label="Copy link to section: Simulation." class="headerlink tooltipped tooltipped-ne" href="#simulation" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>The final object to be declared within <code class="docutils literal notranslate">&lt;kassiopeia&gt;</code> is the simulation element. This describes
the simulation object <a href="#id17"><span class="problematic" id="id18">:kassiopeia:`KSSimulation`</span></a>, which is then executed by <a href="#id19"><span class="problematic" id="id20">:kassiopeia:`KSRoot`</span></a>.
The simulation element specifies the global and initial properties of the simulation as a whole.
For example in the QuadrupoleTrapSimulation.xml example, the simulation element
is declared as follows:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>&lt;ks_simulation
    name="quadrupole_trap_simulation"
    run="1"
    seed="51385"
    events="10"
    magnetic_field="field_electromagnet"
    electric_field="field_electrostatic"
    space="space_world"
    generator="generator_uniform"
    trajectory="trajectory_exact"
    space_navigator="nav_space"
    surface_navigator="nav_surface"
    writer="write_root"
/&gt;
</code></pre></div>
<p>The <code class="docutils literal notranslate">run</code> is simply a user provided identifier. The <code class="docutils literal notranslate">seed</code> is the value provided to
the global (singleton) random number generator. Simulations with the same configuration and same seed
should provide identical results. If the user is interested in running <em>Kassiopeia</em> on many machines
in order to achieve high throughput particle tracking,
care must be taken to ensure that the <code class="docutils literal notranslate">seed</code> value is different
for each run of the simulation. The parameter <code class="docutils literal notranslate">events</code> determines the total number of times that
the generator is run (but this is not necessarily the number of particles that will be tracked).
The remaining parameters <code class="docutils literal notranslate">magnetic_field</code>, <code class="docutils literal notranslate">space</code>, <code class="docutils literal notranslate">generator</code>, etc. all specify the default
objects to be used for the initial state of the simulation (commands specified within <code class="docutils literal notranslate">ksgeo_space</code>)
may modify the actual objects used during the course of a simulation.</p>
<p>Following the declaration of <code class="docutils literal notranslate">ks_simulation</code>, the closing tag <code class="docutils literal notranslate">&lt;/kassiopeia&gt;</code> is placed
to complete the simulation configuration. When this tag is encountered by the XML parser, it triggers
the simulation to run.</p>
</section>
<section id="visualization">
<h2>Visualization<a aria-label="Copy link to section: Visualization." class="headerlink tooltipped tooltipped-ne" href="#visualization" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>If <em>Kassiopeia</em> has been linked against, simple visualization of the simulation may be made available.
By adding the <cite>vtk_window</cite> tag we enable a VTK window that will open when the simulation is complete.
This element needs a <code class="docutils literal notranslate">vtk_geometry_painter</code> and the <code class="docutils literal notranslate">`vtk_track_painter</code> to draw the geometry
and tracks, respectively. An example of this type of visualization from the
QuadurpoleTrapSimulation.xml file is a follows:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>&lt;vtk_window
    name="vtk_window"
    enable_display="true"
    enable_write="true"
    frame_title="KGeoBag Visualization"
    frame_size_x="1024"
    frame_size_y="768"
    frame_color_red=".2"
    frame_color_green=".2"
    frame_color_blue=".2"
    view_angle="45"
    eye_angle="0.5"
    multi_samples="4"
    depth_peeling="10"
&gt;
    &lt;vtk_geometry_painter
        name="geometry_painter"
        surfaces="world/quadrupole_trap/#"
    /&gt;
    &lt;vtk_track_painter
        name="track_painter"
        path="[output_path]"
        file="QuadrupoleTrapSimulation.root"
        point_object="component_step_world"
        point_variable="position"
        color_object="component_step_cell"
        color_variable="polar_angle_to_b"
    /&gt;
&lt;/vtk_window&gt;
</code></pre></div>
<p>Note that the visualization window must be placed outside of the <code class="docutils literal notranslate">&lt;kassiopeia&gt;</code>…``&lt;/kassiopiea&gt;``
environment tags.</p>
</section>
<section id="common-pitfalls-and-problems">
<h2>Common Pitfalls and Problems<a aria-label="Copy link to section: Common Pitfalls and Problems." class="headerlink tooltipped tooltipped-ne" href="#common-pitfalls-and-problems" role="button"><svg pointer-events="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>The XML parse does have some ability to recognize simple errors in a configuration file
and will generally report the location of an element which it is not able to process.</p>
<p>Some errors which might occur if a file is improperly configured are:</p>
<ul class="simple">
<li><p>Multiple objects which share the same name at the same scope.</p></li>
<li><p>Misspelled element types.</p></li>
<li><p>Missing closing brackets.</p></li>
<li><p>Undefined variables.</p></li>
<li><p>Undeclared (but used) elements.</p></li>
</ul>
<p>In the case of more than one copy of the same object with the name &lt;X&gt;, the XML parser will fail with
with an error along the lines of:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>[INITIALIZATION ERROR MESSAGE] Multiple instances of object with name &lt;X&gt;.
</code></pre></div>
<p>In the case where an element’s type name is misspelled the parser will fail with
an unreconized element error. For example if we misspelled <code class="docutils literal notranslate">ksterm_max_z</code> as <code class="docutils literal notranslate">kterm_max_z</code>
we would recieve the following error:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>[INITIALIZATION ERROR MESSAGE] nothing registered for element &lt;kterm_max_z&gt; in element &lt;kassiopeia&gt;
</code></pre></div>
<p>If there is a mis-matched bracket the intialization will usually fail with an unrecongnized
character error, such as:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>[INITIALIZATION ERROR MESSAGE] element &lt;X&gt; encountered an error &lt;got unknown character &lt;&lt;&gt;&gt;
</code></pre></div>
<p>If a variable “[X]” is used without being previously defined, and undefined error will be reported
as follows:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>[INITIALIZATION ERROR MESSAGE] variable &lt;X&gt; is not defined
</code></pre></div>
<p>If there is an attempt to retrieve/reference and element which has not been declared the
the simulation will fail with the message:</p>
<div class="highlight">
<div class="code-header">
<span class="code-lang"></span>
<button aria-label="Copy this code" class="copy tooltipped tooltipped-nw"><svg aria-hidden="true" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/xvg"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button>
</div>
<pre><code>[INITIALIZATION WARNING MESSAGE] No suitable Object called &lt;X&gt; in Toolbox
</code></pre></div>
<p class="rubric">Footnotes</p>
<p>[1] Daniel Lawrence Furse. Techniques for direct neutrino mass measurement utilizing tritium [beta]-decay. PhD thesis, Massachusetts Institute of Technology, 2015.</p>
<p>[2] Thomas Corona. Methodology and application of high performance electrostatic field simulation in the KATRIN experiment. PhD thesis, University of North Carolina, Chapel Hill, 2014.</p>
<p>[3] John P. Barrett. A Spatially Resolved Study of the KATRIN Main Spectrometer Using a Novel Fast Multipole Method. PhD thesis, Massachusetts Institute of Technology, 2016.</p>
</section>
</section>
<section class="flex justify-between pt-4 mt-12">
<div class="mr-auto">
<span class="uppercase text-sm font-medium text-gray-600 tracking-wider block mb-2">Previous</span>
<a class="block text-blue-700 hover:text-pink-600 focus:text-pink-600 hover:underline focus:underline" href="examples.html" title="Go to previous page">← Examples and Tests</a>
</div>
<div class="ml-auto">
<span class="uppercase text-sm font-medium text-gray-600 tracking-wider block mb-2 text-right">Next</span>
<a class="block text-blue-700 hover:text-pink-600 focus:text-pink-600 hover:underline focus:underline" href="kgeobag_basic.html" title="Go to next page">Basic Shapes in KGeoBag →</a>
</div>
</section>
</main>
<footer class="mt-20 px-5 md:ml-fluid mb-4 flex-shrink-0 text-sm text-gray-700" role="contentinfo">© Copyright 2021, The Kassiopeia developers. Made with <a href="https://www.sphinx-doc.org">Sphinx 3.4.3</a></footer>
</div>
<div class="sticky bottom-0 md:hidden print:hidden bg-white">
<div class="flex justify-center items-center">
<button aria-labelledby="menuLabel" class="text-3xl p-4 flex items-center focus:bg-gray-200" id="openNavBtn">
<svg aria-hidden="true" class="fill-current h-8 w-8" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg>
<span class="pl-2 text-sm font-medium uppercase tracking-wide text-gray-700" id="menuLabel">Menu</span>
</button><button aria-labelledby="searchLabel" class="text-3xl p-4 flex items-center focus:bg-gray-200" id="openSearchBtn">
<svg aria-hidden="true" class="fill-current h-8 w-8" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg>
<span class="pl-2 text-sm font-medium uppercase tracking-wide text-gray-700" id="searchLabel">Search</span>
</button>
</div>
</div>
<div class="w-full fixed bottom-0 left-0 z-10 bg-gray-900 overflow-x-hidden pt-10 flex flex-col items-center md:hidden" data-menu="closed" id="search-pane">
<h4 class="text-xl text-white mb-4" id="search-label">Enter search term</h4><form action="search.html" class="flex w-full justify-between items-center max-w-sm px-12" id="searchbox" method="get">
<input aria-labelledby="search-label" class="p-2 flex-1" name="q" placeholder="Search the docs" type="search"/>
<button aria-label="Get search results" class="p-2 text-white bg-gray-700 hover:bg-gray-200 hover:text-pink-500 focus:bg-gray-200 focus:text-pink-500 tooltipped tooltipped-sw">
<svg aria-hidden="true" class="fill-current stroke-current h-6 w-6" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg>
</button>
</form>
<button aria-label="Close menu" class="text-4xl text-gray-200 p-4 bottom-0 hover:text-pink-500 md:hidden focus:text-pink-500 self-center" id="closeSearchBtn" title="Close menu">
<svg aria-hidden="true" class="fill-current stroke-current h-6 w-6" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</div>
<div class="fixed bottom-0 right-0 opacity-0 p-4 m-4 bg-gray-900 text-gray-100 transition transform duration-500 translate-y-full" id="snackbar"></div>
<div class="fixed inset-0 bg-black bg-opacity-50" id="screen" style="display: none;"></div>
</div>
<script data-url_root="./" id="documentation_options" src="_static/documentation_options.js">
</script>
<script src="_static/jquery.js"></script>
<script src="_static/underscore.js"></script>
<script src="_static/doctools.js"></script>
<script defer="" src="_static/theme.js"></script>
</body>
</html>