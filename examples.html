<!DOCTYPE html>




<html lang="en">
  <head>
    <meta charset="utf-8" />
    
    <title>Examples and Tests &mdash; Kassiopeia 3.3 documentation</title>
    <meta name="description" content="">
    <meta name="author" content="">

    

<link rel="stylesheet" href="_static/css/basicstrap-base.css" type="text/css" />
<link rel="stylesheet" id="current-theme" href="_static/css/bootstrap3/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" id="current-adjust-theme" type="text/css" />

<link rel="stylesheet" href="_static/css/font-awesome.min.css">

<style type="text/css">
  body {
    padding-top: 60px;
    padding-bottom: 40px;
  }
</style>

<link rel="stylesheet" href="_static/css/basicstrap.css" type="text/css" />
<link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
            URL_ROOT:    './',
            VERSION:     '3.3',
            COLLAPSE_INDEX: false,
            FILE_SUFFIX: '.html',
            HAS_SOURCE:  true
  };
</script>
    <script type="text/javascript" src="_static/js/jquery.min.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/bootstrap3.min.js"></script>
<script type="text/javascript" src="_static/js/jquery.cookie.min.js"></script>
<script type="text/javascript" src="_static/js/basicstrap.js"></script>
<script type="text/javascript">
</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="Kassiopeia 3.3 documentation" href="index.html" />
    <link rel="next" title="Configuring Your Own Simulation" href="configuration.html" />
    <link rel="prev" title="Getting starting with Kassiopiea" href="compiling.html" /> 
  </head>
  <body role="document">
    <div id="navbar-top" class="navbar navbar-fixed-top navbar-default" role="navigation" aria-label="top navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">Kassiopeia 3.3 documentation</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
              <li class="dropdown visible-xs">
                <a role="button" id="localToc" data-toggle="dropdown" data-target="#" href="#">Table Of Contents <b class="caret"></b></a>
                <ul class="dropdown-menu localtoc sp-localtoc" role="menu" aria-labelledby="localToc">
                <ul>
<li><a class="reference internal" href="#">Examples and Tests</a><ul>
<li><a class="reference internal" href="#running-kassiopeia">Running Kassiopeia</a></li>
<li><a class="reference internal" href="#the-dipole-trap-example">The Dipole Trap Example</a></li>
<li><a class="reference internal" href="#the-quadrupole-trap-example">The Quadrupole Trap Example</a></li>
<li><a class="reference internal" href="#the-photomultiplier-tube-example">The Photomultiplier Tube Example</a></li>
<li><a class="reference internal" href="#other-examples">Other Examples</a></li>
</ul>
</li>
</ul>

                </ul>
              </li>

            
              <li><a href="compiling.html" title="Getting starting with Kassiopiea" accesskey="P">previous </a></li>
              <li><a href="configuration.html" title="Configuring Your Own Simulation" accesskey="N">next </a></li>
              <li><a href="genindex.html" title="General Index" accesskey="I">index </a></li>
            
            <li class="visible-xs"><a href="_sources/examples.txt" rel="nofollow">Show Source</a></li>

            <li class="visible-xs">
                <form class="search form-search form-inline navbar-form navbar-right sp-searchbox" action="search.html" method="get">
                  <div class="input-append input-group">
                    <input type="text" class="search-query form-control" name="q" placeholder="Search...">
                    <span class="input-group-btn">
                    <input type="submit" class="btn" value="Go" />
                    </span>
                  </div>
                  <input type="hidden" name="check_keywords" value="yes" />
                  <input type="hidden" name="area" value="default" />
                </form>
            </li>

            

          </ul>

        </div>
      </div>
    </div>
    

    <!-- container -->
    <div class="container-fluid">

      <!-- row -->
      <div class="row">
         
<div class="col-md-3 hidden-xs" id="sidebar-wrapper">
  <div class="sidebar hidden-xs" role="navigation" aria-label="main navigation">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Examples and Tests</a><ul>
<li><a class="reference internal" href="#running-kassiopeia">Running Kassiopeia</a></li>
<li><a class="reference internal" href="#the-dipole-trap-example">The Dipole Trap Example</a></li>
<li><a class="reference internal" href="#the-quadrupole-trap-example">The Quadrupole Trap Example</a></li>
<li><a class="reference internal" href="#the-photomultiplier-tube-example">The Photomultiplier Tube Example</a></li>
<li><a class="reference internal" href="#other-examples">Other Examples</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="compiling.html"
                        title="previous chapter">Getting starting with Kassiopiea</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="configuration.html"
                        title="next chapter">Configuring Your Own Simulation</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/examples.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" role="search">
  <h3>Quick search</h3>
  <form class="search form-inline" action="search.html" method="get">
      <div class="input-append input-group">
        <input type="text" class="search-query form-control" name="q" placeholder="Search...">
        <span class="input-group-btn">
        <input type="submit" class="btn" value="Go" />
        </span>
      </div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
  </div>
</div> 
        

        <div class="col-md-9" id="content-wrapper">
          <div class="document" role="main">
            <div class="documentwrapper">
              <div class="bodywrapper">
                <div class="body">
                  
  <div class="section" id="examples-and-tests">
<h1>Examples and Tests<a class="headerlink" href="#examples-and-tests" title="Permalink to this headline">¶</a></h1>
<div class="section" id="running-kassiopeia">
<h2>Running Kassiopeia<a class="headerlink" href="#running-kassiopeia" title="Permalink to this headline">¶</a></h2>
<p>After installation, and assuming the proper environmental variables have been set by running
the script <code class="docutils literal"><span class="pre">kasperenv.sh</span></code>, <em>Kassiopeia</em> can be run directly from the command prompt. To run
a <em>Kassiopeia</em> simulation, the useage is simply:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">Kassiopeia</span> <span class="o">&lt;</span><span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">xml</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><em>Kassiopeia</em> also includes advanced variable replacement functionality, which makes it easy to
modify one or many simulation parameters on-the-fly. This can be done with the following useage:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">Kassiopeia</span> <span class="o">&lt;</span><span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">xml</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">r</span> <span class="o">&lt;</span><span class="n">variable1</span><span class="o">&gt;=&lt;</span><span class="n">value1</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">variable2</span><span class="o">&gt;=&lt;</span><span class="n">value2</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Upon completion of a simulation, the ROOT output files
may be found in the directory <code class="docutils literal"><span class="pre">&lt;kassiopeia-install-path&gt;/output/Kassiopeia</span></code>. These output
file can then be processed or analyzed by an external program. In order to prematurely terminate
a running simulation <em>Kassiopeia</em> provides a user interrupt feature. To terminate the simulation
early, but allow <em>Kassiopeia</em> to clean up and save the accumulated data to file, the user
may type <code class="docutils literal"><span class="pre">crtl-C</span></code> just once in the terminal. To immediately exit the simulation (without cleaning
up or saving data) the user may type <code class="docutils literal"><span class="pre">crtl-C</span></code> twice.</p>
</div>
<div class="section" id="the-dipole-trap-example">
<h2>The Dipole Trap Example<a class="headerlink" href="#the-dipole-trap-example" title="Permalink to this headline">¶</a></h2>
<p>The first example is the simplest is a simulation of a dipole trap, or rather, a magnetic mirror device.
It consists of a two dipole magnets positioned some distance apart
along the same axis to form a magnetic bottle. To make the simulation slightly less trivial but still
simple, a ring electrode has been added near the center of the magnetic bottle
emulating a MAC-E filter spectrometer. To run this simulation, from the $KASPERSYS directory type:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">Kassiopeia</span> <span class="o">./</span><span class="n">config</span><span class="o">/</span><span class="n">Kassiopeia</span><span class="o">/</span><span class="n">Examples</span><span class="o">/</span><span class="n">DipoleTrapSimulation</span><span class="o">.</span><span class="n">xml</span>
</pre></div>
</div>
<p>On the first run of this simulation, <em>Kassiopeia</em> will call <em>KEMField</em> to solve the
static electric and magnetic fields of the geometry and compute a zonal
harmonic (axially symmetric approximation) field map. Once field solving
is finished, particle tracking of 1 event will commence.</p>
<p>Ignoring the messages from <em>KEMField</em>, the terminal output of this example will look
something like:</p>
<div class="highlight-default"><div class="highlight"><pre>[KSMAIN NORMAL MESSAGE] ☻  welcome to Kassiopeia 3.3  ☻
****[KSRUN NORMAL MESSAGE] processing run 0...
********[KSEVENT NORMAL MESSAGE] processing event 0 &lt;generator_uniform&gt;...
************[KSTRACK NORMAL MESSAGE] processing track 0 &lt;generator_uniform&gt;...
[KSNAVIGATOR NORMAL MESSAGE]   child surface &lt;surface_downstream_target&gt; was crossed.00106397, k = 5.44591, e = 7.08033))
************[KSTRACK NORMAL MESSAGE] ...completed track 0 &lt;term_downstream_target&gt; after 48714 steps at &lt;-0.000937309 -0.000478289 0.48&gt;
********[KSEVENT NORMAL MESSAGE] ...completed event 0 &lt;generator_uniform&gt;
****[KSRUN NORMAL MESSAGE] ...run 0 complete
[KSMAIN NORMAL MESSAGE] finished!
[KSMAIN NORMAL MESSAGE] ...finished
</pre></div>
</div>
<p>Once particle tracking has terminated you will find a .root output file located
at:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="o">&lt;</span><span class="n">kassiopeia</span><span class="o">-</span><span class="n">install</span><span class="o">-</span><span class="n">path</span><span class="o">&gt;/</span><span class="n">output</span><span class="o">/</span><span class="n">Kassiopeia</span><span class="o">/</span><span class="n">DipoleTrapSimulation</span><span class="o">.</span><span class="n">root</span>
</pre></div>
</div>
<p>This file contains all the data (saved as in a ROOT TTree format)
pertaining to the particle&#8217;s state during tracking. This file maybe opened
for quick visualization and histogramming using a ROOT TBrowser, or it may
be processes by an external analysis program. As an example, plotting the
electric potential experienced by the electron as a function of its $z$
position produces the following graph.</p>
<a class="reference internal image-reference" href="_images/dipole_potential_vs_z.png"><img alt="_images/dipole_potential_vs_z.png" src="_images/dipole_potential_vs_z.png" style="width: 500pt;" /></a>
<p>For more advanced visualization <em>Kassiopeia</em> may be linked against the <a class="reference external" href="http://www.vtk.org/">VTK</a> library.
This can be done by toggling the the cmake variable <code class="docutils literal"><span class="pre">Kassiopeia_USE_VTK</span></code>. If this is done,
the DipoleTrapSimulation.xml example will include a configuration which
will open an interactive VTK visualization window upon completion of the simulation. The output of which
shows the electron&#8217;s track colored by angle between its momentum vector and the magnetic field.
The following image demonstrates the VTK visualization of the Dipole trap simulation.</p>
<a class="reference internal image-reference" href="_images/dipole_vtk.png"><img alt="_images/dipole_vtk.png" src="_images/dipole_vtk.png" style="width: 500pt;" /></a>
</div>
<div class="section" id="the-quadrupole-trap-example">
<h2>The Quadrupole Trap Example<a class="headerlink" href="#the-quadrupole-trap-example" title="Permalink to this headline">¶</a></h2>
<p>The second example to demonstrate the capabilities of <em>Kassiopeia</em> is that of a quadrupole (Penning) trap.
This sort of trap is similar to those which are used to measure the electron $g$-factor to extreme precision.
To run this example first navigate to the installation directory using <code class="docutils literal"><span class="pre">cd</span> <span class="pre">$KASPERSYS</span></code>,
and then at the command prompt enter:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">Kassiopeia</span> <span class="o">./</span><span class="n">config</span><span class="o">/</span><span class="n">Kassiopeia</span><span class="o">/</span><span class="n">Examples</span><span class="o">/</span><span class="n">QuadrupoleTrapSimulation</span><span class="o">.</span><span class="n">xml</span>
</pre></div>
</div>
<p>This example also demonstrates the incorporation of discrete interactions, such as scattering
off residual gas. If VTK is used, upon the completion of particle track a visualization window will appear. An
example of this shown in the following figure. The large green tube is the solenoid magnet, while the amber hyperboloid surfaces within it are
the electrode surfaces. The electron tracks can be seen as short lines at the center.</p>
<a class="reference internal image-reference" href="_images/quadrupole_vtk.png"><img alt="_images/quadrupole_vtk.png" src="_images/quadrupole_vtk.png" style="width: 500pt;" /></a>
<p>Furthermore, a very simple analysis program example <code class="docutils literal"><span class="pre">QuadrupoleTrapAnalysis</span></code> can be run on the resulting .root
file, by executing:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">QuadrupoleTrapAnalysis</span> <span class="o">./</span><span class="n">output</span><span class="o">/</span><span class="n">Kassiopeia</span><span class="o">/</span><span class="n">QuadrupoleTrapSimulation</span><span class="o">.</span><span class="n">root</span>
</pre></div>
</div>
<p>The output of which should be something to the effect of:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">extrema</span> <span class="k">for</span> <span class="n">track</span> <span class="o">&lt;</span><span class="mf">1.43523</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This program can be used as a basis for more advanced analysis programs, as it demonstrates the methods
needed to iterate over the particle tracking data stored in a ROOT TTree file.</p>
</div>
<div class="section" id="the-photomultiplier-tube-example">
<h2>The Photomultiplier Tube Example<a class="headerlink" href="#the-photomultiplier-tube-example" title="Permalink to this headline">¶</a></h2>
<p>As a demonstration of some of the more advanced features of <em>Kassiopeia</em> (particularly its 3D capabilities)
an example of particle tracking in a photomultiplier tube is also included. Since the dimensions of the linear
system that needs to be solved in order to compute the electric field is rather large (~150K mesh elements),
the initialization of the electric field may take some time. If the user has the appropriate device (e.g. a GPU)
it is recommended that the field solving sub-module <em>KEMField</em> be augmented with OpenCL in order
to take advantage of hardware based acceleration. This can be done by setting the KEMField_USE_OpenCL
flag to ON during cmake configuration.</p>
<p>To run this simulation, from the $KASPERSYS directory type:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">Kassiopeia</span> <span class="o">./</span><span class="n">config</span><span class="o">/</span><span class="n">Kassiopeia</span><span class="o">/</span><span class="n">Examples</span><span class="o">/</span><span class="n">PhotoMultiplierTubeSimulation</span><span class="o">.</span><span class="n">xml</span>
</pre></div>
</div>
<p>Depending on the capability of your computer this example may take several hours to run, you may want to
execute it overnight. If you have enabled <a class="reference external" href="http://www.vtk.org/">VTK</a>, an .vtp output file called:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="o">&lt;</span><span class="n">kassiopeia</span><span class="o">-</span><span class="n">install</span><span class="o">-</span><span class="n">path</span><span class="o">&gt;/</span><span class="n">output</span><span class="o">/</span><span class="n">Kassiopeia</span><span class="o">/</span><span class="n">PhotoMultiplierTubeSimulation</span><span class="o">.</span><span class="n">vtpStep</span><span class="o">.</span><span class="n">vtp</span>
</pre></div>
</div>
<p>will be created. This file stores the particle step data for visualization using the VTK polydata format.
Additionally, a file called <code class="docutils literal"><span class="pre">PhotomultiplierTube.vtp</span></code> will be created in the directory from which <em>Kassiopeia</em>
was called. This file stores visualization data about the electrode BEM mesh elements. Both of these
files can be opened in the the external program <a class="reference external" href="http://www.paraview.org">Paraview</a> for data selection and viewing. An
example is shown in the following figure.</p>
<a class="reference internal image-reference" href="_images/pmt_paraview.png"><img alt="_images/pmt_paraview.png" src="_images/pmt_paraview.png" style="width: 500pt;" /></a>
</div>
<div class="section" id="other-examples">
<h2>Other Examples<a class="headerlink" href="#other-examples" title="Permalink to this headline">¶</a></h2>
<p>Some other examples which explore other concepts
also distributed with Kassiopeia, and are described in the following table.</p>
<table border="1" class="docutils">
<colgroup>
<col width="37%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Other simulation examples</th>
</tr>
<tr class="row-even"><th class="head">File</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td><p class="first">AnalyticSimulation.xml</p>
<blockquote class="last">
<div><a class="reference internal" href="_images/analytic_trap.png"><img alt="ana" class="align-middle" src="_images/analytic_trap.png" style="width: 307.2px; height: 239.1px;" /></a></div></blockquote>
</td>
<td>Quadrupole ion/electron trap (similar to the original
QuadrupoleTrapSimulation.xml. However, the magnetic
field is completely uniform and the and the electric
field is described analytically as an ideal quadrupole.</td>
</tr>
<tr class="row-even"><td><p class="first">ToricTrapSimulation.xml</p>
<p class="last"><a class="reference internal" href="_images/toric.png"><img alt="toric" class="align-middle" src="_images/toric.png" style="width: 358.32px; height: 267.84px;" /></a></p>
</td>
<td>This is a simulation of an electron trapped in a magnetic
torus (similar to a tokamak), and demonstrates the
identification of surface intersections, as well as particle
drift in non-homogeneous fields.</td>
</tr>
<tr class="row-odd"><td><p class="first">DipoleTrapMeshedSpaceSimulation.xml</p>
<blockquote class="last">
<div><a class="reference internal" href="_images/dipole_meshed_vtk.png"><img alt="dmvtk" class="align-middle" src="_images/dipole_meshed_vtk.png" style="width: 307.2px; height: 239.1px;" /></a></div></blockquote>
</td>
<td>This simulation has the same fields as the original
dipole trap simulation. However, there are many additional
(meshed, but non-interacting) surfaces present to demonstrate
navigation in a complicated geometry using the meshed-surface
octree-based navigator.</td>
</tr>
</tbody>
</table>
</div>
</div>


                </div>
              </div>
            </div>
          </div>
        </div>
        
        
      </div><!-- /row -->

      <!-- row -->
      <div class="row footer-relbar">
<div id="navbar-related" class=" related navbar navbar-default" role="navigation" aria-label="related navigation">
  <div class="navbar-inner">
    <ul class="nav navbar-nav ">
        <li><a href="index.html">Kassiopeia 3.3 documentation</a></li>
    </ul>
<ul class="nav navbar-nav pull-right hidden-xs hidden-sm">
      
        <li><a href="compiling.html" title="Getting starting with Kassiopiea" >previous</a></li>
        <li><a href="configuration.html" title="Configuring Your Own Simulation" >next</a></li>
        <li><a href="genindex.html" title="General Index" >index</a></li>
        <li><a href="#">top</a></li> 
      
    </ul>
  </div>
</div>
      </div><!-- /row -->

      <!-- footer -->
      <footer role="contentinfo">
          &copy; Copyright 2016, Daniel Furse, Stefan Groh, Nikolaus Trost, Martin Babutzka, John P. Barrett, Jan Behrens, Nicholas Buzinksy, Thomas Corona, Sanshiro Enomoto, Moritz Erhard, Joseph A. Formaggio, Ferenc Glueck, Fabian Harms, Florian Heizmann, Daniel Hilk, Wolfgang Kaefer, Marco Kleesiek, Benjamin Leiber, Susanne Mertens, Noah S. Oblath, Pascal Renschler, Johannes Schwarz, Penny L. Slocum, Nancy Wandkowsky, Kevin Wierman and Michael Zacher.
        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.4.8.
      </footer>
      <!-- /footer -->

    </div>
    <!-- /container -->

  </body>
</html>